/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import t from"react";import"prop-types";import{useCallback as e,useRef as n,useEffect as r}from"@googleforcreators/react";import i from"../utils/createKeyframeEffect.js";import o from"./fullSizeAbsolute.js";import"./types.js";import a from"./useStoryAnimationContext.js";function m(){return m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m.apply(this,arguments)}function WAAPIAnimationWrapper(e){let{children:a,hoistAnimation:m,keyframes:A,timings:s,targetLeafElement:p}=e;const c=n(null);return r((()=>{if(!A)return()=>{};const t=p?c.current?.querySelector('[data-leaf-element="true"]'):c.current;if(!t)return()=>{};const e=i(t,A,s);return m(new Animation(e,document.timeline))}),[m,A,p,s]),t.createElement(o,{ref:c},a)}function WAAPIWrapper(n){let{children:r,target:i}=n;const{hoistWAAPIAnimation:o,AnimationParts:A}=a((t=>{let{actions:e}=t;return{hoistWAAPIAnimation:e.hoistWAAPIAnimation,AnimationParts:e.getAnimationParts(i)}})),s=A?.map((t=>t.WAAPIAnimation)),p=e((t=>o({animation:t,elementId:i})),[i,o]);return t.createElement(WAAPIAnimationWrapper,m({hoistAnimation:p},s[0]),t.createElement(WAAPIAnimationWrapper,m({hoistAnimation:p},s[1]),t.createElement(WAAPIAnimationWrapper,m({hoistAnimation:p},s[2]),r)))}export{WAAPIWrapper as default};
