/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{useRef as t,useState as o,useEffect as r,useFocusOut as i,useMemo as n}from"@googleforcreators/react";import{__}from"@googleforcreators/i18n";import{useGridViewKeys as s}from"@googleforcreators/design-system";import"prop-types";import"../../../../constants/index.js";import"../../../../components/cardGallery/components.js";import m from"../../../../components/cardGrid/index.js";import"../../../../components/cardGridItem/index.js";import"../../../../components/colorList/index.js";import"../../../../components/contentGutter/index.js";import"styled-components";import"../../../../components/fileUpload/index.js";import"../../../../components/infiniteScroller/index.js";import"../../../../components/inlineInputForm/index.js";import"../../../../components/layout/provider.js";import"../../../../components/layout/scrollable.js";import"../../../../components/layout/fixed.js";import"../../../../components/pageStructure/pageStructureComponents.js";import"../../../../components/pageStructure/leftRail.js";import"../../../../components/pageStructure/menuButton.js";import"../../../../components/navProvider.js";import"../../../../components/scrollToTop/index.js";import"../../../../components/storyMenu/index.js";import"../../../../components/table/index.js";import"../../../config/context.js";import p from"../../../config/useConfig.js";import"../../../../components/viewStyleBar/index.js";import"../../../../types.js";import"../../../../utils/keyboardOnlyOutline.js";import"@googleforcreators/units";import"../../../../utils/useStoryView.js";import"../../../../utils/useTemplateView.js";import{noop as l}from"../../../../utils/noop.js";import c,{FOCUS_TEMPLATE_CLASS as a}from"./templateGridItem.js";function TemplateGridView(u){let{pageSize:d,templates:f,templateActions:g}=u;const{isRTL:j,apiCallbacks:y}=p(),x=t(),S=t(),T=t({}),[b,h]=o(null),{handleDetailsToggle:v,createStoryFromTemplate:w}=g||{},G=Boolean(y?.createStoryFromTemplate);s({containerRef:x,gridRef:S,itemRefs:T,isRTL:j,currentItemId:b,items:f}),r((()=>{b&&T.current?.[b]?.querySelector(`.${a}`)?.focus()}),[b]),i(x,(()=>h(null)),[]);const R=n((()=>f.map((t=>{let{id:o,slug:r,status:i,title:n,postersByPage:s}=t;const m=b===o,p=s?.[0];return e.createElement(c,{onCreateStory:G?()=>w(o):l,onFocus:()=>{h(o)},onSeeDetailsClick:v,height:d.height,id:o,isActive:m,key:r,posterSrc:p,ref:e=>{T.current[o]=e},slug:r,status:i,title:n})}))),[f,b,G,v,d.height,w]);return e.createElement("div",{ref:x},e.createElement(m,{pageSize:d,role:"list",ref:S,ariaLabel:__("Viewing available templates","web-stories")},R))}export{TemplateGridView as default};
