/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{memo as o,useMemo as t,useCallback as r,useDebouncedCallback as s}from"@googleforcreators/react";import"prop-types";import{sprintf,__}from"@googleforcreators/i18n";import{trackEvent as n}from"@googleforcreators/tracking";import i from"styled-components";import{Pill as a}from"@googleforcreators/design-system";import{DASHBOARD_VIEWS as l,TEXT_INPUT_DEBOUNCE as p}from"../../../../constants/index.js";import"../../../../components/cardGallery/components.js";import"../../../../components/cardGrid/index.js";import"../../../../components/cardGridItem/index.js";import"../../../../components/colorList/index.js";import"../../../../components/contentGutter/index.js";import"../../../../components/fileUpload/index.js";import"../../../../components/infiniteScroller/index.js";import"../../../../components/inlineInputForm/index.js";import"../../../../components/layout/provider.js";import"../../../../components/layout/scrollable.js";import"../../../../components/layout/fixed.js";import m from"../../../../components/layout/useLayoutContext.js";import"../../../../components/pageStructure/pageStructureComponents.js";import"../../../../components/pageStructure/leftRail.js";import"../../../../components/pageStructure/menuButton.js";import"../../../../components/navProvider.js";import"../../../../components/scrollToTop/index.js";import"../../../../components/storyMenu/index.js";import"../../../../components/table/index.js";import"../../../config/context.js";import"../../../../components/viewStyleBar/index.js";import"../../../../types.js";import"../../../../utils/useStoryView.js";import"../../../../utils/keyboardOnlyOutline.js";import c from"../../../../utils/useDashboardResultsLabel.js";import"@googleforcreators/units";import"../../../../utils/useTemplateView.js";import u from"../../shared/bodyViewOptions.js";import"../../shared/emptyContentMessage.js";import d from"../../shared/pageHeading.js";import h from"../../utils/getSearchOptions.js";import{STORY_STATUSES as y,STORY_SORT_MENU_ITEMS as g}from"../../../../constants/stories.js";const f=i(a).withConfig({displayName:"header__StyledPill",componentId:"sc-vdoh83-0"})(["margin:0 2px;white-space:nowrap;& > span{padding-left:8px;color:",";}"],(e=>{let{theme:o,isActive:t}=e;return t?o.colors.gray[20]:o.colors.fg.tertiary}));var j=o((function Header(o){let{filter:i,initialPageReady:a,search:j,sort:w,stories:S,totalStoriesByStatus:b,view:x,author:v,queryAuthorsBySearch:A,showAuthorDropdown:C}=o;const{actions:{scrollToTop:B}}=m(),{setKeyword:D}=j,O=t((()=>h(S)),[S]),k=c({currentFilter:i.value,isActiveSearch:Boolean(j.keyword),totalResults:(i.value.split(",")||[]).reduce(((e,o)=>e+(b[o]||0)),0),view:l.DASHBOARD}),E=r((e=>{i.set(e),B()}),[i,B]),L=t((()=>!a||b&&0===Object.keys(b).length?null:e.createElement(e.Fragment,null,y.map((o=>{const{label:t,status:r,value:s}=o;if(!(r in b))return null;const n=b[r];if(0===n)return null;const a=sprintf(
/* translators: %s is story status */
__("Filter stories by %s","web-stories"),t);return e.createElement(f,{key:s,onClick:()=>E(s),isActive:i.value===s,disabled:n<=0,"aria-label":a},t,n&&e.createElement("span",null,n))})).filter(Boolean))),[b,i.value,a,E]),T=r((e=>{w.set(e),B()}),[B,w]),F=s((async e=>{await n("search",{search_type:"dashboard",search_term:e}),D(e)}),p),G=r((()=>D("")),[D]);return e.createElement(e.Fragment,null,e.createElement(d,{heading:__("Dashboard","web-stories"),searchPlaceholder:__("Search Stories","web-stories"),searchOptions:O,handleSearchChange:F,showSearch:a,searchValue:j.keyword,onClear:G},L),e.createElement(u,{showGridToggle:!0,showSortDropdown:!0,showAuthorDropdown:C,resultsLabel:k,layoutStyle:x.style,handleLayoutSelect:x.toggleStyle,currentSort:w.value,pageSortOptions:g,handleSortChange:T,author:v,queryAuthorsBySearch:A,sortDropdownAriaLabel:__("Choose sort option for display","web-stories")}))}));export{j as default};
