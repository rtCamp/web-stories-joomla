/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import"prop-types";import{useState as t,useRef as r,useCallback as a,useEffect as n,useMemo as o}from"@googleforcreators/react";import{sprintf,__}from"@googleforcreators/i18n";import{useGridViewKeys as c}from"@googleforcreators/design-system";import{DEFAULT_GRID_IMG_WIDTH as s,DEFAULT_GRID_IMG_HEIGHT as i}from"../../constants/index.js";import{ThumbnailButton as l,GalleryContainer as m,Thumbnails as g,DisplayPage as p}from"./components.js";function u(e){return sprintf(
/* translators: %s: page number. */
__("Poster of template page %s","web-stories"),e)}function CardGallery(d){let{galleryPosters:f,isRTL:y,galleryLabel:E}=d;const[b,w]=t(0),[P,h]=t(),R=r(),S=r(),v=r({}),x=a((e=>{w(e),h(e)}),[]),C=a((e=>{h(e)}),[]);n((()=>{f&&(w(0),h())}),[f]),c({containerRef:R,gridRef:S,itemRefs:v,isRTL:y,currentItemId:P,items:f});const I=o((()=>f.map(((t,r)=>{const a=`gallery_item_${r}`,n=r+1,o=P?P===r:b===r;return e.createElement("div",{key:a,ref:e=>{v.current[r]=e},onFocus:()=>C(r)},e.createElement(l,{$isSelected:b===r,tabIndex:o?0:-1,onClick:()=>x(r),"aria-label":sprintf(
/* translators: %s: page number. */
__(b===r?"Page %s (current page)":"Page %s","web-stories"),n)},e.createElement("picture",null,e.createElement("source",{srcSet:t.webp,type:"image/webp"}),e.createElement("source",{srcSet:t.png,type:"image/png"}),e.createElement("img",{src:t.png,decoding:"async",alt:u(n),width:s,height:i}))))}))),[f,b,P,C,x]);return e.createElement(m,{ref:R},e.createElement(g,{ref:S,role:"group","aria-label":E,"data-testid":"mini-cards-container"},I),e.createElement(p,null,f[b]&&e.createElement("picture",null,e.createElement("source",{srcSet:f[b].webp,type:"image/webp"}),e.createElement("source",{srcSet:f[b].png,type:"image/png"}),e.createElement("img",{src:f[b].png,decoding:"async",alt:sprintf(
/* translators: %s: active preview page number */
__("Active Page Preview - Page %s","web-stories"),b+1),width:s,height:i}))))}export{CardGallery as default};
