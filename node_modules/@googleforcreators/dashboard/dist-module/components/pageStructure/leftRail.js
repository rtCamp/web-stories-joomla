/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{useRef as t,useCallback as r,useFocusOut as o,useLayoutEffect as a}from"@googleforcreators/react";import{trackEvent as l,trackClick as n}from"@googleforcreators/tracking";import{__,sprintf}from"@googleforcreators/i18n";import{LogoWithTypeCircleColor as i,Button as s,BUTTON_TYPES as c,BUTTON_SIZES as p,THEME_CONSTANTS as m,Text as u}from"@googleforcreators/design-system";import f from"styled-components";import"../../app/router/routerProvider.js";import E from"../../app/router/useRouteHistory.js";import{resolveRoute as v}from"../../app/router/route.js";import{useNavContext as g}from"../navProvider.js";import"../../app/api/apiProvider.js";import"prop-types";import"../../app/config/context.js";import S from"../../app/config/useConfig.js";import{PRIMARY_PATHS as b,APP_ROUTES as d}from"../../constants/index.js";import{Header as w,Content as R,NavList as L,NavListItem as P,NavLink as y,PathName as A,AppInfo as j}from"./navigationComponents.js";import{LeftRailContainer as T}from"./pageStructureComponents.js";function _(){return _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},_.apply(this,arguments)}const h=f.div.withConfig({displayName:"leftRail__IconWrap",componentId:"sc-wua966-0"})(["position:relative;"]);function LeftRail(){const f=E((e=>{let{state:t}=e;return t.activeRoute})),{newStoryURL:k,version:C,leftRailSecondaryNavigation:Y,canViewDefaultTemplates:O,styleConstants:{topOffset:I}}=S(),M=t(null),x=t(null),{state:{sideBarVisible:B},actions:{toggleSideBar:G}}=g(),z=r((e=>{let{target:t}=e;t!==M.current&&t!==x.current&&G()}),[G,M,x]),H=r((()=>{B&&G()}),[G,B]);o(M,H,[B]),a((()=>{B&&M.current&&M.current.focus()}),[B]);const N=r((()=>{l("create_new_story")}),[]),Z=r(((e,t)=>{n(e,t.trackingEvent)}),[]);return e.createElement(T,{onClickCapture:z,ref:M,isOpen:B,topOffset:I,role:"navigation","aria-label":__("Main dashboard navigation","web-stories")},e.createElement("div",{ref:x},e.createElement(w,{forwardedAs:"h2"},e.createElement(i,{title:__("Web Stories Dashboard","web-stories")})),e.createElement(R,null,e.createElement(s,{type:c.QUATERNARY,size:p.SMALL,href:k,onClick:N},__("Create New Story","web-stories"))),e.createElement(R,null,e.createElement(L,null,b.map((t=>{let{Icon:r,...o}=t;return o.value===d.TEMPLATES_GALLERY&&!O?null:e.createElement(P,{key:o.value},e.createElement(y,_({active:f===o.value,href:v(o.value),size:m.TYPOGRAPHY.PRESET_SIZES.SMALL,isBold:!0,isIconLink:Boolean(r),"aria-label":f===o.value?sprintf(
/* translators: %s: the current page, for example "Dashboard". */
__("%s (active view)","web-stories"),o.label):o.label},o.isExternal&&{rel:"noreferrer",target:"_blank",onClick:e=>Z(e,o)}),e.createElement(h,null,r&&e.createElement(r,{width:"22px"})),e.createElement(A,{as:"span",isBold:!0},o.label)))}))))),e.createElement(R,null,Y&&e.createElement(L,null,Y.map((t=>e.createElement(P,{key:t.value},e.createElement(y,_({active:f===t.value,href:v(t.value),size:m.TYPOGRAPHY.PRESET_SIZES.SMALL,"aria-label":f===t.value?sprintf(
/* translators: %s: the current page, for example "Dashboard". */
__("%s (active view)","web-stories"),t.label):t.label},t.isExternal&&{rel:"noreferrer",target:"_blank",onClick:e=>Z(e,t)}),e.createElement(u,{as:"span",size:m.TYPOGRAPHY.PRESET_SIZES.SMALL,isBold:!0},t.label)))))),e.createElement(j,{size:m.TYPOGRAPHY.PRESET_SIZES.X_SMALL},sprintf(
/* translators: 1: Current Year, 2: App Version */
__("Â© %1$s Google Version %2$s","web-stories"),(new Date).getFullYear(),C))))}export{LeftRail as default};
