/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useRef as t,useState as e,useDebouncedCallback as i,useEffect as n,useResizeEffect as r,useMemo as o}from"@googleforcreators/react";import{PAGE_RATIO as d}from"@googleforcreators/units";import"../constants/index.js";import{WPBODY_ID as a,MIN_DASHBOARD_WIDTH as h,VIEWPORT_BREAKPOINT as s,STORY_PREVIEW_WIDTH as c,GRID_SPACING as l,PAGE_WRAPPER as p,DASHBOARD_LEFT_NAV_WIDTH as w}from"../constants/pageStructure.js";const u=t=>Math.round(t/d),f=t=>t<=h?s.TABLET:s.DESKTOP,g=(t,e)=>{let{bp:i,respectSetWidth:n,availableContainerSpace:r}=e;if(n){return{width:t,height:u(t)}}i===s.DESKTOP&&(r-=w);const o=Math.floor(r/t),d=t+(r-(t*o+l.COLUMN_GAP*(o-1)+2*p.GUTTER))/o;return{width:d,height:u(d)}},m=t=>window.innerWidth<h?h:t;function S(){let d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{thumbnailMode:h=!1,isGrid:l}=d,p=t(document.getElementById(a)),[w,u]=e(window.innerWidth),[S,W]=e(f(w)),[T,b]=e(m(p.current?.offsetWidth||window.innerWidth)),E=i((t=>{u(t)}),500);return n((()=>{W(f(w))}),[w]),r(p,(t=>{let{width:e}=t;b(m(e)),window.innerWidth!==w&&E(window.innerWidth)}),[b,w,E]),o((()=>({pageSize:g(c[h?s.THUMBNAIL:S],{respectSetWidth:!l||h,availableContainerSpace:T,bp:S})})),[S,l,h,T])}export{S as default,u as getPosterHeight};
