/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),r=require("@googleforcreators/react"),t=require("@googleforcreators/i18n"),o=require("@googleforcreators/design-system");require("prop-types"),require("../../../../constants/index.js"),require("../../../../components/cardGallery/components.js");var s=require("../../../../components/cardGrid/index.js");require("../../../../components/cardGridItem/index.js"),require("../../../../components/colorList/index.js"),require("../../../../components/contentGutter/index.js"),require("styled-components"),require("../../../../components/fileUpload/index.js"),require("../../../../components/infiniteScroller/index.js"),require("../../../../components/inlineInputForm/index.js"),require("../../../../components/layout/provider.js"),require("../../../../components/layout/scrollable.js"),require("../../../../components/layout/fixed.js"),require("../../../../components/pageStructure/pageStructureComponents.js"),require("../../../../components/pageStructure/leftRail.js"),require("../../../../components/pageStructure/menuButton.js"),require("../../../../components/navProvider.js"),require("../../../../components/scrollToTop/index.js"),require("../../../../components/storyMenu/index.js"),require("../../../../components/table/index.js"),require("../../../config/context.js");var i=require("../../../config/useConfig.js");require("../../../../components/viewStyleBar/index.js"),require("../../../../types.js"),require("../../../../utils/keyboardOnlyOutline.js"),require("@googleforcreators/units"),require("../../../../utils/useStoryView.js"),require("../../../../utils/useTemplateView.js");var n=require("../../../../utils/noop.js"),u=require("./templateGridItem.js");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=l(e);module.exports=function TemplateGridView(e){let{pageSize:l,templates:c,templateActions:p}=e;const{isRTL:m,apiCallbacks:d}=i(),q=r.useRef(),f=r.useRef(),j=r.useRef({}),[g,y]=r.useState(null),{handleDetailsToggle:S,createStoryFromTemplate:x}=p||{},v=Boolean(d?.createStoryFromTemplate);o.useGridViewKeys({containerRef:q,gridRef:f,itemRefs:j,isRTL:m,currentItemId:g,items:c}),r.useEffect((()=>{g&&j.current?.[g]?.querySelector(`.${u.FOCUS_TEMPLATE_CLASS}`)?.focus()}),[g]),r.useFocusOut(q,(()=>y(null)),[]);const T=r.useMemo((()=>c.map((e=>{let{id:r,slug:t,status:o,title:s,postersByPage:i}=e;const c=g===r,p=i?.[0];return a.default.createElement(u.default,{onCreateStory:v?()=>x(r):n.noop,onFocus:()=>{y(r)},onSeeDetailsClick:S,height:l.height,id:r,isActive:c,key:t,posterSrc:p,ref:e=>{j.current[r]=e},slug:t,status:o,title:s})}))),[c,g,v,S,l.height,x]);return a.default.createElement("div",{ref:q},a.default.createElement(s,{pageSize:l,role:"list",ref:f,ariaLabel:t.__("Viewing available templates","web-stories")},T))};
