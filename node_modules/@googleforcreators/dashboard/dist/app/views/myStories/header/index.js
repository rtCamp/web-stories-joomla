/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),r=require("@googleforcreators/react");require("prop-types");var t=require("@googleforcreators/i18n"),o=require("@googleforcreators/tracking"),s=require("styled-components"),n=require("@googleforcreators/design-system"),a=require("../../../../constants/index.js");require("../../../../components/cardGallery/components.js"),require("../../../../components/cardGrid/index.js"),require("../../../../components/cardGridItem/index.js"),require("../../../../components/colorList/index.js"),require("../../../../components/contentGutter/index.js"),require("../../../../components/fileUpload/index.js"),require("../../../../components/infiniteScroller/index.js"),require("../../../../components/inlineInputForm/index.js"),require("../../../../components/layout/provider.js"),require("../../../../components/layout/scrollable.js"),require("../../../../components/layout/fixed.js");var i=require("../../../../components/layout/useLayoutContext.js");require("../../../../components/pageStructure/pageStructureComponents.js"),require("../../../../components/pageStructure/leftRail.js"),require("../../../../components/pageStructure/menuButton.js"),require("../../../../components/navProvider.js"),require("../../../../components/scrollToTop/index.js"),require("../../../../components/storyMenu/index.js"),require("../../../../components/table/index.js"),require("../../../config/context.js"),require("../../../../components/viewStyleBar/index.js"),require("../../../../types.js"),require("../../../../utils/useStoryView.js"),require("../../../../utils/keyboardOnlyOutline.js");var l=require("../../../../utils/useDashboardResultsLabel.js");require("@googleforcreators/units"),require("../../../../utils/useTemplateView.js");var u=require("../../shared/bodyViewOptions.js");require("../../shared/emptyContentMessage.js");var c=require("../../shared/pageHeading.js"),d=require("../../utils/getSearchOptions.js"),p=require("../../../../constants/stories.js");function m(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=m(e);const q=m(s).default(n.Pill).withConfig({displayName:"header__StyledPill",componentId:"sc-vdoh83-0"})(["margin:0 2px;white-space:nowrap;& > span{padding-left:8px;color:",";}"],(e=>{let{theme:r,isActive:t}=e;return t?r.colors.gray[20]:r.colors.fg.tertiary}));var y=r.memo((function Header(e){let{filter:s,initialPageReady:n,search:m,sort:y,stories:g,totalStoriesByStatus:S,view:j,author:f,queryAuthorsBySearch:w,showAuthorDropdown:b}=e;const{actions:{scrollToTop:v}}=i(),{setKeyword:_}=m,x=r.useMemo((()=>d(g)),[g]),T=l({currentFilter:s.value,isActiveSearch:Boolean(m.keyword),totalResults:(s.value.split(",")||[]).reduce(((e,r)=>e+(S[r]||0)),0),view:a.DASHBOARD_VIEWS.DASHBOARD}),C=r.useCallback((e=>{s.set(e),v()}),[s,v]),E=r.useMemo((()=>!n||S&&0===Object.keys(S).length?null:h.default.createElement(h.default.Fragment,null,p.STORY_STATUSES.map((e=>{const{label:r,status:o,value:n}=e;if(!(o in S))return null;const a=S[o];if(0===a)return null;const i=t.sprintf(
/* translators: %s is story status */
t.__("Filter stories by %s","web-stories"),r);return h.default.createElement(q,{key:n,onClick:()=>C(n),isActive:s.value===n,disabled:a<=0,"aria-label":i},r,a&&h.default.createElement("span",null,a))})).filter(Boolean))),[S,s.value,n,C]),A=r.useCallback((e=>{y.set(e),v()}),[v,y]),O=r.useDebouncedCallback((async e=>{await o.trackEvent("search",{search_type:"dashboard",search_term:e}),_(e)}),a.TEXT_INPUT_DEBOUNCE),k=r.useCallback((()=>_("")),[_]);return h.default.createElement(h.default.Fragment,null,h.default.createElement(c,{heading:t.__("Dashboard","web-stories"),searchPlaceholder:t.__("Search Stories","web-stories"),searchOptions:x,handleSearchChange:O,showSearch:n,searchValue:m.keyword,onClear:k},E),h.default.createElement(u,{showGridToggle:!0,showSortDropdown:!0,showAuthorDropdown:b,resultsLabel:T,layoutStyle:j.style,handleLayoutSelect:j.toggleStyle,currentSort:y.value,pageSortOptions:p.STORY_SORT_MENU_ITEMS,handleSortChange:A,author:f,queryAuthorsBySearch:w,sortDropdownAriaLabel:t.__("Choose sort option for display","web-stories")}))}));module.exports=y;
