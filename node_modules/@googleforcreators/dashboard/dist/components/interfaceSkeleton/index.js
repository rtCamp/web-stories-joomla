/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),t=require("@googleforcreators/react"),r=require("@googleforcreators/i18n"),a=require("@googleforcreators/tracking"),u=require("@googleforcreators/design-system");require("prop-types");var n=require("../../app/views/myStories/index.js"),l=require("../../app/views/exploreTemplates/index.js"),i=require("../../constants/index.js");require("../../app/router/routerProvider.js");var s=require("../../app/router/useRouteHistory.js"),o=require("../../app/router/route.js"),c=require("../pageStructure/pageStructureComponents.js"),p=require("../pageStructure/leftRail.js");require("../pageStructure/menuButton.js");var f=require("../../app/api/useApiAlerts.js"),d=require("../../app/api/useApi.js");require("../../app/config/context.js");var m=require("../../app/config/useConfig.js");function E(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var S=E(e);function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},g.apply(this,arguments)}module.exports=e=>{let{additionalRoutes:E}=e;const{currentPath:v,templateId:q,availableRoutes:A}=s((e=>{let{state:t}=e;return{...t,templateId:t.queryParams.id}})),{push:T,setAvailableRoutes:R}=s((e=>{let{actions:t}=e;return t})),{canViewDefaultTemplates:P,leftRailSecondaryNavigation:j=[],documentTitleSuffix:h=r.__("Web Stories","web-stories")}=m(),{addInitialFetchListener:b}=d((e=>{let{actions:{storyApi:{addInitialFetchListener:t}},state:{templates:{templates:r}}}=e;return{currentTemplate:void 0!==q?r[q]?.title:void 0,addInitialFetchListener:t}})),O=t.useRef(v===i.APP_ROUTES.DASHBOARD),[_,y]=t.useState(!O.current);t.useEffect((()=>b?.((e=>{e?.all<=0&&O.current&&P&&T(i.APP_ROUTES.TEMPLATES_GALLERY),y(!0)}))),[b,T,v,P]),t.useEffect((()=>{if(A.length>0)return;const e=E?E.map((e=>{let{path:t}=e;return t})):[];R([...Object.values(i.APP_ROUTES),...e])}),[E,A.length,R]),t.useEffect((()=>{if(!_)return;const e=j.find((e=>e.value===v)),t=i.ROUTE_TITLES[v]||e?.label||i.ROUTE_TITLES.DEFAULT;document.title=r.sprintf(
/* translators: Admin screen title. 1: Admin screen name, 2: Network or site name. */
r.__("%1$s â€¹ %2$s","web-stories"),t,h),a.trackScreenView(t)}),[v,_,j,h]),f();const{clearSnackbar:L,removeSnack:x,placement:k,currentSnacks:U}=u.useSnackbar(),w=t.usePrevious(v);return t.useEffect((()=>{v!==w&&L()}),[L,v,w]),S.default.createElement(S.default.Fragment,null,S.default.createElement(c.AppFrame,null,S.default.createElement(p,null),S.default.createElement(c.PageContent,null,S.default.createElement(o.default,{exact:!0,isDefault:!0,path:i.APP_ROUTES.DASHBOARD,component:S.default.createElement(n,null)}),P&&S.default.createElement(o.default,{path:i.APP_ROUTES.TEMPLATES_GALLERY,component:S.default.createElement(l,null)}),E&&E.map((e=>S.default.createElement(o.default,g({key:e.path},e)))))),S.default.createElement(u.Snackbar.Container,{notifications:U,onRemove:x,placement:k,max:1}))};
