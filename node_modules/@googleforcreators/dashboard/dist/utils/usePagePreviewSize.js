/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@googleforcreators/react"),t=require("@googleforcreators/units");require("../constants/index.js");var r=require("../constants/pageStructure.js");const i=e=>Math.round(e/t.PAGE_RATIO),n=e=>e<=r.MIN_DASHBOARD_WIDTH?r.VIEWPORT_BREAKPOINT.TABLET:r.VIEWPORT_BREAKPOINT.DESKTOP,o=(e,t)=>{let{bp:n,respectSetWidth:o,availableContainerSpace:s}=t;if(o){return{width:e,height:i(e)}}n===r.VIEWPORT_BREAKPOINT.DESKTOP&&(s-=r.DASHBOARD_LEFT_NAV_WIDTH);const a=Math.floor(s/e),u=e+(s-(e*a+r.GRID_SPACING.COLUMN_GAP*(a-1)+2*r.PAGE_WRAPPER.GUTTER))/a;return{width:u,height:i(u)}},s=e=>window.innerWidth<r.MIN_DASHBOARD_WIDTH?r.MIN_DASHBOARD_WIDTH:e;exports.default=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{thumbnailMode:i=!1,isGrid:a}=t,u=e.useRef(document.getElementById(r.WPBODY_ID)),[d,I]=e.useState(window.innerWidth),[T,c]=e.useState(n(d)),[_,A]=e.useState(s(u.current?.offsetWidth||window.innerWidth)),E=e.useDebouncedCallback((e=>{I(e)}),500);return e.useEffect((()=>{c(n(d))}),[d]),e.useResizeEffect(u,(e=>{let{width:t}=e;A(s(t)),window.innerWidth!==d&&E(window.innerWidth)}),[A,d,E]),e.useMemo((()=>({pageSize:o(r.STORY_PREVIEW_WIDTH[i?r.VIEWPORT_BREAKPOINT.THUMBNAIL:T],{respectSetWidth:!a||i,availableContainerSpace:_,bp:T})})),[T,a,i,_])},exports.getPosterHeight=i;
