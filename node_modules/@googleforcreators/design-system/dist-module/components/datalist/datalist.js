/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{forwardRef as r,useRef as t,useState as o,useCallback as n,useDebouncedCallback as i}from"@googleforcreators/react";import s,{css as a}from"styled-components";import"prop-types";import"../dropDown/index.js";import{Popup as l}from"../popup/index.js";import p from"./container.js";import c from"../dropDown/select/index.js";import d from"./list/list.js";import{focusableOutlineCSS as u}from"../../theme/helpers/outline.js";function m(){return m=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},m.apply(this,arguments)}const f=a(["",";"],(e=>{let{theme:r}=e;return u(r.colors.border.focus,r.colors.bg.secondary)})),y=s.div.withConfig({displayName:"datalist__Container",componentId:"sc-quu1n3-0"})(["display:flex;flex-direction:column;flex-grow:1;"]);var h=r((function Datalist(r,s){let{onChange:a,disabled:u=!1,selectedId:h,options:O,hasSearch:g=!1,getOptionsByQuery:v,onObserve:b,primaryOptions:w,primaryLabel:x,priorityOptionGroups:I,searchResultsLabel:S,renderer:D,activeItemRenderer:j,isInline:C=!1,dropDownLabel:E="",highlightStylesOverride:L,hasDropDownBorder:B=!1,zIndex:R,listStyleOverrides:Q,containerStyleOverrides:k,title:q,dropdownButtonLabel:z,...G}=r;const _=t(),K=t();if(!O&&!v)throw new Error("Dropdown initiated with invalid params: options or getOptionsByQuery has to be set");g||(w=O);const N=t(),[P,T]=o(!1),W=n((()=>{T(!1),N.current?.focus()}),[N]),A=n((()=>T((e=>!e))),[]),F=i(W,100),H=n((e=>{a(e),T(!1),N.current?.focus()}),[a,N]),J=n((()=>{_.current?.focus()}),[]),M=e.createElement(p,{ref:_,isOpen:P,onClose:F,getOptionsByQuery:v,hasSearch:g,isInline:C,title:q,hasDropDownBorder:B,containerStyleOverrides:k,renderContents:r=>{let{searchKeyword:t,setIsExpanded:o,trigger:n,queriedOptions:i,listId:s}=r;return e.createElement(d,{ref:K,listId:s,value:h,keyword:t,onSelect:H,onClose:F,onExpandedChange:o,focusTrigger:n,onObserve:b,options:O||i,primaryOptions:w,primaryLabel:x,priorityOptionGroups:I,searchResultsLabel:S,focusSearch:J,renderer:D,listStyleOverrides:Q})}}),U=n((e=>{"function"==typeof s?s(e):s&&(s.current=e),N.current=e}),[s]),V=w.find((e=>{let{id:r}=e;return r===h}));return e.createElement(y,null,e.createElement(c,m({"aria-pressed":P,"aria-haspopup":!0,"aria-expanded":P,ref:U,activeItemLabel:V?.name,activeItemRenderer:j,dropDownLabel:E,onSelectClick:A,selectButtonStylesOverride:L||f,"aria-label":z},G)),P&&!u&&C&&M,!u&&!C&&e.createElement(l,{anchor:N,isOpen:P,fillWidth:240,zIndex:R},M))}));export{h as default};
