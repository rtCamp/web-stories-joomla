/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useState as e,useDebouncedCallback as t,useMemo as o,useEffect as l,useCallback as a}from"@googleforcreators/react";import{sprintf,_n,__}from"@googleforcreators/i18n";import{getOptions as n}from"../menu/utils.js";import s from"../../utils/useLiveRegion.js";function u(u){let{handleSearchValueChange:i,selectedValue:r,options:v}=u;const g=s("assertive"),[d,f]=e(!1),p=t(f,100),c=o((()=>({value:d,set:p})),[d,p]),[h,m]=e(!1),w=t(m,300,{leading:!0}),O=o((()=>({value:h,set:w})),[h,w]);l((()=>{c.value||w(!1)}),[c,w]);const S=o((()=>v&&0!==v.length?n(v):[]),[v]),b=a((e=>S.flatMap((e=>e.group)).find((t=>t?.value?.toString().toLowerCase()===e.toString().toLowerCase()))),[S]),C=o((()=>r?.value&&0!==S.length?b(r.value):null),[r,S,b]),[L,j]=e(void 0),M=o((()=>({value:L,set:j})),[L]);return l((()=>{void 0===M?.value&&void 0!==r?.value&&M.set(r?.label||"")}),[M,r]),l((()=>{i?.(M.value)}),[i,M]),l((()=>{if(c.value&&M.value?.length){const e=v.length?sprintf(
/* translators: %d number of options in dropdown */
_n("%d result found.","%d results found.",v.length,"web-stories"),v.length):__("No results found.","web-stories");g(e)}}),[M.value,c.value,v.length,g]),{activeOption:C,getActiveOption:b,normalizedOptions:S,inputState:M,isMenuFocused:O,isOpen:c}}export{u as default};
