/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import t,{css as r}from"styled-components";import{useRef as o,useState as n,useCallback as i,useLayoutEffect as a}from"@googleforcreators/react";import"prop-types";import{useKeyDownEffect as l}from"../keyboard/index.js";import{Tooltip as p}from"../tooltip/index.js";import"../popup/index.js";import{PLACEMENT as u}from"../popup/constants.js";import{noop as m}from"../../utils/noop.js";function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}const h=24,s=r(["appearance:none;width:","px;height:","px;background-color:",";cursor:pointer;border-radius:50px;"],(e=>{let{thumbSize:t}=e;return t}),(e=>{let{thumbSize:t}=e;return t}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryNormal})),d=r(["background-color:",";"],(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryHover})),b=r(["z-index:2;border:2px solid ",";padding:2px;background-clip:content-box;width:","px;height:","px;margin-left:","px;"],(e=>{let{theme:t}=e;return t.colors.accent.secondary}),(e=>{let{thumbSize:t}=e;return t+8}),(e=>{let{thumbSize:t}=e;return t+8}),(e=>{let{thumbSize:t,width:r,percentage:o}=e;return function(e,t,r){const o=Math.ceil(f(4,t,r));return 2*e*.01*o-o}(o,t,r)})),g=t.input.attrs({type:"range"}).withConfig({displayName:"slider__Input",componentId:"sc-1ldl77h-0"})(["z-index:1;position:relative;min-width:100px;cursor:pointer;outline:none;background:",";border-radius:100px;height:4px;appearance:none;flex:1;margin:0;::-webkit-slider-thumb{","}::-moz-range-thumb{","}::-ms-thumb{","}::before{z-index:-1;position:absolute;content:' ';height:6px;top:calc(50% - 3px);left:-calc( ","% - 4px );width:","%;background-color:",";border-radius:50px;}:hover{::before{background-color:",";}::-webkit-slider-thumb{","}::-moz-range-thumb{","}::-ms-thumb{","}}&:focus{&::-webkit-slider-thumb{","}&::-moz-range-thumb{","}&::-ms-thumb{","}}"],(e=>{let{theme:t}=e;return t.colors.bg.quaternary}),s,s,s,(e=>{let{percentage:t,thumbSize:r,width:o}=e;return f(t,r,o)}),(e=>{let{percentage:t=0}=e;return t}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryNormal}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryHover}),d,d,d,b,b,b);function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return r||(r=1),(r-t)/r*e}const x=t.div.withConfig({displayName:"slider__Wrapper",componentId:"sc-1ldl77h-1"})(["position:relative;left:0;top:0;"]),v=t.div.withConfig({displayName:"slider__FakeThumb",componentId:"sc-1ldl77h-2"})(["width:0;height:0;position:absolute;left:","px;top:","px;"],(e=>{let{thumbSize:t}=e;return t/2}),(e=>{let{thumbSize:t}=e;return-t/2+12}));function Slider(t){let{minorStep:r,majorStep:s,handleChange:d=m,value:b,min:f=0,max:w=500,thumbSize:y=h,suffix:z="",...S}=t;const k=o(),j=o(),[C,N]=n(null),_=i(((e,t)=>{let o=b+e*(t?s:r);o="number"==typeof f?Math.max(f,o):o,o="number"==typeof w?Math.min(w,o):o,d(o)}),[r,s,d,f,w,b]),B=(b-f)/(w-f)*100;a((()=>{if(k.current&&!C){const{width:e}=k.current.getBoundingClientRect();N(e)}}),[k,C]),l(k,["left","down"],(()=>_(-1,!0)),[_]),l(k,["right","up"],(()=>_(1,!0)),[_]),l(k,["shift+left","shift+down"],(()=>_(-1,!1)),[_]),l(k,["shift+right","shift+up"],(()=>_(1,!1)),[_]);const E=`${b}${z}`;return e.createElement(p,{title:E,placement:u.TOP,forceAnchorRef:j,tooltipProps:{style:{transform:`translate(${(C-y)*B/100}px, 0)`}}},e.createElement(x,null,e.createElement(g,c({percentage:B,ref:k,onChange:e=>d(e.target.valueAsNumber),step:r,value:b,min:f,max:w,thumbSize:y,width:C,"aria-valuenow":b,"aria-valuetext":E},S)),e.createElement(v,{ref:j,percentage:B,width:C,thumbSize:y})))}export{Slider};
