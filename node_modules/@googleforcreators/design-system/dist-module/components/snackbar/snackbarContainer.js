/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import t from"react";import{useRef as e,useMemo as n,useCallback as a,useEffect as o}from"@googleforcreators/react";import r from"prop-types";import i from"styled-components";import{TransitionGroup as s,CSSTransition as c}from"react-transition-group";import{v4 as m}from"uuid";import"../popup/index.js";import{SnackbarMessage as l}from"./snackbarMessage.js";import{noop as p}from"../../utils/noop.js";import{PLACEMENT as u}from"../popup/constants.js";import f from"../../utils/useLiveRegion.js";function d(){return d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},d.apply(this,arguments)}const g=i.div.withConfig({displayName:"snackbarContainer__StyledContainer",componentId:"sc-7yig0q-0"})(["position:fixed;top:",";bottom:",";",";margin-bottom:33px;display:flex;flex-direction:column;align-items:",";width:100%;z-index:2147483647;pointer-events:none;"],(t=>{let{placement:e}=t;return 0===e.indexOf("top")?0:"inherit"}),(t=>{let{placement:e}=t;return 0===e.indexOf("bottom")?0:"inherit"}),(function(t){let{placement:e}=t;switch(e){case"top":case"bottom":return"\n      left: calc(50% + 4rem);\n      transform: translateX(-50%);\n      width: auto;\n    ";case"top-left":case"bottom-left":default:return"left: 60px;";case"top-right":case"bottom-right":return"right: 60px;"}}),(t=>{let{alignItems:e}=t;return e}));g.propTypes={alignItems:r.string},g.defaultProps={alignItems:"center"};const b=i.div.withConfig({displayName:"snackbarContainer__ChildContainer",componentId:"sc-7yig0q-1"})(["&.react-snackbar-alert__snackbar-container-enter{max-height:0px;opacity:0;transition:all 300ms ease-out;}&.react-snackbar-alert__snackbar-container-enter-active{opacity:1;max-height:100px;transition:all 300ms ease-out;}&.react-snackbar-alert__snackbar-container-exit{opacity:1;transition:all 300ms ease-out;}&.react-snackbar-alert__snackbar-container-exit-active{opacity:0;transition:all 300ms ease-out;}"]),SnackbarContainer=r=>{let{component:i=l,notifications:h=[],onRemove:x=p,placement:v=u.BOTTOM,max:y=10}=r;const k=f("assertive"),_=e(new Set),O=n((()=>h.map((()=>m()))),[h]),w=0===v.indexOf("top")?[...h].reverse():h,C=a((t=>()=>{x(t),t.onDismiss?.()}),[x]);o((()=>{"number"==typeof y&&h.length>y&&setTimeout((()=>{x(h.slice(0,h.length-y))}),300)}),[y,h,x]),o((()=>{h.forEach((t=>{if(!_.current.has(t)){const e=`${t.message} ${t.actionHelpText||""}`.trim();k(e),_.current.add(t)}}))}),[h,k]);const j=e();return t.createElement(g,{placement:v},t.createElement(s,null,w.map(((e,n)=>{const{actionLabel:a,dismissible:o,message:r,onAction:s,preventActionDismiss:m,preventAutoDismiss:l,timeout:p,...u}=e;return t.createElement(c,{in:!0,key:e.id||O[n],timeout:300,unmountOnExit:!0,nodeRef:j,classNames:"react-snackbar-alert__snackbar-container"},t.createElement(b,{ref:j,placement:v},t.createElement(i,d({},u,{"aria-hidden":!0,placement:v,onDismiss:C(e),onAction:s,actionLabel:a,message:r,showCloseButton:o,removeMessageTimeInterval:p,isPreventAutoDismiss:l,isPreventActionDismiss:m}))))}))))};export{SnackbarContainer};
