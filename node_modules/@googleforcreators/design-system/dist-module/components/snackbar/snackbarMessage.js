/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import t from"prop-types";import{useRef as r,useEffect as o,useCallback as n}from"@googleforcreators/react";import{rgba as s}from"polished";import i,{css as a}from"styled-components";import{__}from"@googleforcreators/i18n";import{THEME_CONSTANTS as l}from"../../theme/constants/index.js";import{DEFAULT_MESSAGE_Z_INDEX as m,THUMBNAIL_STATUS as c,AUTO_REMOVE_MESSAGE_TIME_INTERVAL_MAX as p,AUTO_REMOVE_MESSAGE_TIME_INTERVAL_MIN as d}from"./constants.js";import{Text as u}from"../typography/text/index.js";import{noop as h}from"../../utils/noop.js";import g from"../../icons/checkmark_small.svg.js";import f from"../../icons/exclamation_outline.svg.js";import b from"../../icons/cross.svg.js";import{Button as v}from"../button/button.js";import{focusableOutlineCSS as x}from"../../theme/helpers/outline.js";function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},y.apply(this,arguments)}const w=i.div.withConfig({displayName:"snackbarMessage__MessageContainer",componentId:"sc-fjv091-0"})(["display:flex;align-items:center;justify-content:space-between;min-height:48px;padding:10px 16px;margin-top:20px;background-color:",";color:",";border:",";border-radius:",";z-index:",";pointer-events:auto;"],(e=>{let{theme:t}=e;return t.colors.inverted.bg.primary}),(e=>{let{theme:t}=e;return t.colors.inverted.fg.primary}),(e=>{let{theme:t}=e;return`1px solid ${s(t.colors.standard.white,.24)}`}),(e=>{let{theme:t}=e;return t.borders.radius.medium}),(e=>{let{customZIndex:t}=e;return t||m}));w.propTypes={customZIndex:t.number};const C=i(u).withConfig({displayName:"snackbarMessage__Message",componentId:"sc-fjv091-1"})(["color:",";max-width:430px;padding-right:",";"],(e=>{let{theme:t}=e;return t.colors.inverted.fg.primary}),(e=>{let{hasAction:t,hasThumbnail:r}=e;return r?"16px":t?"52px":"0px"})),j=i.div.withConfig({displayName:"snackbarMessage__ActionContainer",componentId:"sc-fjv091-2"})(["display:flex;align-items:center;justify-content:flex-end;"]),E=i.div.withConfig({displayName:"snackbarMessage__ThumbnailWrapper",componentId:"sc-fjv091-3"})(["position:relative;margin-left:16px;margin-right:","px;"],(e=>{let{hasAction:t}=e;return t?16:0})),_=i.img.withConfig({displayName:"snackbarMessage__Thumbnail",componentId:"sc-fjv091-4"})(["max-height:45px;max-width:45px;min-height:","px;min-width:","px;background-color:",";border-radius:",";",";"],30,30,(e=>{let{theme:t}=e;return t.colors.fg.tertiary}),(e=>{let{theme:t}=e;return t.borders.radius.small}),(e=>{let{theme:t,status:r}=e;return r===c.SUCCESS?a(["border:1px solid ",";"],t.colors.green[20]):r===c.ERROR?a(["border:1px solid ",";"],t.colors.red[20]):void 0})),k=i.div.withConfig({displayName:"snackbarMessage__ThumbnailIcon",componentId:"sc-fjv091-5"})(["position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);",";svg{width:100%;height:auto;}"],(e=>{let{theme:t,status:r}=e;return r===c.SUCCESS?a(["width:30px;color:",";"],t.colors.fg.positive):r===c.ERROR?a(["width:20px;color:",";"],t.colors.fg.negative):void 0})),I=i(v).withConfig({displayName:"snackbarMessage__ActionButton",componentId:"sc-fjv091-6"})(["align-self:flex-end;min-width:1px;height:2em;padding:0;color:",";font-weight:",";"," &:hover,&:active{color:",";}"],(e=>{let{theme:t}=e;return t.colors.inverted.fg.linkNormal}),(e=>{let{theme:t}=e;return t.typography.weight.bold}),(e=>{let{theme:t}=e;return x(t.colors.border.focus,t.colors.inverted.bg.primary)}),(e=>{let{theme:t}=e;return t.colors.inverted.fg.linkHover})),S=i(v).withConfig({displayName:"snackbarMessage__CloseButton",componentId:"sc-fjv091-7"})(["height:2em;padding:0;margin-left:16px;color:",";"," svg{height:32px;}"],(e=>{let{theme:t}=e;return t.colors.inverted.fg.primary}),(e=>{let{theme:t}=e;return x(t.colors.border.focus,t.colors.inverted.bg.primary)})),SnackbarMessage=t=>{let{"aria-label":s,actionLabel:i,onAction:a=h,onDismiss:m=h,isPreventAutoDismiss:u,isPreventActionDismiss:v,thumbnail:x,message:A,removeMessageTimeInterval:M,showCloseButton:T,placement:R="bottom",actionHelpText:N,...O}=t;const P=r();P.current=u?h:m;const B=r("number"==typeof M&&M<=p&&M>=d?M:p);o((()=>{if(!P.current)return h;const e=setTimeout((()=>P.current()),B.current);return()=>clearTimeout(e)}),[]);const D=n((e=>{a(e),!v&&m()}),[a,m,v]),H=Boolean(i),L=Boolean(i);return e.createElement(w,y({role:"alert",hasAction:H,placement:R},O),e.createElement(C,{"aria-label":s,size:l.TYPOGRAPHY.PRESET_SIZES.SMALL,hasAction:H,hasThumbnail:L},A),x&&e.createElement(E,{hasAction:H},e.createElement(_,{src:x.src,alt:x.alt,status:x.status}),e.createElement(k,{status:x.status},x.status===c.SUCCESS&&e.createElement(g,null),x.status===c.ERROR&&e.createElement(f,null))),(i||T)&&e.createElement(j,null,i&&e.createElement(I,{onClick:D},i),T&&e.createElement(S,{onClick:m,"aria-label":__("Close","web-stories"),tabIndex:-1},e.createElement(b,{"aria-hidden":!0}))))};SnackbarMessage.defaultProps={showCloseButton:!0};export{SnackbarMessage};
