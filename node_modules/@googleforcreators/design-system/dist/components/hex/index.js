/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@googleforcreators/react");require("prop-types");var t=require("polished"),a=require("@googleforcreators/patterns"),u=require("../keyboard/index.js"),n=require("../input/index.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=o(e);function c(){return c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},c.apply(this,arguments)}const s=r.forwardRef((function Hex(e,o){let{value:s,placeholder:i,onChange:f,...p}=e;const[b,d]=r.useState(""),g=r.useRef(null),v=r.useRef(!1),y=a.getPreviewText(s);r.useEffect((()=>d(y)),[y]);const h=r.useCallback((e=>{const r=e.target.value.trim().replace(/^#/,"");d(r)}),[]),k=r.useCallback((()=>{const e=a.getHexFromValue(b)??y;if(d(e),e!==y){const{red:r,green:a,blue:u}=t.parseToRgb(`#${e}`),n=s.color.a;f({color:{r:r,g:a,b:u,a:n}})}}),[b,y,f,s]),x=r.useCallback((()=>{k()}),[k]),q=r.useCallback((()=>{v.current||k(),v.current=!1}),[k]),C=r.useCallback((()=>{d(y),v.current=!0;(o?.current?o:g).current.blur()}),[y,o]);return u.useKeyDownEffect(g,{key:["escape"],editable:!0},C,[C]),u.useKeyDownEffect(g,{key:["enter"],editable:!0},x,[x]),l.default.createElement(n.Input,c({ref:o||g,value:b||"",onChange:h,onBlur:q,placeholder:i},p))}));exports.HexInput=s;
