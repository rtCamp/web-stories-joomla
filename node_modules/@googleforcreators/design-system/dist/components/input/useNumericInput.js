/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("big.js"),t=require("@googleforcreators/react"),u=require("./validation.js");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=r(e);exports.useNumericInput=e=>{let{allowEmpty:r,isFloat:l,max:n,min:s,onChange:o,value:c}=e;const i=t.useRef(null),d=t.useRef(c),p=t.useRef(!1),[f,m]=t.useState(c),b=t.useMemo((()=>({allowEmpty:r,isFloat:l,max:n,min:s})),[r,l,n,s]),h=t.useCallback((e=>{let t=u.parseInput(d.current,b);if(!p.current){const e=u.parseInput(f,b);null!==e&&(t=e)}p.current=!1,null!==t&&(m(t),t!==d.current&&o(e,t))}),[f,o,b]),v=t.useCallback((e=>{m(e.target.value)}),[]),y=t.useCallback((e=>{const{altKey:t,key:r}=e;let l=u.isInputValid(f,b)?u.parseInput(f,b):0;const c=a.default(b.isFloat&&t?.1:1);"ArrowUp"===r?l=void 0!==n?Math.min(n,a.default(l).plus(c)):a.default(l).plus(c):"ArrowDown"===r&&(l=void 0!==s?Math.max(s,a.default(l).minus(c)):a.default(l).minus(c)),o(e,Number(l))}),[f,n,s,o,b]),g=t.useCallback((()=>{m(d.current),p.current=!0,i&&i.current?.blur()}),[]);return t.useEffect((()=>{d.current=c,m(c)}),[c]),{currentValue:f,inputRef:i,handleBlur:h,handleChange:v,handleEsc:g,handleKeyUpAndDown:y,isIndeterminate:d.current===f}};
