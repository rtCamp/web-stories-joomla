/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("@googleforcreators/react"),t=require("@googleforcreators/i18n"),u=require("../menu/utils.js"),s=require("../../utils/useLiveRegion.js");module.exports=function(l){let{handleSearchValueChange:o,selectedValue:a,options:n}=l;const i=s("assertive"),[r,c]=e.useState(!1),v=e.useDebouncedCallback(c,100),g=e.useMemo((()=>({value:r,set:v})),[r,v]),[f,d]=e.useState(!1),p=e.useDebouncedCallback(d,300,{leading:!0}),h=e.useMemo((()=>({value:f,set:p})),[f,p]);e.useEffect((()=>{g.value||p(!1)}),[g,p]);const b=e.useMemo((()=>n&&0!==n.length?u.getOptions(n):[]),[n]),m=e.useCallback((e=>b.flatMap((e=>e.group)).find((t=>t?.value?.toString().toLowerCase()===e.toString().toLowerCase()))),[b]),M=e.useMemo((()=>a?.value&&0!==b.length?m(a.value):null),[a,b,m]),[S,C]=e.useState(void 0),O=e.useMemo((()=>({value:S,set:C})),[S]);return e.useEffect((()=>{void 0===O?.value&&void 0!==a?.value&&O.set(a?.label||"")}),[O,a]),e.useEffect((()=>{o?.(O.value)}),[o,O]),e.useEffect((()=>{if(g.value&&O.value?.length){const e=n.length?t.sprintf(
/* translators: %d number of options in dropdown */
t._n("%d result found.","%d results found.",n.length,"web-stories"),n.length):t.__("No results found.","web-stories");i(e)}}),[O.value,g.value,n.length,i]),{activeOption:M,getActiveOption:m,normalizedOptions:b,inputState:O,isMenuFocused:h,isOpen:g}};
