/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("styled-components"),r=require("@googleforcreators/react");require("prop-types");var n=require("../keyboard/index.js"),o=require("../tooltip/index.js");require("../popup/index.js");var i=require("../popup/constants.js"),u=require("../../utils/noop.js");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=a(e),c=a(t);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}const p=24,h=t.css(["appearance:none;width:","px;height:","px;background-color:",";cursor:pointer;border-radius:50px;"],(e=>{let{thumbSize:t}=e;return t}),(e=>{let{thumbSize:t}=e;return t}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryNormal})),d=t.css(["background-color:",";"],(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryHover})),m=t.css(["z-index:2;border:2px solid ",";padding:2px;background-clip:content-box;width:","px;height:","px;margin-left:","px;"],(e=>{let{theme:t}=e;return t.colors.accent.secondary}),(e=>{let{thumbSize:t}=e;return t+8}),(e=>{let{thumbSize:t}=e;return t+8}),(e=>{let{thumbSize:t,width:r,percentage:n}=e;return function(e,t,r){const n=Math.ceil(b(4,t,r));return 2*e*.01*n-n}(n,t,r)})),f=c.default.input.attrs({type:"range"}).withConfig({displayName:"slider__Input",componentId:"sc-1ldl77h-0"})(["z-index:1;position:relative;min-width:100px;cursor:pointer;outline:none;background:",";border-radius:100px;height:4px;appearance:none;flex:1;margin:0;::-webkit-slider-thumb{","}::-moz-range-thumb{","}::-ms-thumb{","}::before{z-index:-1;position:absolute;content:' ';height:6px;top:calc(50% - 3px);left:-calc( ","% - 4px );width:","%;background-color:",";border-radius:50px;}:hover{::before{background-color:",";}::-webkit-slider-thumb{","}::-moz-range-thumb{","}::-ms-thumb{","}}&:focus{&::-webkit-slider-thumb{","}&::-moz-range-thumb{","}&::-ms-thumb{","}}"],(e=>{let{theme:t}=e;return t.colors.bg.quaternary}),h,h,h,(e=>{let{percentage:t,thumbSize:r,width:n}=e;return b(t,r,n)}),(e=>{let{percentage:t=0}=e;return t}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryNormal}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.primaryHover}),d,d,d,m,m,m);function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return r||(r=1),(r-t)/r*e}const g=c.default.div.withConfig({displayName:"slider__Wrapper",componentId:"sc-1ldl77h-1"})(["position:relative;left:0;top:0;"]),x=c.default.div.withConfig({displayName:"slider__FakeThumb",componentId:"sc-1ldl77h-2"})(["width:0;height:0;position:absolute;left:","px;top:","px;"],(e=>{let{thumbSize:t}=e;return t/2}),(e=>{let{thumbSize:t}=e;return-t/2+12}));exports.Slider=function Slider(e){let{minorStep:t,majorStep:a,handleChange:c=u.noop,value:h,min:d=0,max:m=500,thumbSize:b=p,suffix:v="",...y}=e;const w=r.useRef(),z=r.useRef(),[S,k]=r.useState(null),E=r.useCallback(((e,r)=>{let n=h+e*(r?a:t);n="number"==typeof d?Math.max(d,n):n,n="number"==typeof m?Math.min(m,n):n,c(n)}),[t,a,c,d,m,h]),j=(h-d)/(m-d)*100;r.useLayoutEffect((()=>{if(w.current&&!S){const{width:e}=w.current.getBoundingClientRect();k(e)}}),[w,S]),n.useKeyDownEffect(w,["left","down"],(()=>E(-1,!0)),[E]),n.useKeyDownEffect(w,["right","up"],(()=>E(1,!0)),[E]),n.useKeyDownEffect(w,["shift+left","shift+down"],(()=>E(-1,!1)),[E]),n.useKeyDownEffect(w,["shift+right","shift+up"],(()=>E(1,!1)),[E]);const q=`${h}${v}`;return l.default.createElement(o.Tooltip,{title:q,placement:i.PLACEMENT.TOP,forceAnchorRef:z,tooltipProps:{style:{transform:`translate(${(S-b)*j/100}px, 0)`}}},l.default.createElement(g,null,l.default.createElement(f,s({percentage:j,ref:w,onChange:e=>c(e.target.valueAsNumber),step:t,value:h,min:d,max:m,thumbSize:b,width:S,"aria-valuenow":h,"aria-valuetext":q},y)),l.default.createElement(x,{ref:z,percentage:j,width:S,thumbSize:b})))};
