/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import t from"react";import"prop-types";import{useMemo as e}from"@googleforcreators/react";import{generatePatternStyles as o,createSolid as a}from"@googleforcreators/patterns";import{dataToEditorX as r,dataToEditorY as n,dataToFontSizeY as l}from"@googleforcreators/units";import i from"classnames";import{BACKGROUND_TEXT_MODE as s}from"@googleforcreators/elements";import{getHTMLFormatters as c}from"@googleforcreators/rich-text";import{generateParagraphTextStyle as m,getHighlightLineheight as p,calcFontMetrics as d}from"./util.js";function TextOutputWithUnits(r){let{element:n,dataToStyleX:l,dataToStyleY:g,dataToFontSizeY:u,dataToPaddingX:f,dataToPaddingY:T,className:h}=r;const{content:x,backgroundColor:y,backgroundTextMode:b,padding:k,borderRadius:E,tagName:v="p",...$}=n;u||(u=g),f||(f=l),T||(T=g);const S={vertical:k.vertical?T(k.vertical):0,horizontal:k.horizontal?f(k.horizontal):0},z=S.vertical||S.horizontal?`${S.vertical} ${S.horizontal}`:0,H=b!==s.NONE?o(y):void 0,{dataToEditorY:N,font:O,...Y}=m($,l,g,u,n,T),B={...Y,color:"#000000",padding:z},L=k.vertical?parseFloat(g(k.vertical)):0,W=parseFloat(g($.fontSize)),_=p($.lineHeight,L/W,"em"),F={...B,...H,margin:0,padding:0,background:"none",lineHeight:_,overflowWrap:"break-word"},I={...F,position:"absolute",top:0,left:0,right:0},w=t=>{const{marginOffset:e}=d(t);return{display:"block",position:"relative",left:0,top:"0",margin:`${T(-e/2)} 0`,WebkitBoxDecorationBreak:"clone",boxDecorationBreak:"clone"}},D={...H,WebkitBoxDecorationBreak:"clone",boxDecorationBreak:"clone",position:"relative",padding:z,textAlign:Y.textAlign,borderRadius:`${E?.topLeft||0}px ${E?.topRight||0}px ${E?.bottomRight||0}px ${E?.bottomLeft||0}px`},M={...D,color:"transparent"},P={...D,background:"none"},R=x.replace(/\n$/,"\n\n"),X=e((()=>c().setColor(R,a(0,0,0))),[R]);return h=i(h,"text-wrapper"),b===s.HIGHLIGHT?t.createElement(t.Fragment,null,t.createElement(v,{className:h,style:F},t.createElement("span",{style:w(n)},t.createElement("span",{style:M,dangerouslySetInnerHTML:{__html:X}}))),t.createElement(v,{className:h,style:I,"aria-hidden":"true"},t.createElement("span",{style:w(n)},t.createElement("span",{style:P,dangerouslySetInnerHTML:{__html:R}})))):t.createElement(v,{className:h,style:B},t.createElement("span",{dangerouslySetInnerHTML:{__html:R}}))}function TextOutput(e){let{element:o}=e;const{width:a}=o;return t.createElement(TextOutputWithUnits,{element:o,className:"fill",dataToStyleX:t=>`${r(t,100)}%`,dataToStyleY:t=>`${n(t,100)}%`,dataToFontSizeY:t=>`${l(t,100)}em`,dataToPaddingX:t=>t/a*100+"%",dataToPaddingY:t=>t/a*100+"%"})}export{TextOutputWithUnits,TextOutput as default};
