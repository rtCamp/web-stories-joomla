/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import t from"react";import{renderToStaticMarkup as e}from"@googleforcreators/react";import{dataPixels as o,PAGE_HEIGHT as n}from"@googleforcreators/units";import{TextOutputWithUnits as r}from"../text/output.js";import{calcFontMetrics as i}from"../text/util.js";function f(){return f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},f.apply(this,arguments)}const l={boxSizing:"border-box",visibility:"hidden",position:"fixed",contain:"layout paint",top:"-9999px",left:"-9999px",zIndex:-1,overflowWrap:"break-word",...!1},a={dataToStyleX:t=>`${t}px`,dataToStyleY:t=>`${t}px`},s="__WEB_STORIES_LASTEL__";function c(t,e){const o=u(t);return m(o,{width:`${e}px`,height:null}),o.parentNode.offsetHeight}function p(t,e,r){const f=u(t);m(f,{width:`${e}px`,height:null,fontSize:null});let l,a=1,s=n;for(;s-a>1;){const e=o((a+s)/2),{marginOffset:n}=i({...t,fontSize:e});l=n,m(f,{fontSize:`${e}px`,margin:-n/2+"px 0"});f.offsetHeight-n>r?s=e:a=e}return m(f,{fontSize:`${a}px`,margin:-l/2+"px 0"}),{fontSize:a,marginOffset:l}}function u(o){let n=document.body.__WEB_STORIES_MEASURER__;return n||(n=document.createElement("div"),n.id="__web-stories-text-measurer",n.className="web-stories-content",m(n,l),document.body.appendChild(n),document.body.__WEB_STORIES_MEASURER__=n),function(t,e){const o=t[s];if(t[s]=e,!t.firstElementChild||!o)return!0;return o!==e}(n,o)&&(n.innerHTML=e(t.createElement(r,f({element:o},a)),n)),n.firstElementChild}function m(t,e){for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const n=e[o];t.style[o]=null===n?"":n}}export{p as calculateFitTextFontSize,c as calculateTextHeight};
