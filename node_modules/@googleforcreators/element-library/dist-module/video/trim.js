/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import t from"styled-components";import"prop-types";import{useRef as o,useMemo as r,useCallback as i}from"@googleforcreators/react";import{getMediaSizePositionProps as n}from"@googleforcreators/media";import{CircularProgress as s}from"@googleforcreators/design-system";import{getTransformFlip as a}from"@googleforcreators/elements";import m from"../media/display.js";import{elementWithFlip as l}from"../shared/shared.js";import"../shared/layerText.js";import"@googleforcreators/patterns";import"@googleforcreators/transform";import c from"./playPauseButton.js";import{videoWithScale as p,getBackgroundStyle as f}from"./util.js";import d from"./captions.js";function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},g.apply(this,arguments)}const u=t.video.withConfig({displayName:"trim__Video",componentId:"sc-cj7igq-0"})(["position:absolute;max-width:initial;max-height:initial;"," ",""],p,l),h=t.div.withConfig({displayName:"trim__Wrapper",componentId:"sc-cj7igq-1"})(["width:100%;height:100%;position:absolute;"]),y=t.div.withConfig({displayName:"trim__Spinner",componentId:"sc-cj7igq-2"})(["position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;"]);function VideoTrim(t){let{box:l,element:p,isRTL:j,topOffset:E,resource:w,setVideoNode:x,getProxiedUrl:v}=t;const{width:b,height:O}=l,{poster:R,tracks:T,isBackground:_,scale:k,flip:P,focalX:I,focalY:N}=p,V=o(),q=o();let C={};if(_){const e=f();C={...C,...e}}const B=r((()=>({...l,x:0,y:0})),[l]),F=i((e=>{q.current=e,x(e)}),[x]);if(!w)return e.createElement(h,null,e.createElement(y,null,e.createElement(s,null)));const L=n(w,b,O,k,P?.horizontal?100-I:I,P?.vertical?100-N:N);L.transformFlip=a(P),L.crossOrigin="anonymous";const z=T.map((e=>{const t=v(e,e?.track);return{...e,track:t}}));return e.createElement(e.Fragment,null,e.createElement(h,{ref:V},e.createElement(m,{element:p,mediaRef:q,showPlaceholder:!0,previewMode:!1},e.createElement(u,g({poster:R||w.poster,style:C},L,{preload:"metadata",autoPlay:!0,tabIndex:0,ref:F}),w.src&&e.createElement("source",{src:w.src,type:w.mimeType}),e.createElement(d,{tracks:z})))),e.createElement(c,{box:B,element:p,elementRef:V,videoRef:q,shouldResetOnEnd:!1,isRTL:j,topOffset:E}))}export{VideoTrim as default};
