/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{convertFromHTML as e,ContentState as t,SelectionState as s,Modifier as o}from"draft-js";import r from"./formatters/convert.js";class CustomBlockRenderMap{constructor(){this._map={unstyled:{element:"div",aliasedElements:["p","h1","h2","h3","blockquote","pre"]},"unordered-list-item":{element:"li"},"ordered-list-item":{element:"li"}}}mapKeys(e){return Object.keys(this._map).map((t=>e(t,this._map[t])))}}function l(l){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const a=new CustomBlockRenderMap,{contentBlocks:i,entityMap:m}=e(l,void 0,a),p=t.createFromBlockArray(i,m),u=n(p),y=o.applyEntity(p,u,null),d=y.getBlocksAsArray();let f=y,g=null,h=0;d.forEach((e=>{const t=s.createEmpty(e.getKey());f=r(e,t,f);const l=e.getType();if("unstyled"!==l){let s=null;switch(l){case"unordered-list-item":s="â€“ ";break;case"ordered-list-item":h=g===l?h+1:1,s=`${h}. `}s&&(f=o.insertText(f,t,s));const r=t.merge({focusOffset:e.getLength()});f=o.setBlockType(f,r,"unstyled")}g=l}));const k=n(f);return c.forEach((e=>{f=o.applyInlineStyle(f,k,e)})),f.getBlockMap()}function n(e){const t=e.getFirstBlock(),o=e.getLastBlock();return s.createEmpty(t.getKey()).merge({focusKey:o.getKey(),focusOffset:o.getLength()})}export{l as default};
