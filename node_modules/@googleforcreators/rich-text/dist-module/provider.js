/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import t from"react";import"prop-types";import{useState as e,useRef as r,useMemo as o,useCallback as n}from"@googleforcreators/react";import{EditorState as i}from"draft-js";import l from"./context.js";import{getSelectionForAll as s,getSelectionForOffset as a,getFilteredState as c,getHandleKeyCommandFromState as m}from"./util.js";import u from"./getStateInfo.js";import{useFauxSelection as p}from"./fauxSelection.js";import f from"./customImport.js";import d from"./customExport.js";import C from"./useHandlePastedText.js";import g from"./useSelectionManipulation.js";const S={isBold:!1,isItalic:!1,isUnderline:!1,isUppercase:!1};function RichTextProvider(j){let{children:x,editingState:h}=j;const[I,v]=e(null),P=r(null),y=o((()=>I?u(I):S),[I]),T=n((t=>{const{offset:e,clearContent:r,selectAll:o}=h||{};let n,l=i.createWithContent(f(t));r&&(l=i.push(l,f(""),"remove-range")),o?n=s(l.getCurrentContent()):isNaN(e)||(n=a(l.getCurrentContent(),e)),n&&(l=i.forceSelection(l,n)),P.current=l.getCurrentInlineStyle(),v(l)}),[h,v]);p(I,v);const E=n((t=>{let e=c(t,I);""===e.getCurrentContent().getPlainText("")?e=i.setInlineStyleOverride(e,P.current):P.current=e.getCurrentInlineStyle(),v(e)}),[I,v]),A=n((()=>m(E)),[E]),B=C(v),F=n((()=>{v(null)}),[v]),H=Boolean(I),N=g(I,v),R={state:{editorState:I,hasCurrentEditor:H,selectionInfo:y},actions:{setStateFromContent:T,updateEditorState:E,getHandleKeyCommand:A,handlePastedText:B,clearState:F,selectionActions:N,getContentFromState:d}};return t.createElement(l.Provider,{value:R},x)}export{RichTextProvider as default};
