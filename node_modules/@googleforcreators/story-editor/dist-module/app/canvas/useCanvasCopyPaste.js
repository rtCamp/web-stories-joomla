/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useCallback as e,useBatchingCallback as t}from"@googleforcreators/react";import{usePasteTextContent as o}from"@googleforcreators/rich-text";import"../../constants/fonts.js";import"../../constants/multipleValue.js";import"@googleforcreators/animation";import"uuid";import"@googleforcreators/masks";import"@googleforcreators/element-library";import"@googleforcreators/elements";import"react";import"prop-types";import"../story/context.js";import"@googleforcreators/migration";import"@googleforcreators/templates";import"../config/context.js";import"../api/context.js";import"../history/historyProvider.js";import"../history/context.js";import"../story/actions/useSaveStory.js";import"clone-deep";import"../story/useStoryReducer/useStoryReducer.js";import"@googleforcreators/output";import"../story/storyTriggers/storyTriggersProvider.js";import"../story/storyTriggers/storyEvents/onInitialElementAddedRegister.js";import"../story/storyTriggers/storyEvents/onPageAddedRegister.js";import r from"../story/useStory.js";import s from"../../utils/useGlobalClipboardHandlers.js";import{addElementsToClipboard as n,processPastedElements as i}from"../../utils/copyPaste.js";import m from"../../components/canvas/useUploadWithPreview.js";import l from"../../components/canvas/useInsertElement.js";import{DEFAULT_PRESET as a}from"../../components/library/panes/text/textPresets.js";import c from"./useAddPastedElements.js";function p(){const p=c(),{currentPage:g,selectedElements:d,deleteSelectedElements:u,selectedElementAnimations:f}=r((e=>{let{state:{currentPage:t,selectedElements:o,selectedElementAnimations:r},actions:{deleteSelectedElements:s}}=e;return{currentPage:t,selectedElements:o,deleteSelectedElements:s,selectedElementAnimations:r}})),y=m(),j=l(),E=o(j,a),h=e((e=>{const{type:t}=e;0!==d.length&&(n(g,d,f,e),"cut"===t&&u(),e.preventDefault())}),[g,u,d,f]),v=t((e=>{const{elements:t,animations:o}=i(e,g);return p(t,o)}),[p,g]),x=e((e=>{const{clipboardData:t}=e;try{const o=!t.files?.length&&(t.getData("text/html")||t.getData("text/plain"));if(o){const t=document.createElement("template");t.innerHTML=o.replace(/<meta[^>]+>/g,"").replace(/<\/?html>/g,"").replace(/<\/?body>/g,"");let r=v(t.content);r||(r=E(t.innerHTML)),r&&e.preventDefault()}const{items:r}=t,s=[];for(let e=0;e<r.length;e++){const t=r[e].getAsFile();t&&s.push(t)}s.length>0&&y(s)}catch(e){}}),[v,E,y]);s(h,x)}export{p as default};
