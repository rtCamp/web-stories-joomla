/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

const e="set_state",t="clear",r="replay",s={entries:[],offset:0,requestedState:null,versionNumber:0},n=e=>(t,r)=>{let{type:n,payload:a}=r;const u=t.entries[t.offset];switch(n){case"set_state":if(t.requestedState){if(Object.keys(t.requestedState).every((e=>t.requestedState[e]===a[e]))){const e=t.entries.indexOf(t.requestedState);if(u.pages!==t.requestedState.pages&&u.pages.length===t.requestedState.pages.length&&u.current!==t.requestedState.current){const r=u.pages.filter(((e,r)=>e!==t.requestedState.pages[r]));if(1===r.length){const s=r[0].id,n={...t.requestedState,current:s};return{...t,offset:e,requestedState:n}}}return{...t,offset:e,requestedState:null}}}return{entries:[a,...t.entries.slice(t.offset)].slice(0,e),versionNumber:t.versionNumber+1,offset:0,requestedState:null};case"replay":return{...t,versionNumber:t.versionNumber+(t.offset-a),requestedState:t.entries[a]};case"clear":return{...s};default:throw new Error(`Unknown history reducer action: ${n}`)}};export{t as CLEAR_HISTORY,s as EMPTY_STATE,r as REPLAY,e as SET_CURRENT_STATE,n as default};
