/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useSnackbar as e}from"@googleforcreators/design-system";import{__}from"@googleforcreators/i18n";import{useRef as t,useCallback as o}from"@googleforcreators/react";import{trackEvent as r}from"@googleforcreators/tracking";import"@googleforcreators/transform";import"../../../components/dropTargets/provider.js";import"../../../components/dropTargets/context.js";import"../../history/historyProvider.js";import s from"../../history/useHistory.js";import"react";import"prop-types";import"@googleforcreators/templates";import"../../config/context.js";import"../../api/context.js";import"@googleforcreators/fonts";import"@googleforcreators/dom";import"../../../constants/fonts.js";import"../../../constants/multipleValue.js";import"../../font/context.js";import"@googleforcreators/media";import"@googleforcreators/animation";import"uuid";import"@googleforcreators/masks";import"@googleforcreators/element-library";import"@googleforcreators/elements";import"../../story/context.js";import"@googleforcreators/migration";import"../../story/actions/useSaveStory.js";import"clone-deep";import"../../story/useStoryReducer/useStoryReducer.js";import"@googleforcreators/output";import"../../story/storyTriggers/storyTriggersProvider.js";import"../../story/storyTriggers/storyEvents/onInitialElementAddedRegister.js";import"../../story/storyTriggers/storyEvents/onPageAddedRegister.js";import n from"../../story/useStory.js";import"../../media/useUploadMedia.js";import"@googleforcreators/patterns";import"../../../utils/generateBlurhash.worker.js";import"../../media/media3p/providerConfiguration.js";import"../../media/utils/useFFmpeg.js";import"../../media/media3p/api/context.js";import"../../media/local/constants.js";import"../../media/media3p/providerReducer.js";import"../../media/context.js";import"sat";import"@googleforcreators/units";import"../../layout/context.js";import"../../layout/useZoomSetting.js";import"@googleforcreators/rich-text";import"@googleforcreators/stickers";import"../../../components/library/panes/text/textPresets.js";import"../../canvas/context.js";import i from"../../canvas/useCanvas.js";import"../../currentUser/context.js";import"../../helpCenter/provider.js";import"../../helpCenter/context.js";import"../../../components/helpCenter/constants.js";import"../context.js";import a from"../../../components/design/updateProperties.js";import{UNDO_HELP_TEXT as m}from"./constants.js";const c=()=>{const{clearBackgroundElement:c,duplicateElementsById:p,selectedElements:d,setBackgroundElement:l,updateElementsById:g}=n((e=>{let{state:t,actions:o}=e;return{clearBackgroundElement:o.clearBackgroundElement,duplicateElementsById:o.duplicateElementsById,selectedElements:t.selectedElements,setBackgroundElement:o.setBackgroundElement,updateElementsById:o.updateElementsById}})),u=e((e=>e.showSnackbar)),y=i((e=>{let{actions:t}=e;return t.setEditingElement})),f=s((e=>{let{actions:t}=e;return t.undo})),j=t(f);j.current=f;return{handleDuplicateSelectedElements:o((()=>{d.length&&(p({elementIds:d.map((e=>{let{id:t}=e;return t}))}),u({actionLabel:__("Undo","web-stories"),dismissible:!1,message:__("Duplicated elements.","web-stories"),onAction:()=>{j.current(),r("context_menu_action",{name:"undo_duplicate_elements",elements:d.map((e=>e.type))})},actionHelpText:m}),r("context_menu_action",{name:"duplicate_elements",elements:d.map((e=>e.type))}))}),[p,d,u]),handleOpenScaleAndCrop:o((e=>{const t=d?.[0];t&&(y(t.id,e),r("context_menu_action",{name:"open_scale_and_crop",element:t.type,isBackground:t.isBackground}))}),[d,y]),handleSetPageBackground:o((()=>{const e=d?.[0];e&&!e.isBackground&&(l({elementId:e.id}),u({actionLabel:__("Undo","web-stories"),dismissible:!1,message:__("Set page background.","web-stories"),onAction:()=>{j.current(),r("context_menu_action",{name:"undo_set_page_background",element:e.type,isBackground:e.isBackground})},actionHelpText:m}),r("context_menu_action",{name:"set_as_page_background",element:e.type,isBackground:e.isBackground}))}),[d,l,u]),handleRemovePageBackground:o((()=>{const e=d?.[0];e&&e.isBackground&&(g({elementIds:[e.id],properties:e=>a(e,{isBackground:!1,opacity:100,overlay:null},!0)}),c(),u({actionLabel:__("Undo","web-stories"),dismissible:!1,message:__("Removed page background.","web-stories"),onAction:()=>{j.current(),r("context_menu_action",{name:"undo_remove_page_background",elements:e.type,isBackground:e.isBackground})},actionHelpText:m}),r("context_menu_action",{name:"remove_media_from_background",element:e.type,isBackground:e.isBackground}))}),[c,d,u,g])}};export{c as default};
