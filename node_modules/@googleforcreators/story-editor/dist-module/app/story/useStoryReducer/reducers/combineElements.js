/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{v4 as e}from"uuid";import{canMaskHaveBorder as t,canSupportMultiBorder as r}from"@googleforcreators/masks";import{DEFAULT_ATTRIBUTES_FOR_MEDIA as o}from"@googleforcreators/element-library";import s from"../../../../utils/objectPick.js";import i from"../../../../utils/objectWithout.js";import{removeAnimationsWithElementIds as n}from"./utils.js";function a(a,l){let{firstElement:u,secondId:c,shouldRetainAnimations:d=!0}=l;if(!u||!c)return a;const m=u.id,f=u,p=a.pages.findIndex((e=>{let{id:t}=e;return t===a.current})),g=a.pages[p],h=g.elements.findIndex((e=>{let{id:t}=e;return t===c})),k=g.elements[h];if(!f||!f.resource||!k)return a;const b=k.isDefaultBackground?{defaultBackgroundElement:{...k,id:e()}}:{},j=["alt","type","resource","scale","focalX","focalY","tracks","poster"];k.isBackground?(j.push("flip"),j.push("overlay")):(j.push("link"),t(k)&&(j.push("border"),r(k)&&j.push("borderRadius")));const B=s(f,j),x=s(f,["width","height","x","y"]),y={...i(k,["isDefaultBackground"]),...o,...B,...k.isBackground?x:{}},I=g.elements.filter((e=>{let{id:t}=e;return t!==m})).map((e=>e.id===c?y:e)),D=n(g.animations,d?[m]:[m,c]),E={...g,elements:I,...b,animations:D},R=[...a.pages.slice(0,p),E,...a.pages.slice(p+1)];return{...a,pages:R,selection:[c]}}export{a as default};
