/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import t from"react";import o,{StyleSheetManager as r}from"styled-components";import{__}from"@googleforcreators/i18n";import{ContextMenu as e}from"@googleforcreators/design-system";import{useRef as i,useMemo as s,useEffect as p,createPortal as m}from"@googleforcreators/react";import{ELEMENT_TYPES as n}from"@googleforcreators/elements";import"@googleforcreators/transform";import"../dropTargets/provider.js";import"../dropTargets/context.js";import"../../app/history/historyProvider.js";import"../../app/history/context.js";import"prop-types";import"@googleforcreators/templates";import"../../app/config/context.js";import a from"../../app/config/useConfig.js";import"../../app/api/context.js";import"@googleforcreators/fonts";import"@googleforcreators/dom";import"../../constants/fonts.js";import"../../constants/multipleValue.js";import"../../app/font/context.js";import"@googleforcreators/media";import"@googleforcreators/tracking";import"@googleforcreators/animation";import"uuid";import"@googleforcreators/masks";import"@googleforcreators/element-library";import"../../app/story/context.js";import"@googleforcreators/migration";import"../../app/story/actions/useSaveStory.js";import"clone-deep";import"../../app/story/useStoryReducer/useStoryReducer.js";import"@googleforcreators/output";import"../../app/story/storyTriggers/storyTriggersProvider.js";import"../../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js";import"../../app/story/storyTriggers/storyEvents/onPageAddedRegister.js";import c from"../../app/story/useStory.js";import"../../app/media/useUploadMedia.js";import"@googleforcreators/patterns";import"../../utils/generateBlurhash.worker.js";import"../../app/media/media3p/providerConfiguration.js";import"../../app/media/utils/useFFmpeg.js";import"../../app/media/media3p/api/context.js";import"../../app/media/local/constants.js";import"../../app/media/media3p/providerReducer.js";import"../../app/media/context.js";import"sat";import"@googleforcreators/units";import"../../app/layout/context.js";import"../../app/layout/useZoomSetting.js";import"@googleforcreators/rich-text";import"@googleforcreators/stickers";import"../library/panes/text/textPresets.js";import"../../app/canvas/context.js";import"../../app/currentUser/context.js";import"../../app/helpCenter/provider.js";import"../../app/helpCenter/context.js";import"../helpCenter/constants.js";import l from"../../app/rightClickMenu/useRightClickMenu.js";import g from"../directionAware/index.js";import"../../app/rightClickMenu/context.js";import"../form/color/color.js";import"../form/filterToggle/filterToggle.js";import"../form/linkIcon.js";import"../form/link.js";import"../form/media.js";import"../form/row.js";import"../form/switch.js";import"../form/textArea.js";import"../form/context.js";import"../form/dateTime/dateTime.js";import"../form/required.js";import"../form/radioGroup/index.js";import"../form/select/select.js";import"../form/hierarchical/index.js";import"../../app/rightClickMenu/hooks/constants.js";import u from"../../app/rightClickMenu/menus/foregroundMediaMenu.js";import f from"../../app/rightClickMenu/menus/multipleElementsMenu.js";import d from"../../app/rightClickMenu/menus/pageMenu.js";import j from"../../app/rightClickMenu/menus/shapeMenu.js";import y from"../../app/rightClickMenu/menus/stickerMenu.js";import h from"../../app/rightClickMenu/menus/textMenu.js";import x from"../../app/story/utils/isEmptyStory.js";import M from"../../app/rightClickMenu/menus/emptyStateMenu.js";const k=o.div.withConfig({displayName:"rightClickMenu__RightClickMenuContainer",componentId:"sc-11e09ag-0"})(["position:absolute;top:","px;left:","px;z-index:9999;"],(t=>{let{position:o}=t;return o?.y??0}),(t=>{let{position:o}=t;return o?.x??0})),RightClickMenu=()=>{const{isRTL:o}=a(),{selectedElements:C,isThisEmptyStory:E}=c((t=>({selectedElements:t.state.selectedElements,isThisEmptyStory:x(t.state.pages)}))),{isMenuOpen:T,menuPosition:v,onCloseMenu:R,maskRef:S}=l(),P=i(),w=t=>{t.preventDefault(),t.stopPropagation()},I=s((()=>{if(E)return M;if(C.length>1)return f;const t=C?.[0];if(t?.isDefaultBackground)return d;switch(t?.type){case n.IMAGE:case n.VIDEO:case n.GIF:return t?.isBackground?d:u;case n.SHAPE:return j;case n.TEXT:return h;case n.STICKER:return y;default:return d}}),[C,E]);return p((()=>{const t=P.current;return t.addEventListener("contextmenu",w),()=>{t.removeEventListener("contextmenu",w)}}),[P]),m(t.createElement(r,{stylisPlugins:[]},t.createElement(k,{position:v,ref:P},t.createElement(g,null,t.createElement(e,{"data-testid":"right-click-context-menu",isOpen:T,onDismiss:R,"aria-label":__("Context Menu for the selected element","web-stories"),maskRef:S,onMouseDown:t=>t.stopPropagation(),isRTL:o},t.createElement(I,{parentMenuRef:P}))))),document.body)};export{RightClickMenu as default};
