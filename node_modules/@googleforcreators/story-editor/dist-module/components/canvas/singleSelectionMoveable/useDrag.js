/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useUnits as t}from"@googleforcreators/units";import{useBatchingCallback as r}from"@googleforcreators/react";import"../../dropTargets/provider.js";import e from"../../dropTargets/useDropTargets.js";import"@googleforcreators/transform";import"../../../app/history/historyProvider.js";import"../../../app/history/context.js";import"react";import"prop-types";import"@googleforcreators/templates";import"../../../app/config/context.js";import"../../../app/api/context.js";import"@googleforcreators/fonts";import"@googleforcreators/dom";import"../../../constants/fonts.js";import"../../../constants/multipleValue.js";import"../../../app/font/context.js";import"@googleforcreators/media";import"@googleforcreators/tracking";import"@googleforcreators/animation";import"uuid";import"@googleforcreators/masks";import"@googleforcreators/element-library";import"@googleforcreators/elements";import"../../../app/story/context.js";import"@googleforcreators/migration";import"../../../app/story/actions/useSaveStory.js";import"clone-deep";import"../../../app/story/useStoryReducer/useStoryReducer.js";import"@googleforcreators/output";import"../../../app/story/storyTriggers/storyTriggersProvider.js";import"../../../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js";import"../../../app/story/storyTriggers/storyEvents/onPageAddedRegister.js";import o from"../../../app/story/useStory.js";import"@googleforcreators/i18n";import"../../../app/media/useUploadMedia.js";import"@googleforcreators/patterns";import"../../../utils/generateBlurhash.worker.js";import"@googleforcreators/design-system";import"../../../app/media/media3p/providerConfiguration.js";import"../../../app/media/utils/useFFmpeg.js";import"../../../app/media/media3p/api/context.js";import"../../../app/media/local/constants.js";import"../../../app/media/media3p/providerReducer.js";import"../../../app/media/context.js";import"sat";import"../../../app/layout/context.js";import"../../../app/layout/useZoomSetting.js";import"@googleforcreators/rich-text";import"@googleforcreators/stickers";import"../../library/panes/text/textPresets.js";import"../../../app/canvas/context.js";import"../../../app/currentUser/context.js";import"../../../app/helpCenter/provider.js";import"../../../app/helpCenter/context.js";import"../../helpCenter/constants.js";import"../../../app/rightClickMenu/context.js";import s from"../utils/useElementOutOfCanvas.js";import a from"../utils/useFullbleedMediaAsBackground.js";function p(p){let{setIsDragging:i,resetMoveable:n,selectedElement:m,setTransformStyle:l,frame:g}=p;const{isDropSource:c,handleDrag:d,handleDrop:u,setDraggingResource:f}=e((t=>{let{actions:{handleDrag:r,handleDrop:e,isDropSource:o,setDraggingResource:s}}=t;return{handleDrag:r,handleDrop:e,setDraggingResource:s,isDropSource:o}})),{handleElementOutOfCanvas:j}=s(),{handleFullbleedMediaAsBackground:y}=a({selectedElement:m}),{updateSelectedElements:D}=o((t=>({updateSelectedElements:t.actions.updateSelectedElements}))),{editorToDataX:h,editorToDataY:x}=t((t=>{let{actions:{editorToDataX:r,editorToDataY:e}}=t;return{editorToDataX:r,editorToDataY:e}})),T=r((t=>{i(!1),f(null),n(t)}),[i,f,n]);return{onDrag:t=>{let{target:r,beforeTranslate:e,clientX:o,clientY:s}=t;i(!0),c(m.type)&&f(m.resource),g.translate=e,l(r,g),c(m.type)&&d(m.resource,o,s,m.id)},throttleDrag:0,onDragStart:t=>{let{set:r}=t;r(g.translate)},onDragEnd:t=>{let{target:r,isDrag:e}=t;if(!e)return!1;if(j(r))return i(!1),void f(null);const o=t=>Math.abs(t)<=1?0:t,[s,a]=g.translate;if(0!==s||0!==a){const t={x:o(m.x+h(s)),y:o(m.y+x(a))};D({properties:t}),c(m.type)&&u(m.resource,m.id)}T(r),y(r)}}}export{p as default};
