/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import"prop-types";import o from"styled-components";import"@googleforcreators/patterns";import{themeHelpers as l,Text as t,THEME_CONSTANTS as r,Button as i,Icons as c,BUTTON_VARIANTS as a,BUTTON_TYPES as s,BUTTON_SIZES as n,localStore as d,LOCAL_STORAGE_PREFIX as m}from"@googleforcreators/design-system";import{__}from"@googleforcreators/i18n";import{useState as p}from"@googleforcreators/react";import y from"../../app/story/useStory.js";import C from"../eyedropper/index.js";import{BASIC_COLORS as f,CONFIRMATION_DIALOG_STORAGE_KEY as g}from"./constants.js";import u from"./header.js";import E from"./basicColorList.js";import b from"./confirmationDialog.js";import h from"./useDeleteColor.js";const w=o.div.withConfig({displayName:"basicColorPicker__Body",componentId:"sc-c2cm2c-0"})(["display:flex;flex-direction:column;padding:8px 16px 0;overflow:auto;",";"],l.scrollbarCSS),S=o.div.withConfig({displayName:"basicColorPicker__Footer",componentId:"sc-c2cm2c-1"})(["padding:8px 16px 16px;display:flex;flex-direction:column;"]),x=o.div.withConfig({displayName:"basicColorPicker__SavedColors",componentId:"sc-c2cm2c-2"})(["border-bottom:1px solid ",";padding-bottom:16px;"],(e=>{let{theme:o}=e;return o.colors.border.defaultNormal})),P=o.div.withConfig({displayName:"basicColorPicker__DefaultColors",componentId:"sc-c2cm2c-3"})([""]),k=o(t).attrs({size:r.TYPOGRAPHY.PRESET_SIZES.SMALL}).withConfig({displayName:"basicColorPicker__Label",componentId:"sc-c2cm2c-4"})(["color:",";margin:12px 0 10px;"],(e=>{let{theme:o}=e;return o.colors.fg.secondary})),_=o(k).withConfig({displayName:"basicColorPicker__DefaultText",componentId:"sc-c2cm2c-5"})(["margin:0 0 0 8px;color:",";"],(e=>{let{theme:o}=e;return o.colors.fg.primary})),v=o(i).withConfig({displayName:"basicColorPicker__StyledButton",componentId:"sc-c2cm2c-6"})(["display:flex;justify-content:center;align-items:center;gap:4px;flex-basis:100%;"]),I=o(t).withConfig({displayName:"basicColorPicker__StyledText",componentId:"sc-c2cm2c-7"})(["padding:5px 10px;"]),N=o(c.PlusOutline).withConfig({displayName:"basicColorPicker__StyledPlus",componentId:"sc-c2cm2c-8"})(["width:32px;margin:-8px 0;"]),L=o.div.withConfig({displayName:"basicColorPicker__EyedropperWrapper",componentId:"sc-c2cm2c-9"})(["display:flex;"]);function BasicColorPicker(o){let{color:l,handleColorChange:t,allowsOpacity:A,allowsGradient:D,allowsSavedColors:G,showCustomPicker:M,handleClose:O,showDialog:R,setShowDialog:j,changedStyle:T,hasEyedropper:Y,allowsSavedColorDeletion:B,shouldCloseOnSelection:z}=o;const{savedColors:F,storyColors:H}=y((e=>({savedColors:e.state.story?.globalStoryStyles?.colors||[],storyColors:e.state.story?.currentStoryStyles?.colors||[]}))),[Q,U]=p(!1),[Z,K]=p(null),W=H.length>0||F.length>0,{initEyedropper:q}=C({onChange:e=>t({color:e})}),{deleteLocalColor:J,deleteGlobalColor:V}=h({onEmpty:()=>U(!1)}),X=e=>{t(e),z&&O()},$=function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Q)return void X(e);if(o)return void J(e);const l=d.getItemByKey(m[g]);l?V(e):(j(!0),K(e))},ee=!z||B;return e.createElement(e.Fragment,null,ee&&e.createElement(u,{handleClose:O,isEditMode:Q,setIsEditMode:U,hasPresets:W&&G},e.createElement(_,null,__("Color","web-stories"))),e.createElement(w,null,Y&&e.createElement(L,null,e.createElement(i,{variant:a.SQUARE,type:s.QUATERNARY,size:n.SMALL,"aria-label":__("Pick a color from canvas","web-stories"),onClick:q(),onPointerEnter:q(!1)},e.createElement(c.Pipette,null)),e.createElement(I,{size:r.TYPOGRAPHY.PRESET_SIZES.SMALL},__("Sample color","web-stories"))),G&&e.createElement(x,null,e.createElement(k,{id:"colorpicker-story-colors-title"},__("Current story","web-stories")),e.createElement(E,{color:l,colors:H,handleClick:$,isLocal:!0,allowsOpacity:A,allowsGradient:D,"aria-labelledby":"colorpicker-story-colors-title",isEditMode:Q,"data-testid":"saved-story-colors",changedStyle:T}),e.createElement(k,{id:"colorpicker-saved-colors-title"},__("Saved colors","web-stories")),e.createElement(E,{color:l,colors:F,isGlobal:!0,handleClick:$,allowsOpacity:A,allowsGradient:D,"aria-labelledby":"colorpicker-saved-colors-title",isEditMode:Q,changedStyle:T})),e.createElement(P,null,e.createElement(k,{id:"colorpicker-default-colors-title"},__("Default","web-stories")),e.createElement(E,{color:l,colors:f,handleClick:e=>{X(e),U(!1)},allowsOpacity:A,allowsGradient:D,"aria-labelledby":"colorpicker-default-colors-title",isEditMode:!1}))),e.createElement(S,null,e.createElement(v,{onClick:M,type:s.SECONDARY,size:n.SMALL,variant:a.RECTANGLE},__("Custom","web-stories"),e.createElement(N,null))),R&&e.createElement(b,{onClose:()=>j(!1),onPrimary:()=>{V(Z),K(null),j(!1)}}))}export{BasicColorPicker as default};
