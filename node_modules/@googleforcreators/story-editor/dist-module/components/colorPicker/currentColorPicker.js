/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{lazy as t,useCallback as r,Suspense as o,useRef as n,useState as i,useEffect as a}from"@googleforcreators/react";import"prop-types";import l,{css as c}from"styled-components";import{__}from"@googleforcreators/i18n";import{Button as p,BUTTON_VARIANTS as s,BUTTON_TYPES as m,BUTTON_SIZES as u,Icons as d,CircularProgress as h}from"@googleforcreators/design-system";import f from"../eyedropper/index.js";import g from"./pointer.js";import C from"./editablePreview.js";const x=t((()=>import("react-color/lib/components/common").then((e=>({default:e.Saturation}))))),b=t((()=>import("react-color/lib/components/common").then((e=>({default:e.Hue}))))),y=t((()=>import("react-color/lib/components/common").then((e=>({default:e.Alpha}))))),E=l.div.withConfig({displayName:"currentColorPicker__BodyFallback",componentId:"sc-eqs4bc-0"})(["height:","px;display:flex;align-items:center;justify-content:center;"],240),v=l.div.withConfig({displayName:"currentColorPicker__SaturationWrapper",componentId:"sc-eqs4bc-1"})(["position:relative;margin:0 16px;flex:0 1 ","px;"],116),w=c(["margin:0 16px;border:1px solid ",";flex:0 0 ","px;position:relative;border-radius:","px;background-clip:padding-box;"],(e=>{let{theme:t}=e;return t.colors.shadow.active}),20,50),k=l.div.withConfig({displayName:"currentColorPicker__HueWrapper",componentId:"sc-eqs4bc-2"})(["",""],w),P=l.div.withConfig({displayName:"currentColorPicker__AlphaWrapper",componentId:"sc-eqs4bc-3"})([""," div:first-child div:first-child div:first-child{background-image:conic-gradient( "," 0.25turn,transparent 0turn 0.5turn,"," 0turn 0.75turn,transparent 0turn 1turn ) !important;background-size:8px 8px !important;}"],w,(e=>{let{theme:t}=e;return t.colors.fg.tertiary}),(e=>{let{theme:t}=e;return t.colors.fg.tertiary})),_=l.div.withConfig({displayName:"currentColorPicker__Footer",componentId:"sc-eqs4bc-4"})(["height:","px;line-height:19px;position:relative;margin:0 16px;display:flex;justify-content:space-between;"],36),N=l.div.withConfig({displayName:"currentColorPicker__HexValue",componentId:"sc-eqs4bc-5"})(["width:","px;"],74),A=l.div.withConfig({displayName:"currentColorPicker__Opacity",componentId:"sc-eqs4bc-6"})(["width:","px;"],52);function CurrentColorPicker(t){let{rgb:n,hsl:i,hsv:a,hex:l,onChange:c,showOpacity:h,hasEyedropper:E}=t;const w=String(Math.round(100*n.a)),I="#"===l[0]?l.substr(1):l,q=r((e=>("transparent"===e&&(e="000000"),`#${e}`)),[]),j=r((e=>`${e}%`),[]),F=r((e=>c({hex:e})),[c]),S=r((e=>c({...n,a:isNaN(e)?1:parseInt(e)/100})),[n,c]),{initEyedropper:z}=f({onChange:c});return e.createElement(e.Fragment,null,e.createElement(o,{fallback:null},e.createElement(v,null,e.createElement(x,{radius:"8px",pointer:()=>e.createElement(g,{offsetX:-8,offsetY:-8,currentColor:n}),hsl:i,hsv:a,onChange:c})),e.createElement(k,null,e.createElement(b,{direction:"horizontal",height:"20px",radius:"50px",pointer:()=>e.createElement(g,{offsetX:-8,offsetY:1,currentColor:n}),hsl:i,onChange:c})),h&&e.createElement(P,null,e.createElement(y,{direction:"horizontal",height:"20px",radius:"50px",pointer:()=>e.createElement(g,{offsetX:-8,offsetY:1,currentColor:n,withAlpha:!0}),rgb:n,hsl:i,onChange:c}))),e.createElement(_,null,E&&e.createElement(p,{variant:s.SQUARE,type:m.QUATERNARY,size:u.SMALL,"aria-label":__("Pick a color from canvas","web-stories"),onClick:z(),onPointerEnter:z(!1)},e.createElement(d.Pipette,null)),e.createElement(N,null,e.createElement(C,{label:__("Edit hex value","web-stories"),value:I,onChange:F,width:80,format:q})),h&&e.createElement(A,null,e.createElement(C,{label:__("Edit opacity","web-stories"),value:w,width:52,format:j,onChange:S}))))}CurrentColorPicker.defaultProps={showOpacity:!0};var I=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];function DynamicFetcher(t){const o=n(!1),[l,c]=i(null);return a((()=>(o.current=!0,import("react-color").then((e=>{let{CustomPicker:t}=e;o.current&&c({component:t(...r)})})),()=>{o.current=!1})),[]),l?e.createElement(l.component,t):e.createElement(E,null,e.createElement(h,null))}return DynamicFetcher}(CurrentColorPicker);export{I as default};
