/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import"prop-types";import t from"styled-components";import{lazy as r,useState as o,useCallback as n,useRef as a,useMemo as l,useLayoutEffect as i,Suspense as c}from"@googleforcreators/react";import{useKeyDownEffect as p,Text as s,THEME_CONSTANTS as d}from"@googleforcreators/design-system";import{focusStyle as m}from"../panels/shared/styles.js";const u=r((()=>import("react-color/lib/components/common").then((e=>({default:e.EditableInput}))))),f=t.button.withConfig({displayName:"editablePreview__Preview",componentId:"sc-cdmcf1-0"})(["margin:0;padding:5px 7px;border:1px solid ",";border-radius:4px;background:transparent;color:",";width:100%;",";"],(e=>{let{theme:t}=e;return t.colors.border.defaultNormal}),(e=>{let{theme:t}=e;return t.colors.fg.primary}),m),b=t.div.withConfig({displayName:"editablePreview__Wrapper",componentId:"sc-cdmcf1-1"})(["input{",";}"],m);function EditablePreview(t){let{label:r,value:m,width:g,format:E,onChange:h}=t;const[x,w]=o(!1),v=n((()=>w(!0)),[]),P=n((()=>w(!1)),[]),y=a(null),C=a(),T=l((()=>({input:{textAlign:"center",textTransform:"lowercase",width:"100%",padding:"6px 12px",border:"1px solid #5E6668",color:"#E4E5E6",borderRadius:"4px",background:"transparent",lineHeight:"18px"},wrap:{lineHeight:0,maxWidth:`${g}px`}})),[g]);p(y,{key:"esc",editable:!0},P,[x]);if(i((()=>{const e=setTimeout((()=>{x&&C.current&&(C.current.input.focus(),C.current.input.select(),C.current.input.setAttribute("aria-label",r))}));return()=>clearTimeout(e)}),[x,r]),!x)return e.createElement(f,{"aria-label":r,onClick:v,onFocus:v},e.createElement(s,{size:d.TYPOGRAPHY.PRESET_SIZES.SMALL},E(m)));const k="transparent"===m?"000000":m;return e.createElement(b,{ref:y,tabIndex:-1,onBlur:e=>{e.currentTarget.contains(e.relatedTarget)||P()}},e.createElement(c,{fallback:null},e.createElement(u,{value:k,ref:C,onChange:h,onChangeComplete:P,style:T})))}EditablePreview.defaultProps={label:"",value:""};export{EditablePreview as default};
