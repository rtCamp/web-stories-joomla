/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{lazy as t,useRef as r,useMemo as a,useCallback as n,useEffect as o,Suspense as c}from"@googleforcreators/react";import l from"styled-components";import"prop-types";import{_x}from"@googleforcreators/i18n";import{CircularProgress as i}from"@googleforcreators/design-system";import s from"./calendarWrapper.js";const d=t((()=>import("react-calendar"))),p=l.div.withConfig({displayName:"datePicker__FallbackCalendar",componentId:"sc-9qun1q-0"})(["height:256px;width:350px;display:flex;align-items:center;justify-content:center;"]);function DatePicker(t){let{currentDate:l,onChange:m,onViewChange:u}=t;const f=r(),b=a((()=>new Date(l)),[l]),g=n((e=>{e.setHours(b.getHours()),e.setMinutes(b.getMinutes()),m(e.toISOString(),!0)}),[b,m]),h=n((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(f.current){const t=[...f.current.querySelectorAll(".react-calendar__navigation button")];t[0].tabIndex="0",t.shift();for(const e of t)e.tabIndex="-1";const r=[...f.current.querySelectorAll(".react-calendar__viewContainer button")];let a=!1;for(const t of r)t.classList.contains("react-calendar__tile--now")?(t.tabIndex="0",e&&t.focus(),a=!0):t.tabIndex="-1";a||(r[0].tabIndex="0",r[0].focus())}}),[f]);return o((()=>{const e=setTimeout((()=>{h()}));return()=>{clearTimeout(e)}}),[h]),e.createElement(c,{fallback:e.createElement(p,null,e.createElement(i,null))},e.createElement(s,{ref:f},e.createElement(d,{value:b,onChange:g,onViewChange:u,onActiveStartDateChange:()=>h(!0),nextAriaLabel:_x("Next","This label can apply to next month, year and/or decade","web-stories"),prevAriaLabel:_x("Previous","This label can apply to previous month, year and/or decade","web-stories"),next2AriaLabel:_x("Jump forward","This label can apply to month, year and/or decade","web-stories"),prev2AriaLabel:_x("Jump backwards","This label can apply to month, year and/or decade","web-stories")})))}export{DatePicker as default};
