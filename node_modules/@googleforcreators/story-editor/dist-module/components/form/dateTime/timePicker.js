/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import t,{css as o}from"styled-components";import"prop-types";import{__}from"@googleforcreators/i18n";import{useRef as n,useEffect as r}from"@googleforcreators/react";import i from"./timeZone.js";const a=t.div.withConfig({displayName:"timePicker__TimeWrapper",componentId:"sc-14og2kb-0"})(["margin-bottom:1em;padding:0 20px;"]),s=t.fieldset.withConfig({displayName:"timePicker__Fieldset",componentId:"sc-14og2kb-1"})(["margin-top:0.5em;position:relative;"]),l=t.legend.withConfig({displayName:"timePicker__Legend",componentId:"sc-14og2kb-2"})(["position:absolute;top:-999em;left:-999em;"]),p=t.div.withConfig({displayName:"timePicker__InputRow",componentId:"sc-14og2kb-3"})(["display:flex;"]),c=o(["min-height:30px;box-shadow:0 0 0 transparent;transition:box-shadow 0.1s linear;border-radius:4px;border:1px solid #006edc;height:28px;vertical-align:middle;background-color:",";color:#32373c;"],(e=>{let{theme:t}=e;return t.colors.standard.white})),d=t.input.withConfig({displayName:"timePicker__NumberInput",componentId:"sc-14og2kb-4"})([""," padding:0;margin-right:4px;text-align:center;width:50%;max-width:50px;::-webkit-inner-spin-button,::-webkit-outer-spin-button{margin:0;appearance:none;}"],c),m=t.span.withConfig({displayName:"timePicker__TimeSeparator",componentId:"sc-14og2kb-5"})(["padding:0 3px 0 0;color:#555d66;"]),u=t.button.withConfig({displayName:"timePicker__Button",componentId:"sc-14og2kb-6"})(["display:inline-flex;text-decoration:none;font-size:13px;margin:0;border:0;cursor:pointer;transition:box-shadow 0.1s linear;padding:0 10px;line-height:2;height:30px;border-radius:3px;white-space:nowrap;border-width:1px;border-style:solid;color:#006edc;border-color:#006edc;background:#f3f5f6;&:focus{outline:2px solid transparent;background:#f3f5f6;color:rgb(0,93,140);border-color:",";box-shadow:0 0 0 1px ",";text-decoration:none;}",""],(e=>{let{theme:t}=e;return t.colors.fg.linkHover}),(e=>{let{theme:t}=e;return t.colors.fg.linkHover}),(e=>{let{isToggled:t}=e;return t&&"\n  background: #edeff0;\n  border-color: #8f98a1;\n  box-shadow: inset 0 2px 5px -3px #555d66;\n  "})),g=t.div.withConfig({displayName:"timePicker__InputGroup",componentId:"sc-14og2kb-7"})(["flex-basis:100%;"]),b=t(u).withConfig({displayName:"timePicker__AMButton",componentId:"sc-14og2kb-8"})(["margin-right:-1px;border-radius:3px 0 0 3px;"]),f=t(u).withConfig({displayName:"timePicker__PMButton",componentId:"sc-14og2kb-9"})(["margin-left:-1px;border-radius:0 3px 3px 0;"]);function TimePicker(t){let{onChange:o,is12Hour:c,localData:u,setLocalData:h}=t;const x=e=>t=>{h({...u,[e]:parseInt(t.target.value)})},k=()=>c?12:23,w=()=>c?1:0,I=e=>{const{am:t}=u;return c?"AM"===t?e%12:(e%12+12)%24:e},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h({...u,...t,date:e}),o(e.toISOString())},y=e=>()=>{const{am:t,date:o,hours:n}=u;if(t===e)return;const r=o;"PM"===e?r.setHours((n%12+12)%24):r.setHours(n%12),_(r,{am:e})},P=n();r((()=>{P.current.focus()}),[]);const C="AM"===u.am,N="PM"===u.am;return e.createElement(a,null,e.createElement(s,null,e.createElement(l,null,__("Time","web-stories")),e.createElement(p,null,e.createElement(g,null,e.createElement(d,{ref:P,"aria-label":__("Hours","web-stories"),type:"number",step:1,min:w(),max:k(),value:parseInt(u.hours),onChange:x("hours"),onBlur:()=>{const{hours:e,date:t}=u,o=parseInt(e);if(!(isNaN(o)||o<w()||o>k())&&t.getHours()!==I(e)){const o=t;o.setHours(I(e)),_(o)}}}),e.createElement(m,null,":"),e.createElement(d,{"aria-label":__("Minutes","web-stories"),type:"number",min:0,max:59,value:parseInt(u.minutes),onChange:x("minutes"),onBlur:()=>{const{minutes:e,date:t}=u,o=parseInt(e);if(!(isNaN(o)||o<0||o>59)&&t.getMinutes()!==e){const o=t;o.setMinutes(e),_(o)}}})),c&&e.createElement(g,null,e.createElement(b,{"aria-pressed":C,type:"button",isToggled:C,onClick:y("AM")},__("AM","web-stories")),e.createElement(f,{"aria-pressed":N,type:"button",isToggled:N,tabIndex:"-1",onClick:y("PM")},__("PM","web-stories"))),e.createElement(i,{date:u?.date}))))}export{TimePicker as default};
