/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import t from"styled-components";import{v4 as o}from"uuid";import{useRef as r,useState as n,useLayoutEffect as s,useEffect as i}from"@googleforcreators/react";import{__}from"@googleforcreators/i18n";import{themeHelpers as c,useKeyDownEffect as l,Button as a,BUTTON_TYPES as m,BUTTON_SIZES as u,BUTTON_VARIANTS as d,Icons as p}from"@googleforcreators/design-system";import{ADMIN_TOOLBAR_HEIGHT as f,HEADER_HEIGHT as g}from"../../constants/index.js";import h from"./headerShortcut.js";import x from"./landmarkShortcuts.js";import b from"./regularShortcuts.js";import{TOP_MARGIN as C,TOGGLE_SHORTCUTS_MENU as y}from"./constants.js";import"prop-types";import"@googleforcreators/tracking";import"./keyboardShortcutsMenuContext/context.js";import{useKeyboardShortcutsMenu as M}from"./keyboardShortcutsMenuContext/useKeyboardShortcutsMenu.js";const E=t.div.withConfig({displayName:"shortcutMenu__Container",componentId:"sc-m0xcqa-0"})(["position:absolute;left:0;bottom:0;width:352px;border-radius:",";background-color:",";border:","px solid ",";"],(e=>{let{theme:t}=e;return t.borders.radius.small}),(e=>{let{theme:t}=e;return t.colors.bg.primary}),1,(e=>{let{theme:t}=e;return t.colors.border.defaultNormal})),w=f+g+C-2,S=t.div.withConfig({displayName:"shortcutMenu__FlexContent",componentId:"sc-m0xcqa-1"})(["display:flex;flex-direction:column;max-height:calc( 100vh - ","px - ","px );"],w,(e=>{let{bottomOffset:t}=e;return t})),v=t.div.withConfig({displayName:"shortcutMenu__CloseContainer",componentId:"sc-m0xcqa-2"})(["position:absolute;right:4px;top:4px;"]),k=t.div.withConfig({displayName:"shortcutMenu__ScrollableContent",componentId:"sc-m0xcqa-3"})(["overflow:auto;flex-shrink:1;",";"],c.focusableOutlineCSS),_=`kb-header-${o()}`;function ShortcutMenu(){const t=r(),o=r(),{close:c,toggleMenu:f,isOpen:g}=M((e=>{let{actions:t,state:o}=e;return{toggleMenu:t.toggleMenu,close:t.close,isOpen:o.isOpen}})),[C,w]=n(0);return s((()=>{const e=o.current;if(!e)return;const t=()=>{const t=e.getBoundingClientRect(),o=e.ownerDocument.documentElement.getBoundingClientRect();w(o.height-t.y-t.height)};return t(),setTimeout(t),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[]),i((()=>{g&&t.current&&t.current.focus()}),[g]),l(o,y,f,[f]),l(o,"esc",c),e.createElement(E,{ref:o},e.createElement(v,null,e.createElement(a,{ref:t,type:m.PLAIN,size:u.SMALL,variant:d.CIRCLE,onClick:c,"aria-label":__("Close Menu","web-stories")},e.createElement(p.Cross,null))),e.createElement(S,{bottomOffset:C},e.createElement(h,{id:_}),e.createElement(k,{role:"presentation",tabIndex:0},e.createElement(x,null),e.createElement(b,null))))}export{ShortcutMenu as default};
