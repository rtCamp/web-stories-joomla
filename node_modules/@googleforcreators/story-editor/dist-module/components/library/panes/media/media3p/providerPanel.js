/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import"prop-types";import t,{css as r}from"styled-components";import{useCallback as i}from"@googleforcreators/react";import{__}from"@googleforcreators/i18n";import{resourceList as o}from"@googleforcreators/media";import{Headline as a,THEME_CONSTANTS as s}from"@googleforcreators/design-system";import d from"../common/paginatedMediaGallery.js";import n from"../../../../../app/media/useMedia.js";import{PROVIDERS as p}from"../../../../../app/media/media3p/providerConfiguration.js";import l from"../../../../../app/media/media3p/api/useMedia3pApi.js";import m from"../../../../../app/media/utils/useDetectBaseColor.js";import c from"../../../useLibrary.js";import"../../shared/index.js";import g from"../../shared/chipGroup/index.js";function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},f.apply(this,arguments)}const u=t(a).attrs((()=>({as:"h2",size:s.TYPOGRAPHY.PRESET_SIZES.XX_SMALL}))).withConfig({displayName:"providerPanel__MediaSubheading",componentId:"sc-1c53rqi-0"})(["margin-top:24px;padding:0 24px;",""],(e=>e.shouldDisplay||"display: none;")),h=t.div.withConfig({displayName:"providerPanel__ProviderWrapper",componentId:"sc-1c53rqi-1"})(["position:relative;display:flex;flex-direction:column;height:100%;min-height:100px;max-width:100%;top:0;left:0;",""],(e=>{let{hidden:t}=e;return t&&r(["position:absolute;visibility:hidden;"])}));function ProviderPanel(t){let{providerType:r,isActive:a,searchTerm:s,...y}=t;const{insertElement:C}=c((e=>({insertElement:e.actions.insertElement}))),{actions:{registerUsage:v}}=l(),{updateBaseColor:I}=m({}),b=i((e=>{e?.attribution?.registerUsageUrl&&v({registerUsageUrl:e.attribution.registerUsageUrl})}),[v]),P=i(((e,t)=>{o.set(e.id,{url:t,type:"cached"}),C(e.type,{resource:e}),b(e),e.baseColor||I(e)}),[C,b,I]),{media3p:x}=n((e=>{let{media3p:t}=e;return{media3p:t}}));if(!a)return e.createElement(h,f({},y,{hidden:!0}));const E=x[r].state,M=x[r].actions,j=E.categories.selectedCategoryId?E.categories.categories.find((e=>e.id===E.categories.selectedCategoryId)).label:__("Trending","web-stories"),L=Boolean(E.media?.length||E.categories.selectedCategoryId),T=__("Search Results","web-stories");return e.createElement(h,y,p[r].supportsCategories&&e.createElement(g,{items:E.categories.categories,selectedItemId:E.categories.selectedCategoryId,selectItem:M.selectCategory,deselectItem:M.deselectCategory}),e.createElement(u,{"data-testid":"media-subheading",shouldDisplay:L},s.length&&!E.categories.selectedCategoryId?T:j),e.createElement(d,{providerType:r,resources:E.media,isMediaLoading:E.isMediaLoading,isMediaLoaded:E.isMediaLoaded,hasMore:E.hasMore,setNextPage:M.setNextPage,onInsert:P,searchTerm:s,selectedCategoryId:E.categories.selectedCategoryId}))}export{ProviderPanel as default};
