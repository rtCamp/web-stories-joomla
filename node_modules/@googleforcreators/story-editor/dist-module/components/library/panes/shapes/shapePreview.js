/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import"prop-types";import{useState as t,useRef as o,createRef as r,useMemo as i,useCallback as a}from"@googleforcreators/react";import n from"styled-components";import{trackEvent as s}from"@googleforcreators/tracking";import{createSolidFromString as l}from"@googleforcreators/patterns";import{useUnits as p,PAGE_WIDTH as c}from"@googleforcreators/units";import{ThemeGlobals as d,themeHelpers as m}from"@googleforcreators/design-system";import{MaskTypes as h}from"@googleforcreators/masks";import g from"../../useLibrary.js";import f from"../shared/libraryMoveable.js";import u from"../shared/insertionOverlay.js";const v=c/3,y=n.button.withConfig({displayName:"shapePreview__Aspect",componentId:"sc-1pj9cm0-0"})(["background:transparent;outline:none;border:0;padding:0;position:relative;border-radius:",";background-color:",";&."," [role='presentation'],&[data-focus-visible-added] [role='presentation']{",";}"],(e=>{let{theme:t}=e;return t.borders.radius.small}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.previewOverlay}),d.FOCUS_VISIBLE_SELECTOR,(e=>{let{theme:t}=e;return m.focusCSS(t.colors.border.focus,t.colors.bg.secondary)})),w=n.div.withConfig({displayName:"shapePreview__AspectInner",componentId:"sc-1pj9cm0-1"})(["position:relative;padding-bottom:95.5%;"]),E=n.div.withConfig({displayName:"shapePreview__ShapePreviewContainer",componentId:"sc-1pj9cm0-2"})(["position:absolute;top:0;left:0;height:100%;width:100%;border-radius:",";display:flex;justify-content:center;align-items:center;svg{display:inline-block;width:36px;height:36px;}"],(e=>{let{theme:t}=e;return t.borders.radius.small})),b=n.div.withConfig({displayName:"shapePreview__ShapeClone",componentId:"sc-1pj9cm0-3"})(["position:absolute;top:0;left:0;opacity:0;width:",";height:",";svg{display:inline-block;width:100%;height:100%;path{fill:#c4c4c4;}}"],(e=>{let{width:t}=e;return`${t}px`}),(e=>{let{height:t}=e;return`${t}px`})),P=n.div.withConfig({displayName:"shapePreview__ShapePreviewSizer",componentId:"sc-1pj9cm0-4"})(["padding-top:100%;"]),_=n.path.withConfig({displayName:"shapePreview__Path",componentId:"sc-1pj9cm0-5"})(["fill:",";"],(e=>{let{theme:t}=e;return t.colors.fg.primary}));function ShapePreview(n){let{mask:c,isPreview:d,index:m}=n;const{insertElement:C}=g((e=>({insertElement:e.actions.insertElement}))),{dataToEditorX:k,dataToEditorY:S}=p((e=>({dataToEditorX:e.actions.dataToEditorX,dataToEditorY:e.actions.dataToEditorY}))),[j,I]=t(!1),x=()=>I(!0),T=()=>I(!1),N=o(),R=r(),L=i((()=>({backgroundColor:l("#c4c4c4"),width:v*c.ratio,height:v,mask:{type:c.type},lockAspectRatio:h.RECTANGLE!==c.type})),[c.ratio,c.type]),A=a((()=>{C("shape",L),s("insert_shape",{name:c.type})}),[C,L,c.type]),B=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e.createElement("svg",{viewBox:"0 0 1 "+1/(d&&c.iconRatio?c.iconRatio:c.ratio),width:36*(d&&c.iconRatio?c.iconRatio:c.ratio),height:36},t&&e.createElement("title",null,c.name),e.createElement(_,{d:d&&c.iconPath?c.iconPath:c.path,ref:R}))};return e.createElement(y,{ref:N,onClick:A,tabIndex:0===m?0:-1,"aria-label":c.name,onPointerEnter:x,onFocus:x,onPointerLeave:T,onBlur:T},e.createElement(w,null,e.createElement(E,{key:c.type},e.createElement(P,null),B()),j&&e.createElement(u,null)),e.createElement(f,{type:"shape",elementProps:L,cloneElement:b,cloneProps:{width:k(v*c.ratio),height:S(v),children:B(!1)}}))}export{v as DEFAULT_ELEMENT_WIDTH,ShapePreview as default};
