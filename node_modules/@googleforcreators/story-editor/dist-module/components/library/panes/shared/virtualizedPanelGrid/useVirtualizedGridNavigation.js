/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useState as r,useMemo as e,useRef as t,useEffect as o,useCallback as s,useFocusOut as i}from"@googleforcreators/react";import{useKeyDownEffect as c}from"@googleforcreators/design-system";import n from"../../../../../utils/useRovingTabIndex/index.js";import u from"../../../../canvas/useFocusCanvas.js";function a(a){let{containerRef:d,gridItemRefs:f,gridItemIds:m,rowVirtualizer:l}=a;const[g,I]=r(),[p,v]=r(!1),F=e((()=>l.virtualItems),[l]),G=t();o((()=>{F!==G?.current&&(G.current=F),g&&p&&f.current?.[g]?.focus()}),[g,F,p,f]),n({ref:d});const x=s((()=>{if(!p){const r=f.current?.[g]?g:m?.[0];I(r),v(!0),f.current?.[r]?.focus()}}),[g,p,m,f]),R=s((r=>{g!==r&&I(r)}),[g]),b=u(),h=s((()=>{b(),v(!1)}),[b]);return c(d,"tab",h,[h]),i(d,(()=>{v(!1)}),[]),e((()=>({handleGridFocus:x,handleGridItemFocus:R,activeGridItemId:g,isGridFocused:p})),[g,p,x,R])}export{a as default};
