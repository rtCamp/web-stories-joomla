/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{Button as t,Text as r,Headline as o,THEME_CONSTANTS as s,BUTTON_TYPES as i,BUTTON_SIZES as p,BUTTON_VARIANTS as a,Icons as n,Popup as l,PLACEMENT as m}from"@googleforcreators/design-system";import{__}from"@googleforcreators/i18n";import c from"styled-components";import{memo as d,useRef as g,useState as y,useCallback as f}from"@googleforcreators/react";import{getHTMLFormatters as u}from"@googleforcreators/rich-text";import"@googleforcreators/transform";import"../../../../dropTargets/provider.js";import"../../../../dropTargets/context.js";import"../../../../../app/history/historyProvider.js";import"../../../../../app/history/context.js";import"prop-types";import"@googleforcreators/templates";import"../../../../../app/config/context.js";import j from"../../../../../app/config/useConfig.js";import"../../../../../app/api/context.js";import"@googleforcreators/fonts";import"@googleforcreators/dom";import{PRESET_TYPES as S}from"../../../../../constants/index.js";import"../../../../../app/font/context.js";import"@googleforcreators/media";import"@googleforcreators/tracking";import"@googleforcreators/animation";import"uuid";import"@googleforcreators/masks";import"@googleforcreators/element-library";import"@googleforcreators/elements";import"../../../../../app/story/context.js";import"@googleforcreators/migration";import"../../../../../app/story/actions/useSaveStory.js";import"clone-deep";import"../../../../../app/story/useStoryReducer/useStoryReducer.js";import"@googleforcreators/output";import"../../../../../app/story/storyTriggers/storyTriggersProvider.js";import"../../../../../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js";import"../../../../../app/story/storyTriggers/storyEvents/onPageAddedRegister.js";import E from"../../../../../app/story/useStory.js";import"../../../../../app/media/useUploadMedia.js";import"@googleforcreators/patterns";import"../../../../../utils/generateBlurhash.worker.js";import"../../../../../app/media/media3p/providerConfiguration.js";import"../../../../../app/media/utils/useFFmpeg.js";import"../../../../../app/media/media3p/api/context.js";import"../../../../../app/media/local/constants.js";import"../../../../../app/media/media3p/providerReducer.js";import"../../../../../app/media/context.js";import"sat";import"@googleforcreators/units";import"../../../../../app/layout/context.js";import"../../../../../app/layout/useZoomSetting.js";import"@googleforcreators/stickers";import{DEFAULT_PRESET as x}from"../textPresets.js";import"../../../../../app/canvas/context.js";import"../../../../../app/currentUser/context.js";import"../../../../../app/helpCenter/provider.js";import"../../../../../app/helpCenter/context.js";import"../../../../helpCenter/constants.js";import"../../../../../app/rightClickMenu/context.js";import h from"../../../../../utils/useAddPreset.js";import b from"../../../../styleManager/styleGroup.js";import v from"../../../../styleManager/styleManager.js";import{MoreButton as P,NoStylesWrapper as T}from"../../../../styleManager/components.js";import w from"../../../useLibrary.js";import{areAllType as C}from"../../../../../utils/presetUtils.js";import R from"../../../../styleManager/useApplyStyle.js";import A from"../../../../design/updateProperties.js";import _ from"../../../../../utils/getUpdatedSizeAndPosition.js";import I from"../../shared/insertionOverlay.js";import{Container as L}from"../../../common/section.js";function M(){return M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},M.apply(this,arguments)}const O=c(L).withConfig({displayName:"stylePresets__SectionContainer",componentId:"sc-bczcw0-0"})(["padding:16px 0;margin-bottom:-24px;border-top:1px solid ",";border-bottom:1px solid ",";"],(e=>{let{theme:t}=e;return t.colors.divider.tertiary}),(e=>{let{theme:t}=e;return t.colors.divider.tertiary})),z=c.div.withConfig({displayName:"stylePresets__TitleBar",componentId:"sc-bczcw0-1"})(["display:flex;padding-bottom:16px;justify-content:space-between;align-items:center;"]),k=c.div.withConfig({displayName:"stylePresets__StylesWrapper",componentId:"sc-bczcw0-2"})([""]),U=c(t).withConfig({displayName:"stylePresets__StyledButton",componentId:"sc-bczcw0-3"})(["margin-left:auto;"]),N=c(r).withConfig({displayName:"stylePresets__NoStylesText",componentId:"sc-bczcw0-4"})(["color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.tertiary})),Y={x:40};var G=d((function PresetPanel(){const{textStyles:t,isText:r,updateSelectedElements:c}=E((e=>{let{state:t,actions:r}=e;return{isText:Boolean(t.selectedElements&&C("text",t.selectedElements)),textStyles:t.story?.globalStoryStyles?.textStyles||[],updateSelectedElements:r.updateSelectedElements}})),{insertElement:d}=w((e=>({insertElement:e.actions.insertElement}))),{setColor:L,setFontWeight:G,setLetterSpacing:B,toggleItalic:F,toggleUnderline:W}=u(),H=g(null),X=g(null),[Z,D]=y(!1),{isRTL:Q,styleConstants:{topOffset:q}={}}=j(),J=t.length>0,K=f((e=>{c({properties:t=>{const r=A(t,e,!0),o=_({...t,...r});return{...r,...o}}})}),[c]),V=R({pushUpdate:K}),{addGlobalPreset:$}=h({presetType:S.STYLE}),ee=e=>{r?V(e):((e=>{const{color:t,fontWeight:r,isItalic:o,isUnderline:s,letterSpacing:i}=e;let p=x.content;p=L(p,t),p=G(p,r),p=F(p,o),p=W(p,s),p=B(p,i),d("text",{...x,...e,content:p})})(e),D(!1))},te=r?{}:{activeItemOverlay:e.createElement(I,null),applyLabel:__("Add new text","web-stories")};return e.createElement(O,null,e.createElement(z,null,e.createElement(o,{as:"h2",size:s.TYPOGRAPHY.PRESET_SIZES.XXX_SMALL},__("Saved Styles","web-stories")),e.createElement(U,{type:i.TERTIARY,size:p.SMALL,variant:a.SQUARE,onClick:$,"aria-label":__("Add style","web-stories"),disabled:!r},e.createElement(n.Plus,null))),J&&e.createElement(e.Fragment,null,e.createElement(k,{ref:X},e.createElement(b,M({styles:[...t].reverse().slice(0,2),handleClick:ee,buttonWidth:150},te))),e.createElement(P,{ref:H,onClick:()=>D(!0),"aria-haspopup":"dialog","aria-expanded":Z},__("More styles","web-stories"),e.createElement(n.ChevronDownSmall,null)),e.createElement(l,{topOffset:q,isRTL:Q,anchor:H,isOpen:Z,placement:m.RIGHT_START,spacing:Y,renderContents:()=>e.createElement(v,M({styles:t,applyStyle:ee,onClose:()=>D(!1)},te))})),!J&&e.createElement(T,null,e.createElement(N,{size:s.TYPOGRAPHY.PRESET_SIZES.SMALL},__("No Styles Saved","web-stories"))))}));export{G as default};
