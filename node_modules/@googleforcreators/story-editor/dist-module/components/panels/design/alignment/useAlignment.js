/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useMemo as t}from"@googleforcreators/react";import{calcRotatedObjectPositionAndSize as e,getBoundRect as i,dataPixels as n,PAGE_WIDTH as r,PAGE_HEIGHT as o}from"@googleforcreators/units";import{trackEvent as h}from"@googleforcreators/tracking";const a={startX:0,startY:0,endX:r,endY:o,width:r,height:o},d="left",l="right",g="top",s="bottom";function m(r){let{selectedElements:o,updateElements:m,isFloatingMenu:f}=r;const c=o.length>2,u=t((()=>o.map((t=>{const{id:i,x:n,y:r,width:o,height:h,rotationAngle:a}=t;let d=n,l=r,g=o,s=h;if(a){const t=e(a,n,r,o,h);d=t.x,l=t.y,g=t.width,s=t.height}return{id:i,x:n,y:r,width:o,height:h,frameX:d,frameY:l,frameWidth:g,frameHeight:s}}))),[o]),p=1===o.length?a:i(o),x=t=>{h(f?"floating_menu":"design_panel",{name:`set_alignment_${t}`,element:"multiple"})},X=t=>{x(t),m((e=>{const{id:i}=e,n=u.find((t=>t.id===i)),{width:r=0,height:o=0,frameWidth:h=0,frameHeight:a=0}=n||{},s=t===d||t===l?(h-r)/2:(a-o)/2;return t===d||t===l?{x:t===d?p.startX+s:p.endX-r-s}:{y:t===g?p.startY+s:p.endY-o-s}}))};return{isDistributionEnabled:c,handleAlignLeft:()=>X(d),handleAlignCenter:()=>{x("center");const t=(p.endX+p.startX)/2;m((e=>{const{width:i}=e;return{x:t-i/2}}))},handleAlignRight:()=>X(l),handleAlignTop:()=>X(g),handleAlignMiddle:()=>{x("middle");const t=(p.endY+p.startY)/2;m((e=>{const{height:i}=e;return{y:t-i/2}}))},handleAlignBottom:()=>X(s),handleHorizontalDistribution:()=>{x("horizontal_distribution");const t=[...u];t.sort(((t,e)=>(t.frameX+t.frameWidth)/2-(e.frameX+e.frameWidth)/2));const e=t.reduce(((t,e)=>t+e.frameWidth),0),i=p.width-e,r=n(i/(t.length-1)),o={};let h=0;t.forEach(((e,i)=>{const{id:n,x:a,width:d,frameWidth:l}=e;0===i||i===t.length-1?(o[n]={x:a},h=a):o[n]={x:h+(l-d)/2},h+=l+r})),m((t=>{let{id:e}=t;return o[e]}))},handleVerticalDistribution:()=>{x("vertical_distribution");const t=[...u];t.sort(((t,e)=>(t.frameY+t.frameHeight)/2-(e.frameY+e.frameHeight)/2));const e=t.reduce(((t,e)=>t+e.frameHeight),0),i=p.height-e,r=n(i/(t.length-1)),o={};let h=0;t.forEach(((e,i)=>{const{id:n,y:a,height:d,frameHeight:l}=e;0===i||i===t.length-1?(o[n]={y:a},h=a):o[n]={y:h+(l-d)/2},h+=l+r})),m((t=>{let{id:e}=t;return o[e]}))}}}export{m as default};
