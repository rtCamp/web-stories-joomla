/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{forwardRef as o,useMemo as t,useCallback as r}from"@googleforcreators/react";import"prop-types";import{_x,__}from"@googleforcreators/i18n";import{useFeatures as i}from"flagged";import{css as n}from"styled-components";import{PLACEMENT as s,DropDown as a}from"@googleforcreators/design-system";import{focusStyle as l}from"../../../shared/styles.js";import{getDirectionalEffect as c,experimentalEffects as m,NO_ANIMATION as p,backgroundEffectOptions as f,foregroundEffectOptions as d}from"./dropdownConstants.js";import"./types.js";import u from"./utils/getDisabledBackgroundEffects.js";import D from"./utils/generateDynamicProps.js";import{styleOverrideForAnimationEffectMenu as y,styleOverrideForSelectButton as g}from"./styles.js";import O from"./dropdownItem.js";const v=o((function EffectChooserDropdown(o,v){let{onAnimationSelected:b,onNoEffectSelected:j,isBackgroundEffects:E=!1,selectedEffectType:I,disabledTypeOptionsMap:h,direction:w,selectButtonStylesOverride:B}=o;const{enableExperimentalAnimationEffects:S}=i(),T=t((()=>c(I,w)),[I,w]),M=t((()=>E&&u(f,h)),[h,E]),C=E?s.BOTTOM:s.TOP,k=E?f:d,x=t((()=>S?Object.values(k):Object.values(k).filter((e=>{let{value:o}=e;return-1===m.indexOf(o)}))),[k,S]),A=t((()=>x?.map((e=>{const o=E&&M.includes(e.value);return{...e,disabled:o,tooltip:o&&h[e.animation?.value]?.tooltip}}))),[x,E,M,h]),z=r(((e,o)=>{if(e.preventDefault(),o===p)return void(Boolean(T)&&j());const t=k[o]?.animation,r=D({animation:t,disabledTypeOptionsMap:h});b({animation:r.value,panDir:r?.panDirection,zoomDirection:r?.zoomDirection,flyInDir:r?.flyInDirection,rotateInDir:r?.rotateInDirection,whooshInDir:r?.whooshInDirection,scaleDirection:r?.scaleDirection})}),[k,h,b,T,j]),N=n([""," ",""],T&&T!==p?g:l,void 0!==B&&B);return e.createElement(a,{ref:v,options:A,placeholder:_x("None","animation effect","web-stories"),selectedValue:T,ariaLabel:__("Animation: Effect Chooser","web-stories"),menuStylesOverride:y,renderItem:O,onMenuItemClick:z,placement:C,isKeepMenuOpenOnSelection:!0,selectButtonStylesOverride:N})}));export{v as default};
