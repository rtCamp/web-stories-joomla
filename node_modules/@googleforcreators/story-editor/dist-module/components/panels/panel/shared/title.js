/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import t,{css as r}from"styled-components";import"prop-types";import{useContext as o,useEffect as a,useCallback as n}from"@googleforcreators/react";import{Headline as i,themeHelpers as l,THEME_CONSTANTS as s,NotificationBubble as d,BUTTON_TRANSITION_TIMING as p,ThemeGlobals as c,Icons as h,BUBBLE_VARIANTS as m}from"@googleforcreators/design-system";import g from"../../../sidebar/useSidebar.js";import f from"../context.js";import{PANEL_COLLAPSED_THRESHOLD as u}from"../panel.js";import{focusStyle as y}from"../../shared/styles.js";import x from"./handle.js";function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},b.apply(this,arguments)}const C=t(i).attrs({as:"h2"}).withConfig({displayName:"title__Header",componentId:"sc-1tphhj5-0"})(["color:",";background-color:",";"," margin:0;position:relative;display:flex;flex-direction:row;user-select:none;align-items:center;justify-content:space-between;padding:",";"],(e=>{let{theme:t}=e;return t.colors.fg.secondary}),(e=>{let{isSecondary:t,theme:r}=e;return t&&r.colors.interactiveBg.secondaryNormal}),(e=>{let{hasResizeHandle:t}=e;return t&&"padding-top: 0;"}),(e=>{let{isCollapsed:t}=e;return t?"14px 16px":"14px 16px 6px 16px"})),S=t.span.withConfig({displayName:"title__Heading",componentId:"sc-1tphhj5-1"})(["color:",";display:flex;align-items:space-between;",";"],(e=>{let{theme:t,isCollapsed:r}=e;return r?t.colors.fg.secondary:t.colors.fg.primary}),(e=>{let{theme:t}=e;return l.expandPresetStyles({preset:t.typography.presets.headline[s.TYPOGRAPHY.PRESET_SIZES.XX_SMALL],theme:t})})),E=t(d).withConfig({displayName:"title__StyledNotificationBubble",componentId:"sc-1tphhj5-2"})(["margin-left:12px;"]),_=t.div.withConfig({displayName:"title__HeaderActions",componentId:"sc-1tphhj5-3"})(["display:flex;align-items:center;"]),H=t.div.withConfig({displayName:"title__IconWrapper",componentId:"sc-1tphhj5-4"})(["position:relative;width:32px;height:32px;svg{position:relative;z-index:1;}"]),I=t.button.withConfig({displayName:"title__Collapse",componentId:"sc-1tphhj5-5"})(["border:none;border-radius:",";background:transparent;color:",";height:32px;display:flex;padding:0 4px 0 0;align-items:center;justify-content:flex-start;cursor:pointer;margin-left:-12px;transition:",";&:hover,&.",",&[","]{color:",";}",";svg{width:32px;height:32px;",";}:hover ",":after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);height:16px;width:16px;border-radius:",";background:",";}"],(e=>{let{theme:t}=e;return t.borders.radius.small}),(e=>{let{theme:t,isCollapsed:r}=e;return r?t.colors.fg.secondary:t.colors.fg.primary}),p,c.FOCUS_VISIBLE_SELECTOR,c.FOCUS_VISIBLE_DATA_ATTRIBUTE,(e=>{let{theme:t}=e;return t.colors.fg.primary}),y,(e=>{let{$isCollapsed:t,theme:o}=e;return t&&r(["color:",";transform:rotate(-90deg);"],o.colors.fg.secondary)}),H,(e=>{let{theme:t}=e;return t.borders.radius.round}),(e=>{let{theme:t}=e;return t.colors.bg.quaternary}));function Toggle(t){let{children:r,isCollapsed:o,toggle:a,...n}=t;return e.createElement(I,b({onClick:e=>{e.stopPropagation(),a()},$isCollapsed:o},n),r)}function Title(t){let{ariaLabel:r,children:i,isPrimary:l,isSecondary:d,secondaryAction:p,isResizable:c,canCollapse:y,maxHeight:I,count:w,...T}=t;const{state:{isCollapsed:j,height:v,resizable:P,showDragHandle:R,showFocusStyles:A,panelContentId:L,panelTitleId:N,ariaHidden:O},actions:{collapse:z,expand:B,setHeight:M,setExpandToHeight:k,resetHeight:D,confirmTitle:Y}}=o(f),{state:{sidebarContentHeight:F}}=g();a(Y,[Y]);const X=I||Math.round(.7*F),U=n((e=>P?M((t=>Math.max(0,Math.min(X,t+e)))):null),[P,M,X]),G=n((()=>{P&&v>=u&&k(v)}),[k,v,P]),V=j?B:z,Z=0===w||Boolean(w);return e.createElement(C,b({isPrimary:l,isSecondary:d,hasResizeHandle:c&&!j,isCollapsed:j},T),c&&e.createElement(x,{height:v,minHeight:0,maxHeight:X,handleHeightChange:U,handleExpandToHeightChange:G,handleDoubleClick:D,tabIndex:O?-1:0,showDragHandle:R,showFocusStyles:A}),e.createElement(Toggle,{toggle:V,disabled:!y,tabIndex:O?-1:0,"aria-label":r,"aria-expanded":!j,"aria-controls":L,isCollapsed:j},y&&e.createElement(H,null,e.createElement(h.ChevronDownSmall,null)),e.createElement(S,{isCollapsed:j,id:N,size:s.TYPOGRAPHY.PRESET_SIZES.XX_SMALL},i),Z&&e.createElement(E,{"data-testid":"panel-badge",notificationCount:w,variant:m.PRIMARY,"aria-hidden":!0})),p&&e.createElement(_,null,p))}Title.defaultProps={isPrimary:!1,isSecondary:!1,isResizable:!1,canCollapse:!0};export{Title as default};
