/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import t from"prop-types";import{memo as r,forwardRef as i,useEffect as o}from"@googleforcreators/react";import n,{StyleSheetManager as a}from"styled-components";import{generatePatternStyles as l}from"@googleforcreators/patterns";import{STORY_ANIMATION_STATE as p,StoryAnimation as s,useStoryAnimationContext as m}from"@googleforcreators/animation";import"../../types.js";import g from"./previewPageElements.js";const c=n.div.withConfig({displayName:"previewPage__FullBleedPreviewWrapper",componentId:"sc-1r5t7dq-0"})(["height:",";width:100%;overflow:hidden;position:relative;display:flex;align-items:center;background-color:white;",";"],(e=>{let{pageSize:t}=e;return`${t.containerHeight}px`}),(e=>{let{background:t}=e;return l(t)})),u=n.div.withConfig({displayName:"previewPage__PreviewSafeZone",componentId:"sc-1r5t7dq-1"})(["width:100%;height:",";overflow:visible;position:absolute;margin:0;"],(e=>{let{pageSize:t}=e;return`${t.height}px`}));function PreviewPageAnimationController(e){let{animationState:t}=e;const r=m((e=>{let{actions:t}=e;return t.WAAPIAnimationMethods}));return o((()=>{switch(t){case p.PLAYING:return r.play(),()=>{};case p.RESET:return r.reset(),()=>{};case p.SCRUBBING:case p.PAUSED:return r.pause(),()=>{};default:return()=>{}}}),[t,r]),o((()=>()=>r.reset()),[r]),null}const f=r(i((function PreviewPageDisplay(t,r){let{page:i,pageSize:o}=t;return e.createElement(c,{ref:r,pageSize:o,background:i.backgroundColor},e.createElement(u,{pageSize:o},e.createElement(g,{page:i})))}))),d=i((function PreviewPage(t,r){let{page:i,pageSize:o,animationState:n=p.RESET,onAnimationComplete:l}=t;return e.createElement(a,{stylisPlugins:[]},e.createElement(s.Provider,{animations:i.animations,elements:i.elements,onWAAPIFinish:l},e.createElement(f,{ref:r,page:i,pageSize:o}),e.createElement(PreviewPageAnimationController,{animationState:n})))}));PreviewPageAnimationController.propTypes={animationState:t.oneOf(Object.values(p))};export{d as default};
