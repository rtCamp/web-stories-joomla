/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{__}from"@googleforcreators/i18n";import{CSSTransition as t}from"react-transition-group";import{useState as r,useRef as o,useCallback as n,useFocusOut as a}from"@googleforcreators/react";import s from"styled-components";import{Text as i,THEME_CONSTANTS as l,useKeyDownEffect as m,localStore as p,LOCAL_STORAGE_PREFIX as c}from"@googleforcreators/design-system";import"prop-types";import y from"../../utils/useFocusTrapping.js";import d from"./header.js";import f from"./styleGroup.js";import g from"./useDeleteStyle.js";import u from"./confirmationDialog.js";import{STORAGE_KEY as h}from"./constants.js";function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},E.apply(this,arguments)}const x=s.div.withConfig({displayName:"styleManager__Container",componentId:"sc-4hlmhs-0"})(["border-radius:8px;background:",";width:256px;user-select:none;display:flex;flex-direction:column;align-items:stretch;overflow:hidden;&.style-manager-appear{opacity:0.01;margin-top:-10px;&.style-manager-appear-active{opacity:1;margin-top:0;transition:300ms ease-out;transition-property:opacity,margin-top;}}"],(e=>{let{theme:t}=e;return t.colors.bg.secondary})),S=s.div.withConfig({displayName:"styleManager__Body",componentId:"sc-4hlmhs-1"})(["display:flex;margin:8px 12px 16px;"]),v=s(i).attrs({size:l.TYPOGRAPHY.PRESET_SIZES.SMALL}).withConfig({displayName:"styleManager__StyledText",componentId:"sc-4hlmhs-2"})(["margin:0 0 0 8px;color:",";"],(e=>{let{theme:t}=e;return t.colors.fg.primary}));function StyleManager(s){let{styles:i,onClose:l,applyStyle:b,...M}=s;const[j,w]=r(!1),[C,_]=r(!1),[I,P]=r(null),N=o(null),O=o(document.activeElement),T=n((e=>{O.current&&O.current.focus(),l(e)}),[l]);m(N,"esc",T);const R=g({onEmpty:T});a(N,(()=>{C||l()}),[C]),y({ref:N});return e.createElement(t,{nodeRef:N,in:!0,appear:!0,classNames:"style-manager",timeout:300},e.createElement(x,{role:"dialog","aria-label":__("Style presets manager","web-stories"),ref:N},e.createElement(d,{handleClose:T,isEditMode:j,setIsEditMode:w},e.createElement(v,null,__("Saved Styles","web-stories"))),e.createElement(S,null,e.createElement(f,E({styles:[...i].reverse(),handleClick:e=>{if(!j)return void b(e);p.getItemByKey(c[h])?R(e):(_(!0),P(e))},isEditMode:j,buttonWidth:106},M))),C&&e.createElement(u,{onClose:()=>_(!1),onPrimary:()=>{R(I),P(null),_(!1)}})))}export{StyleManager as default};
