/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import t from"react";import e,{css as r}from"styled-components";import{forwardRef as o,useRef as i,useCallback as s}from"@googleforcreators/react";import"prop-types";import{themeHelpers as a,ThemeGlobals as n,Headline as p,THEME_CONSTANTS as l,useGlobalKeyDownEffect as c,useKeyDownEffect as m}from"@googleforcreators/design-system";import"@googleforcreators/transform";import"../dropTargets/provider.js";import"../dropTargets/context.js";import"../../app/history/historyProvider.js";import"../../app/history/context.js";import"@googleforcreators/templates";import"../../app/config/context.js";import g from"../../app/config/useConfig.js";import"../../app/api/context.js";import"@googleforcreators/fonts";import"@googleforcreators/dom";import"../../constants/fonts.js";import"../../constants/multipleValue.js";import{TRACKING_EVENTS as d}from"../../constants/performanceTrackingEvents.js";import"../../app/font/context.js";import"@googleforcreators/media";import"@googleforcreators/tracking";import"@googleforcreators/animation";import"uuid";import"@googleforcreators/masks";import"@googleforcreators/element-library";import"@googleforcreators/elements";import"../../app/story/context.js";import"@googleforcreators/migration";import"../../app/story/actions/useSaveStory.js";import"clone-deep";import"../../app/story/useStoryReducer/useStoryReducer.js";import"@googleforcreators/output";import"../../app/story/storyTriggers/storyTriggersProvider.js";import"../../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js";import"../../app/story/storyTriggers/storyEvents/onPageAddedRegister.js";import"@googleforcreators/i18n";import"../../app/media/useUploadMedia.js";import"@googleforcreators/patterns";import"../../utils/generateBlurhash.worker.js";import"../../app/media/media3p/providerConfiguration.js";import"../../app/media/utils/useFFmpeg.js";import"../../app/media/media3p/api/context.js";import"../../app/media/local/constants.js";import"../../app/media/media3p/providerReducer.js";import"../../app/media/context.js";import"sat";import"@googleforcreators/units";import"../../app/layout/context.js";import"../../app/layout/useZoomSetting.js";import"@googleforcreators/rich-text";import"@googleforcreators/stickers";import"../library/panes/text/textPresets.js";import"../../app/canvas/context.js";import"../../app/currentUser/context.js";import"../../app/helpCenter/provider.js";import"../../app/helpCenter/context.js";import"../helpCenter/constants.js";import"../../app/rightClickMenu/context.js";import u from"../tooltip/tooltip.js";import f from"../../utils/usePerformanceTracking.js";function b(){return b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},b.apply(this,arguments)}const h=32,y=10,v=e.ul.attrs({role:"tablist","aria-orientation":"horizontal"}).withConfig({displayName:"tabview__Tabs",componentId:"sc-10d408-0"})(["display:flex;flex-direction:row;align-items:stretch;width:100%;max-width:100%;justify-content:space-between;margin:0;padding:0;list-style:none;border-bottom:1px solid ",";"],(t=>{let{theme:e}=t;return e.colors.divider.secondary})),j=e.li.attrs((t=>{let{isActive:e}=t;return{tabIndex:e?0:-1,role:"tab","aria-selected":e}})).withConfig({displayName:"tabview__TabElement",componentId:"sc-10d408-1"})(["cursor:pointer;border:none;background:none;padding:0 4px;margin:","px 12px 9px;height:","px;display:flex;align-items:center;justify-content:center;position:relative;transition:color 0.2s ease;color:",";border-radius:",";",";:hover{color:",";}"," svg{display:block;width:32px;height:32px;margin:0 -4px;transform-origin:center center;transition:transform 0.3s ease,color 0.2s ease;color:",";border-radius:",";pointer-events:none;}svg.alert{width:","px;margin-left:4px;color:",";}span,svg:not(.alert){",";}&:hover span,&:hover svg:not(.alert),&:active span,&:active svg:not(.alert){color:",";}&.",",&[data-focus-visible-added]{svg:not(.alert){background-color:",";}}"],10,32,(t=>{let{theme:e,isActive:r}=t;return r?e.colors.fg.primary:e.colors.fg.tertiary}),(t=>{let{theme:e}=t;return e.borders.radius.small}),(t=>{let{theme:e}=t;return a.focusableOutlineCSS(e.colors.border.focus,e.colors.bg.secondary)}),(t=>{let{theme:e}=t;return e.colors.fg.primary}),(t=>{let{isActive:e,theme:o}=t;return e&&r(["::after{content:'';position:absolute;background-color:",";height:2px;border-radius:1px;bottom:-10px;left:4px;right:4px;}"],o.colors.border.selection)}),(t=>{let{theme:e}=t;return e.colors.fg.tertiary}),(t=>{let{theme:e}=t;return e.borders.radius.small}),28,(t=>{let{theme:e}=t;return e.colors.fg.primary}),(t=>{let{isActive:e,theme:r}=t;return e&&`color: ${r.colors.fg.primary}`}),(t=>{let{theme:e}=t;return e.colors.fg.primary}),n.FOCUS_VISIBLE_SELECTOR,(t=>{let{theme:e}=t;return e.colors.interactiveBg.tertiaryHover})),x=e(p).attrs({as:"p",size:l.TYPOGRAPHY.PRESET_SIZES.XXX_SMALL}).withConfig({displayName:"tabview__TabText",componentId:"sc-10d408-2"})(["color:inherit;"]),T=()=>{};const E=o((function UnreffedTab(e,r){let{children:o,tooltip:i=null,placement:s,refId:a,tabRefs:n,...p}=e;const{id:l}=p,c=l.includes("library")?d.LIBRARY_PANEL_CLICK:d.DESIGN_PANEL_CLICK;f({node:n?.[a]?.current,eventData:{...c,label:`${a}_tab`}});const m=t.createElement(j,b({ref:r},p),o);return null!==i?t.createElement(u,{title:i,placement:s,isDelayed:!0},m):m}));function TabView(e){let{getTabId:r=(t=>t),getAriaControlsId:o,onTabChange:a=T,onTabRefUpdated:n=T,tabs:p=[],label:l="",shortcut:d="",tab:u,tabRefs:f,...h}=e;const{isRTL:y}=g(),j=i(),C=i(),w=i({}),I=s((t=>{f?.[t]?.current?f[t].current?.focus():w?.current[t]&&w.current[t]?.focus(),C.current=t}),[f]),k=s((t=>{I(t),a(t)}),[I,a]);c({key:d,editable:!0},(()=>k(u)),[k,u]);const A=s((t=>{const e=p[(t+p.length)%p.length];I(e.id)}),[p,I]),R=s((t=>{const e=y?-t:t,r=p.findIndex((t=>{let{id:e}=t;return e===C.current}));A(r+e)}),[y,p,A]);return m(j,"left",(()=>R(-1)),[R]),m(j,"right",(()=>R(1)),[R]),m(j,["up","down"],(()=>{}),[]),m(j,"home",(()=>A(0)),[A]),m(j,"end",(()=>A(-1)),[A]),m(j,{key:["enter","space"],allowDefault:!0},(t=>{"tab"===t.target.getAttribute("role")&&(k(C.current),t.preventDefault())}),[k],{}),t.createElement(v,b({"aria-label":l,ref:j},h),p.map((e=>{let{id:i,title:s,icon:a,...p}=e;return t.createElement(E,b({key:i,ref:t=>{f?f[i].current=t:w.current[i]=t,n(t,i)},id:r(i),isActive:u===i,"aria-controls":o?o(i):null,"aria-selected":u===i,onClick:()=>k(i),onFocus:()=>{C.current=u},refId:i,tabRefs:f},p),Boolean(s)&&t.createElement(x,null,s),Boolean(a)&&t.createElement(a,{isActive:i===u}))})))}export{h as TAB_HEIGHT,y as TAB_VERTICAL_MARGIN,TabView as default};
