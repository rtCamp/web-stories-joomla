/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import e from"react";import{theme as t}from"@googleforcreators/design-system";import{forwardRef as o,render as r,unmountComponentAtNode as n}from"@googleforcreators/react";import{UnitsProvider as i,PAGE_RATIO as a,FULLBLEED_RATIO as l}from"@googleforcreators/units";import s,{ThemeProvider as m}from"styled-components";import{generatePatternStyles as c}from"@googleforcreators/patterns";import{TransformProvider as d}from"@googleforcreators/transform";import p from"../app/font/fontProvider.js";import"../app/font/context.js";import g from"../components/canvas/displayElement.js";const h=s.div.withConfig({displayName:"storyPageToNode__Page",componentId:"sc-rgshjs-0"})(["display:block;position:relative;padding:0;border:0;background-color:transparent;height:","px;width:","px;flex:none;outline:0;"],(e=>{let{height:t}=e;return t}),(e=>{let{width:t}=e;return t})),f=s.div.withConfig({displayName:"storyPageToNode__PreviewWrapper",componentId:"sc-rgshjs-1"})(["height:100%;position:relative;overflow:hidden;background-color:",";border-radius:4px;",""],(e=>{let{theme:t}=e;return t.colors.fg.white}),(e=>{let{background:t}=e;return c(t)})),u=s.div.withConfig({displayName:"storyPageToNode__FullHeight",componentId:"sc-rgshjs-2"})(["position:absolute;top:","px;bottom:","px;right:0;left:0;"],(e=>{let{yOffset:t}=e;return t}),(e=>{let{yOffset:t}=e;return t})),y=o((function PageWithDependencies(o,r){let{page:n,width:a,height:l,renderFullHeightThumb:s=!1,containerHeight:c}=o;return e.createElement(m,{theme:t},e.createElement(p,null,e.createElement(d,null,e.createElement(i,{pageSize:{width:a,height:l}},e.createElement(h,{ref:r,height:s?c:l,width:a},e.createElement(f,{background:n.backgroundColor},e.createElement(u,{yOffset:s?(c-l)/2:0},n.elements.map((t=>e.createElement(g,{key:t.id,previewMode:!0,element:t}))))))))))}));async function b(t,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{renderFullHeightThumb:s=!1}=i,m=o*(1/a),c=o*(1/l),d=document.createElement("div");d.style.cssText=`\n     contain: strict;\n     position: absolute;\n     top: 0;\n     left: 0;\n     width: ${o}px;\n     height: ${c}px;\n     opacity: 0;\n     transform: translate(-100%, -100%);\n     pointer-events: none;\n   `;const p=await new Promise((n=>{r(e.createElement(y,{ref:e=>{e&&n(e)},page:t,width:o,height:m,containerHeight:c,renderFullHeightThumb:s}),d)}));document.body.appendChild(d);const g=()=>{n(d),document.body.removeChild(d)};return[p,g]}export{b as default};
