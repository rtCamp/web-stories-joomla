/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{useCallback as t}from"@googleforcreators/react";import"@googleforcreators/transform";import"../components/dropTargets/provider.js";import"../components/dropTargets/context.js";import"../app/history/historyProvider.js";import"../app/history/context.js";import"react";import"prop-types";import"@googleforcreators/templates";import"../app/config/context.js";import"../app/api/context.js";import"@googleforcreators/fonts";import"@googleforcreators/dom";import"../constants/fonts.js";import"../constants/multipleValue.js";import"../app/font/context.js";import"@googleforcreators/media";import"@googleforcreators/tracking";import"@googleforcreators/animation";import"uuid";import"@googleforcreators/masks";import"@googleforcreators/element-library";import"@googleforcreators/elements";import"../app/story/context.js";import"@googleforcreators/migration";import o from"./getUniquePresets.js";import"../app/story/actions/useSaveStory.js";import"clone-deep";import"../app/story/useStoryReducer/useStoryReducer.js";import"@googleforcreators/output";import"../app/story/storyTriggers/storyTriggersProvider.js";import"../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js";import"../app/story/storyTriggers/storyEvents/onPageAddedRegister.js";import r from"../app/story/useStory.js";import"@googleforcreators/i18n";import"../app/media/useUploadMedia.js";import"@googleforcreators/patterns";import"./generateBlurhash.worker.js";import"@googleforcreators/design-system";import"../app/media/media3p/providerConfiguration.js";import"../app/media/utils/useFFmpeg.js";import"../app/media/media3p/api/context.js";import"../app/media/local/constants.js";import"../app/media/media3p/providerReducer.js";import"../app/media/context.js";import"sat";import"@googleforcreators/units";import"../app/layout/context.js";import"../app/layout/useZoomSetting.js";import"@googleforcreators/rich-text";import"@googleforcreators/stickers";import"../components/library/panes/text/textPresets.js";import"../app/canvas/context.js";import"../app/currentUser/context.js";import"../app/helpCenter/provider.js";import"../app/helpCenter/context.js";import"../components/helpCenter/constants.js";import"../app/rightClickMenu/context.js";import{areAllType as e,getTextPresets as s,getPagePreset as p,getShapePresets as i}from"./presetUtils.js";function a(a){let{presetType:m,isBackgroundColor:l}=a;const{currentPage:n,currentStoryStyles:c={colors:[]},selectedElements:g,globalStoryStyles:y={colors:[],textStyles:[]},updateStory:d}=r((t=>{let{state:{currentPage:o,selectedElements:r,story:{globalStoryStyles:e,currentStoryStyles:s}},actions:{updateStory:p}}=t;return{currentPage:o,currentStoryStyles:s,selectedElements:r,globalStoryStyles:e,updateStory:p}})),{colors:u,textStyles:j}=y,{colors:f}=c,S=e("text",g),x=g?.[0]?.id===n?.elements?.[0]?.id,h=t(((t,o)=>S?{...t,...s(g,o,m,l)}:x?{...t,...p(n,o)}:{...t,...i(g,o)}),[n,x,S,m,g,l]),P=t((t=>{d({properties:{currentStoryStyles:{colors:o([...f,...t.colors])}}})}),[f,d]),v=t((t=>{d({properties:{globalStoryStyles:{textStyles:o([...j,...t.textStyles]),colors:o([...u,...t.colors])}}})}),[u,j,d]),b=t((function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=o?c:y;if((t=h(t,r)).colors?.length>0||t.textStyles?.length>0)return o?P(t,r):v(t,r),t}),[h,c,y,v,P]);return{addGlobalPreset:t=>(t.stopPropagation(),b({textStyles:[],colors:[]})),addLocalPreset:t=>(t.stopPropagation(),b({colors:[]},!0))}}export{a as default};
