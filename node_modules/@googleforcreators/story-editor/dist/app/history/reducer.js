/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e={entries:[],offset:0,requestedState:null,versionNumber:0};exports.CLEAR_HISTORY="clear",exports.EMPTY_STATE=e,exports.REPLAY="replay",exports.SET_CURRENT_STATE="set_state",exports.default=t=>(r,s)=>{let{type:n,payload:u}=s;const a=r.entries[r.offset];switch(n){case"set_state":if(r.requestedState){if(Object.keys(r.requestedState).every((e=>r.requestedState[e]===u[e]))){const e=r.entries.indexOf(r.requestedState);if(a.pages!==r.requestedState.pages&&a.pages.length===r.requestedState.pages.length&&a.current!==r.requestedState.current){const t=a.pages.filter(((e,t)=>e!==r.requestedState.pages[t]));if(1===t.length){const s=t[0].id,n={...r.requestedState,current:s};return{...r,offset:e,requestedState:n}}}return{...r,offset:e,requestedState:null}}}return{entries:[u,...r.entries.slice(r.offset)].slice(0,t),versionNumber:r.versionNumber+1,offset:0,requestedState:null};case"replay":return{...r,versionNumber:r.versionNumber+(r.offset-u),requestedState:r.entries[u]};case"clear":return{...e};default:throw new Error(`Unknown history reducer action: ${n}`)}};
