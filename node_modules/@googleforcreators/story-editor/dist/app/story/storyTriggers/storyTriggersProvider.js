/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@googleforcreators/react");require("prop-types");var r=require("./storyEvents/index.js"),o=require("./storyEvents/types.js");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=n(e);const s=t.createContext({state:{},actions:{}});function a(){return Object.values(o.STORY_EVENTS).reduce(((e,t)=>({...e,[t]:new Map})),{})}function c(e,t){let[r]=e;return[t,r]}exports.Context=s,exports.StoryTriggersProvider=function StoryTriggersProvider(e){let{children:o,story:n}=e;const[[l,i],d]=t.useReducer(c,[n,null]),f=t.useMemo(a,[]);t.useEffect((()=>d(n)),[n]);const y=t.useCallback(((e,t)=>{const r=Symbol();return f[e].set(r,t),()=>f[e].delete(r)}),[f]),v=t.useCallback((e=>{f[e]?.forEach((e=>e(l)))}),[f,l]),p=t.useMemo((()=>[y,v]),[y,v]);return u.default.createElement(s.Provider,{value:p},u.default.createElement(u.default.Fragment,null,r.StoryEventRegisters.map((e=>u.default.createElement(e,{key:e.name,currentStory:l,previousStory:i,dispatchStoryEvent:v}))),o))};
