/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),t=require("@googleforcreators/react");require("prop-types");var r=require("styled-components"),n=require("@googleforcreators/i18n"),o=require("@googleforcreators/design-system"),a=require("../eyedropper/index.js"),l=require("./pointer.js"),i=require("./editablePreview.js");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var s=c(e),d=c(r);const f=t.lazy((()=>Promise.resolve().then((function(){return u(require("react-color/lib/components/common"))})).then((e=>({default:e.Saturation}))))),p=t.lazy((()=>Promise.resolve().then((function(){return u(require("react-color/lib/components/common"))})).then((e=>({default:e.Hue}))))),m=t.lazy((()=>Promise.resolve().then((function(){return u(require("react-color/lib/components/common"))})).then((e=>({default:e.Alpha}))))),h=d.default.div.withConfig({displayName:"currentColorPicker__BodyFallback",componentId:"sc-eqs4bc-0"})(["height:","px;display:flex;align-items:center;justify-content:center;"],240),g=d.default.div.withConfig({displayName:"currentColorPicker__SaturationWrapper",componentId:"sc-eqs4bc-1"})(["position:relative;margin:0 16px;flex:0 1 ","px;"],116),b=r.css(["margin:0 16px;border:1px solid ",";flex:0 0 ","px;position:relative;border-radius:","px;background-clip:padding-box;"],(e=>{let{theme:t}=e;return t.colors.shadow.active}),20,50),C=d.default.div.withConfig({displayName:"currentColorPicker__HueWrapper",componentId:"sc-eqs4bc-2"})(["",""],b),y=d.default.div.withConfig({displayName:"currentColorPicker__AlphaWrapper",componentId:"sc-eqs4bc-3"})([""," div:first-child div:first-child div:first-child{background-image:conic-gradient( "," 0.25turn,transparent 0turn 0.5turn,"," 0turn 0.75turn,transparent 0turn 1turn ) !important;background-size:8px 8px !important;}"],b,(e=>{let{theme:t}=e;return t.colors.fg.tertiary}),(e=>{let{theme:t}=e;return t.colors.fg.tertiary})),v=d.default.div.withConfig({displayName:"currentColorPicker__Footer",componentId:"sc-eqs4bc-4"})(["height:","px;line-height:19px;position:relative;margin:0 16px;display:flex;justify-content:space-between;"],36),E=d.default.div.withConfig({displayName:"currentColorPicker__HexValue",componentId:"sc-eqs4bc-5"})(["width:","px;"],74),x=d.default.div.withConfig({displayName:"currentColorPicker__Opacity",componentId:"sc-eqs4bc-6"})(["width:","px;"],52);function CurrentColorPicker(e){let{rgb:r,hsl:c,hsv:u,hex:d,onChange:h,showOpacity:b,hasEyedropper:_}=e;const P=String(Math.round(100*r.a)),k="#"===d[0]?d.substr(1):d,w=t.useCallback((e=>("transparent"===e&&(e="000000"),`#${e}`)),[]),q=t.useCallback((e=>`${e}%`),[]),N=t.useCallback((e=>h({hex:e})),[h]),O=t.useCallback((e=>h({...r,a:isNaN(e)?1:parseInt(e)/100})),[r,h]),{initEyedropper:j}=a({onChange:h});return s.default.createElement(s.default.Fragment,null,s.default.createElement(t.Suspense,{fallback:null},s.default.createElement(g,null,s.default.createElement(f,{radius:"8px",pointer:()=>s.default.createElement(l,{offsetX:-8,offsetY:-8,currentColor:r}),hsl:c,hsv:u,onChange:h})),s.default.createElement(C,null,s.default.createElement(p,{direction:"horizontal",height:"20px",radius:"50px",pointer:()=>s.default.createElement(l,{offsetX:-8,offsetY:1,currentColor:r}),hsl:c,onChange:h})),b&&s.default.createElement(y,null,s.default.createElement(m,{direction:"horizontal",height:"20px",radius:"50px",pointer:()=>s.default.createElement(l,{offsetX:-8,offsetY:1,currentColor:r,withAlpha:!0}),rgb:r,hsl:c,onChange:h}))),s.default.createElement(v,null,_&&s.default.createElement(o.Button,{variant:o.BUTTON_VARIANTS.SQUARE,type:o.BUTTON_TYPES.QUATERNARY,size:o.BUTTON_SIZES.SMALL,"aria-label":n.__("Pick a color from canvas","web-stories"),onClick:j(),onPointerEnter:j(!1)},s.default.createElement(o.Icons.Pipette,null)),s.default.createElement(E,null,s.default.createElement(i,{label:n.__("Edit hex value","web-stories"),value:k,onChange:N,width:80,format:w})),b&&s.default.createElement(x,null,s.default.createElement(i,{label:n.__("Edit opacity","web-stories"),value:P,width:52,format:q,onChange:O}))))}CurrentColorPicker.defaultProps={showOpacity:!0};var _=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];function DynamicFetcher(e){const n=t.useRef(!1),[a,l]=t.useState(null);return t.useEffect((()=>(n.current=!0,Promise.resolve().then((function(){return u(require("react-color"))})).then((e=>{let{CustomPicker:t}=e;n.current&&l({component:t(...r)})})),()=>{n.current=!1})),[]),a?s.default.createElement(a.component,e):s.default.createElement(h,null,s.default.createElement(o.CircularProgress,null))}return DynamicFetcher}(CurrentColorPicker);module.exports=_;
