/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react");require("prop-types");var t=require("styled-components"),r=require("@googleforcreators/react"),a=require("@googleforcreators/design-system"),n=require("../panels/shared/styles.js");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var u=l(e),i=l(t);const c=r.lazy((()=>Promise.resolve().then((function(){return o(require("react-color/lib/components/common"))})).then((e=>({default:e.EditableInput}))))),s=i.default.button.withConfig({displayName:"editablePreview__Preview",componentId:"sc-cdmcf1-0"})(["margin:0;padding:5px 7px;border:1px solid ",";border-radius:4px;background:transparent;color:",";width:100%;",";"],(e=>{let{theme:t}=e;return t.colors.border.defaultNormal}),(e=>{let{theme:t}=e;return t.colors.fg.primary}),n.focusStyle),d=i.default.div.withConfig({displayName:"editablePreview__Wrapper",componentId:"sc-cdmcf1-1"})(["input{",";}"],n.focusStyle);function EditablePreview(e){let{label:t,value:n,width:l,format:o,onChange:i}=e;const[f,p]=r.useState(!1),b=r.useCallback((()=>p(!0)),[]),m=r.useCallback((()=>p(!1)),[]),g=r.useRef(null),E=r.useRef(),y=r.useMemo((()=>({input:{textAlign:"center",textTransform:"lowercase",width:"100%",padding:"6px 12px",border:"1px solid #5E6668",color:"#E4E5E6",borderRadius:"4px",background:"transparent",lineHeight:"18px"},wrap:{lineHeight:0,maxWidth:`${l}px`}})),[l]);a.useKeyDownEffect(g,{key:"esc",editable:!0},m,[f]);if(r.useLayoutEffect((()=>{const e=setTimeout((()=>{f&&E.current&&(E.current.input.focus(),E.current.input.select(),E.current.input.setAttribute("aria-label",t))}));return()=>clearTimeout(e)}),[f,t]),!f)return u.default.createElement(s,{"aria-label":t,onClick:b,onFocus:b},u.default.createElement(a.Text,{size:a.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL},o(n)));const h="transparent"===n?"000000":n;return u.default.createElement(d,{ref:g,tabIndex:-1,onBlur:e=>{e.currentTarget.contains(e.relatedTarget)||m()}},u.default.createElement(r.Suspense,{fallback:null},u.default.createElement(c,{value:h,ref:E,onChange:i,onChangeComplete:m,style:y})))}EditablePreview.defaultProps={label:"",value:""},module.exports=EditablePreview;
