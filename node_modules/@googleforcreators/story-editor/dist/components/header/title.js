/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),r=require("styled-components"),t=require("@googleforcreators/react"),o=require("@googleforcreators/i18n"),s=require("@googleforcreators/design-system");require("../../constants/fonts.js"),require("../../constants/multipleValue.js"),require("@googleforcreators/animation"),require("uuid"),require("@googleforcreators/masks"),require("@googleforcreators/element-library"),require("@googleforcreators/elements"),require("prop-types"),require("../../app/story/context.js"),require("@googleforcreators/migration"),require("@googleforcreators/templates"),require("../../app/config/context.js");var i=require("../../app/config/useConfig.js");require("../../app/api/context.js"),require("../../app/history/historyProvider.js"),require("../../app/history/context.js"),require("../../app/story/actions/useSaveStory.js"),require("clone-deep"),require("../../app/story/useStoryReducer/useStoryReducer.js"),require("@googleforcreators/output"),require("../../app/story/storyTriggers/storyTriggersProvider.js"),require("../../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js"),require("../../app/story/storyTriggers/storyEvents/onPageAddedRegister.js");var a=require("../../app/story/useStory.js"),l=require("../../utils/storyUpdates.js"),u=require("../../app/highlights/index.js"),n=require("../../app/highlights/useHighlights.js"),g=require("../../app/highlights/states.js");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=p(e);const d=p(r).default.input.withConfig({displayName:"title__Input",componentId:"sc-jcmnyx-0"})(["color:",";margin:0;"," background:",";border:none !important;text-align:start;min-width:60%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-radius:",";",";",""],(e=>{let{theme:r}=e;return`${r.colors.fg.primary} !important`}),s.themeHelpers.expandTextPreset(((e,r)=>{let{paragraph:t}=e,{MEDIUM:o}=r;return t[o]})),(e=>{let{isHighlighted:r}=e;return!r&&"none !important"}),(e=>{let{theme:r}=e;return r.borders.radius.small}),s.themeHelpers.focusableOutlineCSS,(e=>{let{isHighlighted:t}=e;return t&&r.css([""," ",""],u.styles.OUTLINE,u.styles.FLASH)}));module.exports=function HeaderTitle(){const{title:e,slug:r,updateStory:s}=a((e=>{let{state:{story:{title:r,slug:t}},actions:{updateStory:o}}=e;return{title:r,slug:t,updateStory:o}})),{highlight:u,resetHighlight:p,cancelHighlight:h}=n((e=>({highlight:e[g.default.STORY_TITLE],resetHighlight:e.onFocusOut,cancelHighlight:e.cancelEffect}))),{storyId:y}=i(),f=t.useCallback((e=>s({properties:{title:e.target.value}})),[s]),q=t.useCallback((()=>{l.updateSlug({currentSlug:r,currentTitle:e,storyId:y,updateStory:s})}),[r,y,e,s]);return"string"!=typeof e?null:c.default.createElement(d,{ref:e=>{e&&u?.focus&&u?.showEffect&&(e.addEventListener("keydown",h,{once:!0}),e.focus())},value:e,type:"text",onBlur:q,onChange:f,placeholder:o.__("Add title","web-stories"),"aria-label":o.__("Story title","web-stories"),isHighlighted:u?.showEffect,onAnimationEnd:()=>p()})};
