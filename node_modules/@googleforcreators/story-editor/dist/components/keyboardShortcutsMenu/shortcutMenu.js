/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),t=require("styled-components"),r=require("uuid"),o=require("@googleforcreators/react"),n=require("@googleforcreators/i18n"),u=require("@googleforcreators/design-system"),s=require("../../constants/index.js"),l=require("./headerShortcut.js"),a=require("./landmarkShortcuts.js"),i=require("./regularShortcuts.js"),c=require("./constants.js");require("prop-types"),require("@googleforcreators/tracking"),require("./keyboardShortcutsMenuContext/context.js");var d=require("./keyboardShortcutsMenuContext/useKeyboardShortcutsMenu.js");function f(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var m=f(e),h=f(t);const g=h.default.div.withConfig({displayName:"shortcutMenu__Container",componentId:"sc-m0xcqa-0"})(["position:absolute;left:0;bottom:0;width:352px;border-radius:",";background-color:",";border:","px solid ",";"],(e=>{let{theme:t}=e;return t.borders.radius.small}),(e=>{let{theme:t}=e;return t.colors.bg.primary}),1,(e=>{let{theme:t}=e;return t.colors.border.defaultNormal})),p=s.ADMIN_TOOLBAR_HEIGHT+s.HEADER_HEIGHT+c.TOP_MARGIN-2,E=h.default.div.withConfig({displayName:"shortcutMenu__FlexContent",componentId:"sc-m0xcqa-1"})(["display:flex;flex-direction:column;max-height:calc( 100vh - ","px - ","px );"],p,(e=>{let{bottomOffset:t}=e;return t})),b=h.default.div.withConfig({displayName:"shortcutMenu__CloseContainer",componentId:"sc-m0xcqa-2"})(["position:absolute;right:4px;top:4px;"]),x=h.default.div.withConfig({displayName:"shortcutMenu__ScrollableContent",componentId:"sc-m0xcqa-3"})(["overflow:auto;flex-shrink:1;",";"],u.themeHelpers.focusableOutlineCSS),C=`kb-header-${r.v4()}`;module.exports=function ShortcutMenu(){const e=o.useRef(),t=o.useRef(),{close:r,toggleMenu:s,isOpen:f}=d.useKeyboardShortcutsMenu((e=>{let{actions:t,state:r}=e;return{toggleMenu:t.toggleMenu,close:t.close,isOpen:r.isOpen}})),[h,p]=o.useState(0);return o.useLayoutEffect((()=>{const e=t.current;if(!e)return;const r=()=>{const t=e.getBoundingClientRect(),r=e.ownerDocument.documentElement.getBoundingClientRect();p(r.height-t.y-t.height)};return r(),setTimeout(r),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)}),[]),o.useEffect((()=>{f&&e.current&&e.current.focus()}),[f]),u.useKeyDownEffect(t,c.TOGGLE_SHORTCUTS_MENU,s,[s]),u.useKeyDownEffect(t,"esc",r),m.default.createElement(g,{ref:t},m.default.createElement(b,null,m.default.createElement(u.Button,{ref:e,type:u.BUTTON_TYPES.PLAIN,size:u.BUTTON_SIZES.SMALL,variant:u.BUTTON_VARIANTS.CIRCLE,onClick:r,"aria-label":n.__("Close Menu","web-stories")},m.default.createElement(u.Icons.Cross,null))),m.default.createElement(E,{bottomOffset:h},m.default.createElement(l,{id:C}),m.default.createElement(x,{role:"presentation",tabIndex:0},m.default.createElement(a,null),m.default.createElement(i,null))))};
