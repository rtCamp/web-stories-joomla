/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react");require("prop-types");var r=require("styled-components"),t=require("@googleforcreators/react"),i=require("@googleforcreators/i18n"),a=require("@googleforcreators/media"),s=require("@googleforcreators/design-system"),o=require("../common/paginatedMediaGallery.js"),d=require("../../../../../app/media/useMedia.js"),n=require("../../../../../app/media/media3p/providerConfiguration.js"),l=require("../../../../../app/media/media3p/api/useMedia3pApi.js"),c=require("../../../../../app/media/utils/useDetectBaseColor.js"),u=require("../../../useLibrary.js");require("../../shared/index.js");var p=require("../../shared/chipGroup/index.js");function g(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var m=g(e),h=g(r);function y(){return y=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},y.apply(this,arguments)}const f=h.default(s.Headline).attrs((()=>({as:"h2",size:s.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XX_SMALL}))).withConfig({displayName:"providerPanel__MediaSubheading",componentId:"sc-1c53rqi-0"})(["margin-top:24px;padding:0 24px;",""],(e=>e.shouldDisplay||"display: none;")),C=h.default.div.withConfig({displayName:"providerPanel__ProviderWrapper",componentId:"sc-1c53rqi-1"})(["position:relative;display:flex;flex-direction:column;height:100%;min-height:100px;max-width:100%;top:0;left:0;",""],(e=>{let{hidden:t}=e;return t&&r.css(["position:absolute;visibility:hidden;"])}));module.exports=function ProviderPanel(e){let{providerType:r,isActive:s,searchTerm:g,...h}=e;const{insertElement:v}=u((e=>({insertElement:e.actions.insertElement}))),{actions:{registerUsage:q}}=l(),{updateBaseColor:b}=c({}),I=t.useCallback((e=>{e?.attribution?.registerUsageUrl&&q({registerUsageUrl:e.attribution.registerUsageUrl})}),[q]),E=t.useCallback(((e,r)=>{a.resourceList.set(e.id,{url:r,type:"cached"}),v(e.type,{resource:e}),I(e),e.baseColor||b(e)}),[v,I,b]),{media3p:M}=d((e=>{let{media3p:r}=e;return{media3p:r}}));if(!s)return m.default.createElement(C,y({},h,{hidden:!0}));const P=M[r].state,j=M[r].actions,x=P.categories.selectedCategoryId?P.categories.categories.find((e=>e.id===P.categories.selectedCategoryId)).label:i.__("Trending","web-stories"),_=Boolean(P.media?.length||P.categories.selectedCategoryId),T=i.__("Search Results","web-stories");return m.default.createElement(C,h,n.PROVIDERS[r].supportsCategories&&m.default.createElement(p,{items:P.categories.categories,selectedItemId:P.categories.selectedCategoryId,selectItem:j.selectCategory,deselectItem:j.deselectCategory}),m.default.createElement(f,{"data-testid":"media-subheading",shouldDisplay:_},g.length&&!P.categories.selectedCategoryId?T:x),m.default.createElement(o,{providerType:r,resources:P.media,isMediaLoading:P.isMediaLoading,isMediaLoaded:P.isMediaLoaded,hasMore:P.hasMore,setNextPage:j.setNextPage,onInsert:E,searchTerm:g,selectedCategoryId:P.categories.selectedCategoryId}))};
