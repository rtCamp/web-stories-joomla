/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),r=require("styled-components"),t=require("@googleforcreators/i18n"),o=require("@googleforcreators/react");require("prop-types");var a=require("@googleforcreators/design-system"),s=require("uuid"),i=require("@googleforcreators/migration");require("@googleforcreators/templates"),require("../../../../app/config/context.js"),require("../../../../app/api/context.js");var n=require("../../../../app/api/useAPI.js");require("../../../../constants/fonts.js"),require("../../../../constants/multipleValue.js"),require("@googleforcreators/animation"),require("@googleforcreators/masks"),require("@googleforcreators/element-library"),require("@googleforcreators/elements"),require("../../../../app/story/context.js"),require("../../../../app/history/historyProvider.js"),require("../../../../app/history/context.js"),require("../../../../app/story/actions/useSaveStory.js"),require("clone-deep"),require("../../../../app/story/useStoryReducer/useStoryReducer.js"),require("@googleforcreators/output"),require("../../../../app/story/storyTriggers/storyTriggersProvider.js"),require("../../../../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js"),require("../../../../app/story/storyTriggers/storyEvents/onPageAddedRegister.js");var l=require("../../../../app/story/useStory.js"),u=require("../../../panels/shared/styles.js"),c=require("../../../../utils/isDefaultPage.js"),d=require("./images/illustration.svg.js");function g(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=g(e),m=g(r);const f=m.default(a.Text).withConfig({displayName:"templateSave__StyledText",componentId:"sc-vcrsmn-0"})(["color:",";"],(e=>{let{theme:r}=e;return r.colors.fg.secondary})),y=m.default.div.withConfig({displayName:"templateSave__IconWrapper",componentId:"sc-vcrsmn-1"})(["width:32px;height:42px;margin-right:29px;"]),h=m.default.button.withConfig({displayName:"templateSave__SaveButton",componentId:"sc-vcrsmn-2"})(["border:0;background:none;height:56px;width:100%;padding:7px;background-color:",";transition:background-color ",";border-radius:",";display:flex;flex-direction:row;align-items:center;cursor:pointer;&:hover{background-color:",";}"," ",";"],(e=>{let{theme:r}=e;return r.colors.interactiveBg.secondaryNormal}),a.BUTTON_TRANSITION_TIMING,(e=>{let{theme:r}=e;return r.borders.radius.small}),(e=>{let{theme:r}=e;return r.colors.interactiveBg.secondaryHover}),(e=>{let{$isDisabled:r,theme:t}=e;return r&&`\n      cursor: default;\n      background-color: ${t.colors.interactiveBg.disable};\n      &:hover {\n        background-color: ${t.colors.interactiveBg.disable};\n      }\n\n      ${y} svg {\n        path:nth-child(1): ${t.colors.fg.disable};\n        path:nth-child(2) {\n          fill: ${t.colors.fg.tertiary};\n        }\n        path:nth-child(3) {\n          fill: ${t.colors.fg.secondary};\n        }\n      }\n\n      ${f} {\n        color: ${t.colors.fg.disable};\n      }\n  `}),u.focusStyle);module.exports=function TemplateSave(e){let{setShowDefaultTemplates:r,updateList:u}=e;const{actions:{addPageTemplate:g}}=n(),{showSnackbar:m}=a.useSnackbar(),{currentPage:v}=l((e=>{let{state:{currentPage:r}}=e;return{currentPage:r}})),q=o.useMemo((()=>v&&c(v)),[v]),b=o.useCallback((async e=>{if(e.preventDefault(),q)return;try{const{templateId:e,...r}=v,o=await g({story_data:{...r,id:s.v4(),version:i.DATA_VERSION},featured_media:undefined,title:null});u?.(o),m({message:t.__("Page Template saved.","web-stories"),dismissable:!0})}catch{m({message:t.__("Unable to save the template. Please try again.","web-stories"),dismissable:!0})}r(!1)}),[q,g,v,r,m,u]);return p.default.createElement(h,{"aria-disabled":q,onClick:b,$isDisabled:q},p.default.createElement(y,null,p.default.createElement(d,{"aria-hidden":!0})),p.default.createElement(f,{size:a.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.SMALL,forwardedAs:"span"},t.__("Save current page as template","web-stories")))};
