/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");require("prop-types");var t=require("@googleforcreators/react"),r=require("styled-components"),o=require("@googleforcreators/tracking"),i=require("@googleforcreators/patterns"),a=require("@googleforcreators/units"),n=require("@googleforcreators/design-system"),l=require("@googleforcreators/masks"),s=require("../../useLibrary.js"),d=require("../shared/libraryMoveable.js"),c=require("../shared/insertionOverlay.js");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=p(e),h=p(r);const m=a.PAGE_WIDTH/3,f=h.default.button.withConfig({displayName:"shapePreview__Aspect",componentId:"sc-1pj9cm0-0"})(["background:transparent;outline:none;border:0;padding:0;position:relative;border-radius:",";background-color:",";&."," [role='presentation'],&[data-focus-visible-added] [role='presentation']{",";}"],(e=>{let{theme:t}=e;return t.borders.radius.small}),(e=>{let{theme:t}=e;return t.colors.interactiveBg.previewOverlay}),n.ThemeGlobals.FOCUS_VISIBLE_SELECTOR,(e=>{let{theme:t}=e;return n.themeHelpers.focusCSS(t.colors.border.focus,t.colors.bg.secondary)})),g=h.default.div.withConfig({displayName:"shapePreview__AspectInner",componentId:"sc-1pj9cm0-1"})(["position:relative;padding-bottom:95.5%;"]),v=h.default.div.withConfig({displayName:"shapePreview__ShapePreviewContainer",componentId:"sc-1pj9cm0-2"})(["position:absolute;top:0;left:0;height:100%;width:100%;border-radius:",";display:flex;justify-content:center;align-items:center;svg{display:inline-block;width:36px;height:36px;}"],(e=>{let{theme:t}=e;return t.borders.radius.small})),y=h.default.div.withConfig({displayName:"shapePreview__ShapeClone",componentId:"sc-1pj9cm0-3"})(["position:absolute;top:0;left:0;opacity:0;width:",";height:",";svg{display:inline-block;width:100%;height:100%;path{fill:#c4c4c4;}}"],(e=>{let{width:t}=e;return`${t}px`}),(e=>{let{height:t}=e;return`${t}px`})),E=h.default.div.withConfig({displayName:"shapePreview__ShapePreviewSizer",componentId:"sc-1pj9cm0-4"})(["padding-top:100%;"]),b=h.default.path.withConfig({displayName:"shapePreview__Path",componentId:"sc-1pj9cm0-5"})(["fill:",";"],(e=>{let{theme:t}=e;return t.colors.fg.primary}));exports.DEFAULT_ELEMENT_WIDTH=m,exports.default=function ShapePreview(e){let{mask:r,isPreview:n,index:p}=e;const{insertElement:h}=s((e=>({insertElement:e.actions.insertElement}))),{dataToEditorX:w,dataToEditorY:_}=a.useUnits((e=>({dataToEditorX:e.actions.dataToEditorX,dataToEditorY:e.actions.dataToEditorY}))),[P,k]=t.useState(!1),C=()=>k(!0),T=()=>k(!1),S=t.useRef(),j=t.createRef(),q=t.useMemo((()=>({backgroundColor:i.createSolidFromString("#c4c4c4"),width:m*r.ratio,height:m,mask:{type:r.type},lockAspectRatio:l.MaskTypes.RECTANGLE!==r.type})),[r.ratio,r.type]),I=t.useCallback((()=>{h("shape",q),o.trackEvent("insert_shape",{name:r.type})}),[h,q,r.type]),x=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return u.default.createElement("svg",{viewBox:"0 0 1 "+1/(n&&r.iconRatio?r.iconRatio:r.ratio),width:36*(n&&r.iconRatio?r.iconRatio:r.ratio),height:36},e&&u.default.createElement("title",null,r.name),u.default.createElement(b,{d:n&&r.iconPath?r.iconPath:r.path,ref:j}))};return u.default.createElement(f,{ref:S,onClick:I,tabIndex:0===p?0:-1,"aria-label":r.name,onPointerEnter:C,onFocus:C,onPointerLeave:T,onBlur:T},u.default.createElement(g,null,u.default.createElement(v,{key:r.type},u.default.createElement(E,null),x()),P&&u.default.createElement(c,null)),u.default.createElement(d,{type:"shape",elementProps:q,cloneElement:y,cloneProps:{width:w(m*r.ratio),height:_(m),children:x(!1)}}))};
