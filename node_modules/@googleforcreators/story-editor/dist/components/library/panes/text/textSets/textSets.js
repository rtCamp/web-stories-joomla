/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),t=require("@googleforcreators/react");require("prop-types");var r=require("react-virtual"),i=require("@googleforcreators/i18n"),a=require("@googleforcreators/units"),s=require("../../shared/virtualizedPanelGrid/components.js"),n=require("../../shared/virtualizedPanelGrid/getVirtualizedItemIndex.js"),l=require("../../shared/virtualizedPanelGrid/useVirtualizedGridNavigation.js"),u=require("./textSet.js"),d=require("./constants.js"),o=require("../../../../../constants/index.js");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var m=c(e);module.exports=function TextSets(e){let{paneRef:c,filteredTextSets:f}=e;const E=t.useRef(),I=t.useRef({}),_=t.useMemo((()=>f.map((e=>e.id))),[f]),S=r.useVirtual({size:Math.ceil((f||[]).length/2),parentRef:c,estimateSize:t.useCallback((()=>o.TEXT_SET_SIZE+s.PANEL_GRID_ROW_GAP),[]),overscan:4}),T=r.useVirtual({horizontal:!0,size:2,parentRef:c,estimateSize:t.useCallback((()=>o.TEXT_SET_SIZE+s.PANEL_GRID_ROW_GAP),[]),overscan:0}),{activeGridItemId:g,handleGridFocus:p,handleGridItemFocus:z,isGridFocused:v}=l({rowVirtualizer:S,containerRef:E,gridItemRefs:I,gridItemIds:_});return m.default.createElement(a.UnitsProvider,{pageSize:d.TEXT_SET_PAGE_SIZE},m.default.createElement(s.VirtualizedWrapper,{height:S.totalSize},m.default.createElement(s.VirtualizedContainer,{height:S.totalSize,ref:E,columnWidth:o.TEXT_SET_SIZE,rowHeight:o.TEXT_SET_SIZE,onFocus:p,role:"group","aria-label":i.__("Text Set Options","web-stories")},S.virtualItems.map((e=>T.virtualItems.map((t=>{const r=n.getVirtualizedItemIndex({columnIndex:t.index,rowIndex:e.index}),i=f[r];if(!i?.elements)return null;const a=g===i.id&&v;return m.default.createElement(u,{key:r,id:i.id,"data-testid":`text_set_${i.id}`,ref:e=>I.current[i.id]=e,translateY:e.start,translateX:t.start,"aria-label":i.title,isActive:a,onFocus:()=>z(i.id),elements:i.elements,index:r})})))))))};
