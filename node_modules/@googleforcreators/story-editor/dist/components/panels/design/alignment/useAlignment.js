/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var t=require("@googleforcreators/react"),e=require("@googleforcreators/units"),i=require("@googleforcreators/tracking");const n={startX:0,startY:0,endX:e.PAGE_WIDTH,endY:e.PAGE_HEIGHT,width:e.PAGE_WIDTH,height:e.PAGE_HEIGHT},r="left",a="right",o="top",d="bottom";module.exports=function(h){let{selectedElements:l,updateElements:s,isFloatingMenu:g}=h;const c=l.length>2,m=t.useMemo((()=>l.map((t=>{const{id:i,x:n,y:r,width:a,height:o,rotationAngle:d}=t;let h=n,l=r,s=a,g=o;if(d){const t=e.calcRotatedObjectPositionAndSize(d,n,r,a,o);h=t.x,l=t.y,s=t.width,g=t.height}return{id:i,x:n,y:r,width:a,height:o,frameX:h,frameY:l,frameWidth:s,frameHeight:g}}))),[l]),f=1===l.length?n:e.getBoundRect(l),u=t=>{i.trackEvent(g?"floating_menu":"design_panel",{name:`set_alignment_${t}`,element:"multiple"})},H=t=>{u(t),s((e=>{const{id:i}=e,n=m.find((t=>t.id===i)),{width:d=0,height:h=0,frameWidth:l=0,frameHeight:s=0}=n||{},g=t===r||t===a?(l-d)/2:(s-h)/2;return t===r||t===a?{x:t===r?f.startX+g:f.endX-d-g}:{y:t===o?f.startY+g:f.endY-h-g}}))};return{isDistributionEnabled:c,handleAlignLeft:()=>H(r),handleAlignCenter:()=>{u("center");const t=(f.endX+f.startX)/2;s((e=>{const{width:i}=e;return{x:t-i/2}}))},handleAlignRight:()=>H(a),handleAlignTop:()=>H(o),handleAlignMiddle:()=>{u("middle");const t=(f.endY+f.startY)/2;s((e=>{const{height:i}=e;return{y:t-i/2}}))},handleAlignBottom:()=>H(d),handleHorizontalDistribution:()=>{u("horizontal_distribution");const t=[...m];t.sort(((t,e)=>(t.frameX+t.frameWidth)/2-(e.frameX+e.frameWidth)/2));const i=t.reduce(((t,e)=>t+e.frameWidth),0),n=f.width-i,r=e.dataPixels(n/(t.length-1)),a={};let o=0;t.forEach(((e,i)=>{const{id:n,x:d,width:h,frameWidth:l}=e;0===i||i===t.length-1?(a[n]={x:d},o=d):a[n]={x:o+(l-h)/2},o+=l+r})),s((t=>{let{id:e}=t;return a[e]}))},handleVerticalDistribution:()=>{u("vertical_distribution");const t=[...m];t.sort(((t,e)=>(t.frameY+t.frameHeight)/2-(e.frameY+e.frameHeight)/2));const i=t.reduce(((t,e)=>t+e.frameHeight),0),n=f.height-i,r=e.dataPixels(n/(t.length-1)),a={};let o=0;t.forEach(((e,i)=>{const{id:n,y:d,height:h,frameHeight:l}=e;0===i||i===t.length-1?(a[n]={y:d},o=d):a[n]={y:o+(l-h)/2},o+=l+r})),s((t=>{let{id:e}=t;return a[e]}))}}};
