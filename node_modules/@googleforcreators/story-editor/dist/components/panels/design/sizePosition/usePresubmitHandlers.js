/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var t=require("@googleforcreators/react"),e=require("@googleforcreators/units"),i=require("@googleforcreators/elements"),r=require("../../../form/usePresubmitHandler.js"),l=require("./constants.js"),o=require("./utils.js");module.exports=function(n,M,a){r(((t,r,o)=>{let{width:M,height:a}=r,{width:s,height:c}=o;const{type:h}=t,u=Boolean(M),I=Boolean(a);if(!u&&!I)return null;const{updateForResizeEvent:A}=i.getDefinitionForType(h);if(A){return A(t,[u?1:0,I?1:0],e.clamp(M,l.MIN_MAX.WIDTH),e.clamp(a,l.MIN_MAX.HEIGHT))}if(n){const t=s/c;if(!u)return{width:e.clamp(e.dataPixels(a*t),l.MIN_MAX.WIDTH)};if(!I)return{height:e.clamp(e.dataPixels(M/t),l.MIN_MAX.HEIGHT)}}return null}),[n]),r((t=>{let{rotationAngle:e}=t;return{rotationAngle:e%360}}),[]),r((t=>{let{rotationAngle:i,x:r,y:o,width:n,height:M}=t;const a=e.calcRotatedObjectPositionAndSize(i,r,o,n,M),s=r-a.x,c=o-a.y;return{x:e.clamp(r,{MIN:l.MIN_MAX.X.MIN+s-a.width,MAX:l.MIN_MAX.X.MAX+s}),y:e.clamp(o,{MIN:l.MIN_MAX.Y.MIN+c-a.height,MAX:l.MIN_MAX.Y.MAX+c})}}),[]);const s=t.useCallback(((t,i,r)=>n&&t>=r.MAX?e.clamp(r.MAX*i,r):e.clamp(t,r)),[n]);r(((t,i)=>{let{height:r}=t,{width:n,height:M}=i;const a=M/n;return r=e.clamp(r,l.MIN_MAX.HEIGHT),o.isNum(a)?{height:s(e.dataPixels(r),a,l.MIN_MAX.HEIGHT)}:{height:e.clamp(r,l.MIN_MAX.HEIGHT)}}),[M,n]),r(((t,i)=>{let{width:r}=t,{width:n,height:M}=i;const a=n/M;return r=e.clamp(r,l.MIN_MAX.WIDTH),o.isNum(a)?{width:s(e.dataPixels(r),a,l.MIN_MAX.WIDTH)}:{width:e.clamp(r,l.MIN_MAX.WIDTH)}}),[a,n])};
