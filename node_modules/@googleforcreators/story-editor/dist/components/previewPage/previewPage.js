/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),t=require("prop-types"),r=require("@googleforcreators/react"),a=require("styled-components"),n=require("@googleforcreators/patterns"),i=require("@googleforcreators/animation");require("../../types.js");var o=require("./previewPageElements.js");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=l(e),u=l(t),c=l(a);const g=c.default.div.withConfig({displayName:"previewPage__FullBleedPreviewWrapper",componentId:"sc-1r5t7dq-0"})(["height:",";width:100%;overflow:hidden;position:relative;display:flex;align-items:center;background-color:white;",";"],(e=>{let{pageSize:t}=e;return`${t.containerHeight}px`}),(e=>{let{background:t}=e;return n.generatePatternStyles(t)})),p=c.default.div.withConfig({displayName:"previewPage__PreviewSafeZone",componentId:"sc-1r5t7dq-1"})(["width:100%;height:",";overflow:visible;position:absolute;margin:0;"],(e=>{let{pageSize:t}=e;return`${t.height}px`}));function PreviewPageAnimationController(e){let{animationState:t}=e;const a=i.useStoryAnimationContext((e=>{let{actions:t}=e;return t.WAAPIAnimationMethods}));return r.useEffect((()=>{switch(t){case i.STORY_ANIMATION_STATE.PLAYING:return a.play(),()=>{};case i.STORY_ANIMATION_STATE.RESET:return a.reset(),()=>{};case i.STORY_ANIMATION_STATE.SCRUBBING:case i.STORY_ANIMATION_STATE.PAUSED:return a.pause(),()=>{};default:return()=>{}}}),[t,a]),r.useEffect((()=>()=>a.reset()),[a]),null}const f=r.memo(r.forwardRef((function PreviewPageDisplay(e,t){let{page:r,pageSize:a}=e;return s.default.createElement(g,{ref:t,pageSize:a,background:r.backgroundColor},s.default.createElement(p,{pageSize:a},s.default.createElement(o,{page:r})))}))),d=r.forwardRef((function PreviewPage(e,t){let{page:r,pageSize:n,animationState:o=i.STORY_ANIMATION_STATE.RESET,onAnimationComplete:l}=e;return s.default.createElement(a.StyleSheetManager,{stylisPlugins:[]},s.default.createElement(i.StoryAnimation.Provider,{animations:r.animations,elements:r.elements,onWAAPIFinish:l},s.default.createElement(f,{ref:t,page:r,pageSize:n}),s.default.createElement(PreviewPageAnimationController,{animationState:o})))}));PreviewPageAnimationController.propTypes={animationState:u.default.oneOf(Object.values(i.STORY_ANIMATION_STATE))},module.exports=d;
