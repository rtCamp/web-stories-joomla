/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("styled-components"),t=require("@googleforcreators/react");require("prop-types");var o=require("@googleforcreators/design-system");require("@googleforcreators/transform"),require("../dropTargets/provider.js"),require("../dropTargets/context.js"),require("../../app/history/historyProvider.js"),require("../../app/history/context.js"),require("@googleforcreators/templates"),require("../../app/config/context.js");var a=require("../../app/config/useConfig.js");require("../../app/api/context.js"),require("@googleforcreators/fonts"),require("@googleforcreators/dom"),require("../../constants/fonts.js"),require("../../constants/multipleValue.js");var s=require("../../constants/performanceTrackingEvents.js");require("../../app/font/context.js"),require("@googleforcreators/media"),require("@googleforcreators/tracking"),require("@googleforcreators/animation"),require("uuid"),require("@googleforcreators/masks"),require("@googleforcreators/element-library"),require("@googleforcreators/elements"),require("../../app/story/context.js"),require("@googleforcreators/migration"),require("../../app/story/actions/useSaveStory.js"),require("clone-deep"),require("../../app/story/useStoryReducer/useStoryReducer.js"),require("@googleforcreators/output"),require("../../app/story/storyTriggers/storyTriggersProvider.js"),require("../../app/story/storyTriggers/storyEvents/onInitialElementAddedRegister.js"),require("../../app/story/storyTriggers/storyEvents/onPageAddedRegister.js"),require("@googleforcreators/i18n"),require("../../app/media/useUploadMedia.js"),require("@googleforcreators/patterns"),require("../../utils/generateBlurhash.worker.js"),require("../../app/media/media3p/providerConfiguration.js"),require("../../app/media/utils/useFFmpeg.js"),require("../../app/media/media3p/api/context.js"),require("../../app/media/local/constants.js"),require("../../app/media/media3p/providerReducer.js"),require("../../app/media/context.js"),require("sat"),require("@googleforcreators/units"),require("../../app/layout/context.js"),require("../../app/layout/useZoomSetting.js"),require("@googleforcreators/rich-text"),require("@googleforcreators/stickers"),require("../library/panes/text/textPresets.js"),require("../../app/canvas/context.js"),require("../../app/currentUser/context.js"),require("../../app/helpCenter/provider.js"),require("../../app/helpCenter/context.js"),require("../helpCenter/constants.js"),require("../../app/rightClickMenu/context.js");var i=require("../tooltip/tooltip.js"),n=require("../../utils/usePerformanceTracking.js");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=l(e),c=l(r);function p(){return p=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},p.apply(this,arguments)}const d=c.default.ul.attrs({role:"tablist","aria-orientation":"horizontal"}).withConfig({displayName:"tabview__Tabs",componentId:"sc-10d408-0"})(["display:flex;flex-direction:row;align-items:stretch;width:100%;max-width:100%;justify-content:space-between;margin:0;padding:0;list-style:none;border-bottom:1px solid ",";"],(e=>{let{theme:r}=e;return r.colors.divider.secondary})),f=c.default.li.attrs((e=>{let{isActive:r}=e;return{tabIndex:r?0:-1,role:"tab","aria-selected":r}})).withConfig({displayName:"tabview__TabElement",componentId:"sc-10d408-1"})(["cursor:pointer;border:none;background:none;padding:0 4px;margin:","px 12px 9px;height:","px;display:flex;align-items:center;justify-content:center;position:relative;transition:color 0.2s ease;color:",";border-radius:",";",";:hover{color:",";}"," svg{display:block;width:32px;height:32px;margin:0 -4px;transform-origin:center center;transition:transform 0.3s ease,color 0.2s ease;color:",";border-radius:",";pointer-events:none;}svg.alert{width:","px;margin-left:4px;color:",";}span,svg:not(.alert){",";}&:hover span,&:hover svg:not(.alert),&:active span,&:active svg:not(.alert){color:",";}&.",",&[data-focus-visible-added]{svg:not(.alert){background-color:",";}}"],10,32,(e=>{let{theme:r,isActive:t}=e;return t?r.colors.fg.primary:r.colors.fg.tertiary}),(e=>{let{theme:r}=e;return r.borders.radius.small}),(e=>{let{theme:r}=e;return o.themeHelpers.focusableOutlineCSS(r.colors.border.focus,r.colors.bg.secondary)}),(e=>{let{theme:r}=e;return r.colors.fg.primary}),(e=>{let{isActive:t,theme:o}=e;return t&&r.css(["::after{content:'';position:absolute;background-color:",";height:2px;border-radius:1px;bottom:-10px;left:4px;right:4px;}"],o.colors.border.selection)}),(e=>{let{theme:r}=e;return r.colors.fg.tertiary}),(e=>{let{theme:r}=e;return r.borders.radius.small}),28,(e=>{let{theme:r}=e;return r.colors.fg.primary}),(e=>{let{isActive:r,theme:t}=e;return r&&`color: ${t.colors.fg.primary}`}),(e=>{let{theme:r}=e;return r.colors.fg.primary}),o.ThemeGlobals.FOCUS_VISIBLE_SELECTOR,(e=>{let{theme:r}=e;return r.colors.interactiveBg.tertiaryHover})),g=c.default(o.Headline).attrs({as:"p",size:o.THEME_CONSTANTS.TYPOGRAPHY.PRESET_SIZES.XXX_SMALL}).withConfig({displayName:"tabview__TabText",componentId:"sc-10d408-2"})(["color:inherit;"]),m=()=>{};const q=t.forwardRef((function UnreffedTab(e,r){let{children:t,tooltip:o=null,placement:a,refId:l,tabRefs:c,...d}=e;const{id:g}=d,m=g.includes("library")?s.TRACKING_EVENTS.LIBRARY_PANEL_CLICK:s.TRACKING_EVENTS.DESIGN_PANEL_CLICK;n({node:c?.[l]?.current,eventData:{...m,label:`${l}_tab`}});const q=u.default.createElement(f,p({ref:r},d),t);return null!==o?u.default.createElement(i,{title:o,placement:a,isDelayed:!0},q):q}));exports.TAB_HEIGHT=32,exports.TAB_VERTICAL_MARGIN=10,exports.default=function TabView(e){let{getTabId:r=(e=>e),getAriaControlsId:s,onTabChange:i=m,onTabRefUpdated:n=m,tabs:l=[],label:c="",shortcut:f="",tab:y,tabRefs:b,...h}=e;const{isRTL:v}=a(),x=t.useRef(),j=t.useRef(),E=t.useRef({}),T=t.useCallback((e=>{b?.[e]?.current?b[e].current?.focus():E?.current[e]&&E.current[e]?.focus(),j.current=e}),[b]),C=t.useCallback((e=>{T(e),i(e)}),[T,i]);o.useGlobalKeyDownEffect({key:f,editable:!0},(()=>C(y)),[C,y]);const w=t.useCallback((e=>{const r=l[(e+l.length)%l.length];T(r.id)}),[l,T]),R=t.useCallback((e=>{const r=v?-e:e,t=l.findIndex((e=>{let{id:r}=e;return r===j.current}));w(t+r)}),[v,l,w]);return o.useKeyDownEffect(x,"left",(()=>R(-1)),[R]),o.useKeyDownEffect(x,"right",(()=>R(1)),[R]),o.useKeyDownEffect(x,["up","down"],(()=>{}),[]),o.useKeyDownEffect(x,"home",(()=>w(0)),[w]),o.useKeyDownEffect(x,"end",(()=>w(-1)),[w]),o.useKeyDownEffect(x,{key:["enter","space"],allowDefault:!0},(e=>{"tab"===e.target.getAttribute("role")&&(C(j.current),e.preventDefault())}),[C],{}),u.default.createElement(d,p({"aria-label":c,ref:x},h),l.map((e=>{let{id:t,title:o,icon:a,...i}=e;return u.default.createElement(q,p({key:t,ref:e=>{b?b[t].current=e:E.current[t]=e,n(e,t)},id:r(t),isActive:y===t,"aria-controls":s?s(t):null,"aria-selected":y===t,onClick:()=>C(t),onFocus:()=>{j.current=y},refId:t,tabRefs:b},i),Boolean(o)&&u.default.createElement(g,null,o),Boolean(a)&&u.default.createElement(a,{isActive:t===y}))})))};
