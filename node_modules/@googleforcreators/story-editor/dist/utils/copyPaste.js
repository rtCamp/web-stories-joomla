/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@googleforcreators/react"),n=require("@googleforcreators/elements");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=i(e);exports.addElementsToClipboard=function(e,i,a,r){if(!i.length||!r)return;const{clipboardData:s}=r,l={sentinel:"story-elements",items:i.map((t=>({...t,...t.isDefaultBackground?{backgroundColor:e.backgroundColor}:null,basedOn:t.id,id:void 0}))),animations:a},m=JSON.stringify(l).replace(/--/g,"_DOUBLEDASH_"),u=i.map((e=>{const{type:t}=e,{TextContent:i}=n.getDefinitionForType(t);return i?i(e):t})).join("\n"),c=i.map((e=>{const{type:i,x:a,y:r,rotationAngle:s}=e,{Output:l}=n.getDefinitionForType(i);return t.renderToStaticMarkup(o.default.createElement(l,{element:e,box:{width:100,height:100,x:a,y:r,rotationAngle:s}}))})).join("\n");s.setData("text/plain",u),s.setData("text/html",`\x3c!-- ${m} --\x3e${c}`)},exports.processPastedElements=function(e,t){let i={animations:[],elements:[]};for(let o=e.firstChild;o;o=o.nextSibling){if(8!==o.nodeType||-1!==o.nodeValue?.indexOf("Fragment"))continue;const e=JSON.parse(o.nodeValue.replace(new RegExp("_DOUBLEDASH_","g"),"--"));if("story-elements"!==e.sentinel)continue;const a=e.items.reduce(((i,o)=>{let{elements:a,animations:r}=i;const{element:s,elementAnimations:l}=n.duplicateElement({element:{...o,id:o.basedOn},animations:e.animations,existingElements:t.elements});return{elements:[...a,s],animations:[...r,...l]}}),{animations:[],elements:[]});return i={animations:[...i.animations,...a.animations],elements:[...i.elements,...a.elements]},i}return i};
