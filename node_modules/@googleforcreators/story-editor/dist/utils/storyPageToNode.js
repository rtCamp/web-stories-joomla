/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";var e=require("react"),t=require("@googleforcreators/design-system"),r=require("@googleforcreators/react"),o=require("@googleforcreators/units"),n=require("styled-components"),i=require("@googleforcreators/patterns"),a=require("@googleforcreators/transform"),l=require("../app/font/fontProvider.js");require("../app/font/context.js");var d=require("../components/canvas/displayElement.js");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=s(e),c=s(n);const g=c.default.div.withConfig({displayName:"storyPageToNode__Page",componentId:"sc-rgshjs-0"})(["display:block;position:relative;padding:0;border:0;background-color:transparent;height:","px;width:","px;flex:none;outline:0;"],(e=>{let{height:t}=e;return t}),(e=>{let{width:t}=e;return t})),h=c.default.div.withConfig({displayName:"storyPageToNode__PreviewWrapper",componentId:"sc-rgshjs-1"})(["height:100%;position:relative;overflow:hidden;background-color:",";border-radius:4px;",""],(e=>{let{theme:t}=e;return t.colors.fg.white}),(e=>{let{background:t}=e;return i.generatePatternStyles(t)})),f=c.default.div.withConfig({displayName:"storyPageToNode__FullHeight",componentId:"sc-rgshjs-2"})(["position:absolute;top:","px;bottom:","px;right:0;left:0;"],(e=>{let{yOffset:t}=e;return t}),(e=>{let{yOffset:t}=e;return t})),p=r.forwardRef((function PageWithDependencies(e,r){let{page:i,width:s,height:c,renderFullHeightThumb:p=!1,containerHeight:m}=e;return u.default.createElement(n.ThemeProvider,{theme:t.theme},u.default.createElement(l.default,null,u.default.createElement(a.TransformProvider,null,u.default.createElement(o.UnitsProvider,{pageSize:{width:s,height:c}},u.default.createElement(g,{ref:r,height:p?m:c,width:s},u.default.createElement(h,{background:i.backgroundColor},u.default.createElement(f,{yOffset:p?(m-c)/2:0},i.elements.map((e=>u.default.createElement(d,{key:e.id,previewMode:!0,element:e}))))))))))}));module.exports=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{renderFullHeightThumb:i=!1}=n,a=t*(1/o.PAGE_RATIO),l=t*(1/o.FULLBLEED_RATIO),d=document.createElement("div");d.style.cssText=`\n     contain: strict;\n     position: absolute;\n     top: 0;\n     left: 0;\n     width: ${t}px;\n     height: ${l}px;\n     opacity: 0;\n     transform: translate(-100%, -100%);\n     pointer-events: none;\n   `;const s=await new Promise((o=>{r.render(u.default.createElement(p,{ref:e=>{e&&o(e)},page:e,width:t,height:a,containerHeight:l,renderFullHeightThumb:i}),d)}));document.body.appendChild(d);const c=()=>{r.unmountComponentAtNode(d),document.body.removeChild(d)};return[s,c]};
