/**
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@googleforcreators/react"),t=require("@googleforcreators/design-system");require("react"),require("prop-types"),require("../../app/config/context.js");var o=require("../../app/config/useConfig.js"),r=require("./nestedNavigation.js"),i=require("./flatNavigation.js");function n(e){const t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}function l(e,t,o){return o>0?r.getNextEnabledElement(e,t,o):i.getNextEnabledSibling(e,t)}function s(e,t){return(e?"ArrowRight"===t||"ArrowUp"===t||"PageUp"===t:"ArrowLeft"===t||"ArrowUp"===t||"PageUp"===t)?"previousSibling":"nextSibling"}function a(e,t,o){const r=n(e);let i=null,s=null,a=null;for(let c=l(e,t,o);c;c=l(c,t,o)){const e=n(c);if(Math.floor(e.y)===Math.floor(r.y))continue;if(i&&Math.floor(e.y)>Math.floor(s.y))break;const t=(f=r,u=e,Math.pow(f.x-u.x,2)+Math.pow(f.y-u.y,2));(!a||t<a)&&(a=t,s=e,i=c)}var f,u;return i}exports.default=function(i){let{ref:n}=i,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const{isRTL:c}=o(),g=e.useCallback((e=>{let{key:t,target:o}=e;const i=o,n=s(c,t),f=e=>{if(e){const t=u>0?r.getAncestorByDepth(e,u):e;i.tabIndex=-1,e.tabIndex=0,e.focus(),t.scrollIntoView("previousSibling"===n)}};if("ArrowLeft"===t||"ArrowRight"===t){const e=l(i,n,u);e&&f(e)}else if("ArrowUp"===t||"ArrowDown"===t){const e=a(i,n,u);if(e)i.tabIndex=-1,e.tabIndex=0,e.focus();else if("ArrowUp"===t){f(u>0?r.getFocusableChild(i,u):i.parentNode.firstChild)}else{f(u>0?r.getFocusableChild(i,u,"lastChild"):i.parentNode.lastChild)}}else if("Home"===t){f(u>0?r.getFocusableChild(i,u):i.parentNode.firstChild)}else if("End"===t){f(u>0?r.getFocusableChild(i,u,"lastChild"):i.parentNode.lastChild)}else if("PageDown"===t||"PageUp"===t){let e=i;for(let t=0;l(e,n,u)&&t<5;e=l(e,n,u))t++;f(e)}}),[c,u]);t.useKeyDownEffect(n,{key:["up","down","left","right","pageup","pagedown","home","end"]},g,[n,g,...f])},exports.getFocusableElementDirection=s;
