import{createContext as e,useContext as r,useReducer as t,createElement as n,useEffect as o,useLayoutEffect as c,useRef as u}from"react";import{unstable_runWithPriority as s,unstable_NormalPriority as i}from"scheduler";import{unstable_batchedUpdates as p}from"react-native";const a=Symbol(),d=Symbol(),f="undefined"==typeof window||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?o:c,l=s?e=>s(i,e):e=>e(),v=e=>e;function w(r){const t=e({[a]:{v:{current:r},n:{current:-1},l:new Set,u:e=>e()}});var o;return t[d]=t.Provider,t.Provider=(o=t.Provider,({value:e,children:r})=>{const t=u(e),c=u(0),s=u();if(!s.current){const e=new Set,r=r=>{p(()=>{c.current+=1,e.forEach(e=>e([c.current])),r()})};s.current={[a]:{v:t,n:c,l:e,u:r}}}return f(()=>{t.current=e,c.current+=1,l(()=>{s.current[a].l.forEach(r=>{r([c.current,e])})})},[e]),n(o,{value:s.current},r)}),delete t.Consumer,t}function E(e,n){const o=r(e)[a];if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!o)throw new Error("useContextSelector requires special context");const{v:{current:c},n:{current:u},l:s}=o,i=n(c),[p,d]=t((e,r)=>{if(!r)return[c,i];if(r[0]===u)return Object.is(e[1],i)?e:[c,i];try{if(2===r.length){if(Object.is(e[0],r[1]))return e;const t=n(r[1]);return Object.is(e[1],t)?e:[r[1],t]}}catch(e){}return[...e]},[c,i]);return Object.is(p[1],i)||d(),f(()=>(s.add(d),()=>{s.delete(d)}),[s]),p[1]}function h(e){return E(e,v)}function b(e){const t=r(e)[a];if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!t)throw new Error("useContextUpdate requires special context");const{u:n}=t;return n}const x=({context:e,value:r,children:t})=>{const{[d]:o}=e;if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!o)throw new Error("BridgeProvider requires special context");return n(o,{value:r},t)},m=e=>{const t=r(e);if("object"==typeof process&&"production"!==process.env.NODE_ENV&&!t[a])throw new Error("useBridgeValue requires special context");return t};export{x as BridgeProvider,w as createContext,m as useBridgeValue,h as useContext,E as useContextSelector,b as useContextUpdate};
//# sourceMappingURL=index.native.modern.mjs.map
